(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{F7Yq:function(e,t,i){"use strict";i.r(t),i.d(t,"HttpLoaderFactory",function(){return Jn}),i.d(t,"EstablishModule",function(){return jn});var n=i("xxV/"),s=i("ofXK"),l=i("3Pt+"),a=i("JqCM"),o=i("ZOsW"),r=i("jcQU"),c=i("1kSV"),d=i("uF4Q"),h=i("0jTc"),u=i("SRvG"),g=i("ed8r"),m=i("QYJQ"),b=i("tk/3"),p=i("sYmb"),f=i("mqiu"),I=i("Pk9d"),D=i("cZdB"),S=i("GJ+o"),N=i("4SUy"),C=i("hXFv"),v=i("QUNt"),y=i("z+xu"),B=i("ZwAT"),w=i("0hV+"),P=i("tyNb"),x=i("vpVc"),A=i("AytR"),R=i("fXoL"),M=i("qLS9"),F=i("HJFG"),k=i("h9f+"),T=i("t0UR"),E=i("KCoQ"),G=i("H552"),O=i("WAEy"),K=i("2Vo4"),L=i("lJxs"),U=i("2zK7");new b.e({Authorization:"Bearer "+localStorage.getItem("token")});let J=(()=>{class e{constructor(e){this.http=e,this.baseUrl=A.a.apiUrlEC,this.gueIngredientSource=new K.a({}),this.currentGlueIngredient=this.gueIngredientSource.asObservable(),this.flagSource=new K.a("0"),this.currentFlag=this.flagSource.asObservable()}getIngredients(e,t,i){const n=new U.a;return this.http.get(`${this.baseUrl}GlueIngredient/GetIngredientsByGlueID/${e}`,{observe:"response"}).pipe(Object(L.a)(e=>(n.result=e.body,null!=e.headers.get("Pagination")&&(n.pagination=JSON.parse(e.headers.get("Pagination"))),n)))}getGlues(e,t){const i=new U.a;return this.http.get(`${this.baseUrl}GlueIngredient/getAllGlues/${e}/${t}`,{observe:"response"}).pipe(Object(L.a)(e=>(i.result=e.body,null!=e.headers.get("Pagination")&&(i.pagination=JSON.parse(e.headers.get("Pagination"))),i)))}mappGlueIngredient(e){return this.http.post(this.baseUrl+"GlueIngredient/MapGlueIngredient",e)}mapGlueIngredientByGlueID(e){return this.http.post(this.baseUrl+"GlueIngredient/MapGlueIngredientByGlueID",e)}mapGlueIngredient(e){return this.http.post(this.baseUrl+"GlueIngredient/MapGlueIngredients",e)}delete(e,t){return this.http.get(`${this.baseUrl}GlueIngredient/${e}/${t}/delete`)}editPercentage(e){return this.http.put(this.baseUrl+"GlueIngredient/editPercentage",e)}editAllow(e){return this.http.put(this.baseUrl+"GlueIngredient/editAllow",e)}getDetail(e){return this.http.get(this.baseUrl+`GlueIngredient/${e}/detail`)}}return e.\u0275fac=function(t){return new(t||e)(R.Zb(b.b))},e.\u0275prov=R.Ib({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var z=i("xiVD"),j=i("j7qE");let H=(()=>{class e{constructor(e){this.http=e,this.baseUrl=A.a.apiUrlEC}getAll(){return this.http.get(this.baseUrl+"ModelNo/GetAll",{})}getModelNoByModelNameID(e){return this.http.get(this.baseUrl+"ModelNo/getModelNoByModelNameID/"+e,{})}}return e.\u0275fac=function(t){return new(t||e)(R.Zb(b.b))},e.\u0275prov=R.Ib({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),_=(()=>{class e{constructor(e){this.http=e,this.baseUrl=A.a.apiUrlEC}getArticleNos(e,t){const i=new U.a;let n=new b.f;return null!=e&&null!=t&&(n=n.append("pageNumber",e),n=n.append("pageSize",t)),this.http.get(this.baseUrl+"ArticleNo/getArticleNos",{observe:"response",params:n}).pipe(Object(L.a)(e=>(i.result=e.body,null!=e.headers.get("Pagination")&&(i.pagination=JSON.parse(e.headers.get("Pagination"))),i)))}getAlls(){return this.http.get(this.baseUrl+"ArticleNo/GetAll",{})}getArticleNoByModelNameID(e){return this.http.get(this.baseUrl+"ArticleNo/getArticleNoByModelNameID/"+e,{})}getArticleNoByModelNoID(e){return this.http.get(this.baseUrl+"ArticleNo/getArticleNoByModelNoID/"+e,{})}create(e){return this.http.post(this.baseUrl+"ArticleNo/create",e)}update(e){return this.http.put(this.baseUrl+"ArticleNo/update",e)}delete(e){return this.http.delete(this.baseUrl+"ArticleNo/delete/"+e)}}return e.\u0275fac=function(t){return new(t||e)(R.Zb(b.b))},e.\u0275prov=R.Ib({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Q=i("CC+3"),q=i("MBJp"),V=i("6U7I");let X=(()=>{class e{constructor(e){this.http=e,this.baseUrl=A.a.apiUrlEC}getAll(){return this.http.get(this.baseUrl+"ArtProcess/GetAll",{})}getArtProcessByArticleNoID(e){return this.http.get(this.baseUrl+"ArtProcess/getArtProcessByArticleNoID/"+e,{})}GetAllProcess(){return this.http.get(this.baseUrl+"Process/GetAll",{})}}return e.\u0275fac=function(t){return new(t||e)(R.Zb(b.b))},e.\u0275prov=R.Ib({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Y=i("vrRs");const W=["switch"],Z=["grid"],ee=["gridglue"],te=["grid2"],ie=["modelNameDropdownlist"],ne=["modelNoDropdownlist"],se=["chemicalDropdownlist"],le=["positionDropdownlist"];function ae(e,t){if(1&e){const e=R.Tb();R.Sb(0,"div",11),R.Sb(1,"button",25),R.cc("click",function(){R.Bc(e);const t=R.gc(),i=R.yc(48);return t.openModal(i)}),R.Nb(2,"i",26),R.Rb(),R.Rb()}}function oe(e,t){if(1&e){const e=R.Tb();R.Qb(0),R.Sb(1,"ejs-radiobutton",27),R.cc("click",function(t){return R.Bc(e),R.gc().onClickProcess(t)}),R.Rb(),R.Pb()}if(2&e){const e=t.$implicit;R.zb(1),R.mc("label",e.name)("value",e.id)}}function re(e,t){1&e&&(R.Kc(0),R.hc(1,"translate")),2&e&&R.Mc(" ",R.ic(1,1,"GLUE")," ")}function ce(e,t){if(1&e&&(R.Sb(0,"div",40),R.Kc(1),R.Rb()),2&e){const e=t.$implicit;R.nc("title",e.name),R.zb(1),R.Mc(" ",e.name," ")}}function de(e,t){1&e&&(R.Kc(0),R.hc(1,"translate")),2&e&&R.Mc(" ",R.ic(1,1,"CONSUMPTION")," ")}function he(e,t){if(1&e&&(R.Sb(0,"span"),R.Kc(1),R.Rb()),2&e){const e=t.$implicit,i=R.gc(2);R.Bb(i.changeConsumptionColor(e)),R.zb(1),R.Lc(""===e.consumption?"0":e.consumption)}}function ue(e,t){1&e&&(R.Kc(0),R.hc(1,"translate")),2&e&&R.Mc(" ",R.ic(1,1,"EXPIRED_TIME")," ")}function ge(e,t){1&e&&(R.Kc(0),R.hc(1,"translate")),2&e&&R.Mc(" ",R.ic(1,1,"KIND")," ")}function me(e,t){if(1&e){const e=R.Tb();R.Sb(0,"ejs-dropdownlist",41,42),R.cc("ngModelChange",function(e){return t.$implicit.kindName=e})("select",function(t){return R.Bc(e),R.gc(2).onChangeKindEdit(t)}),R.Rb()}if(2&e){const e=t.$implicit,i=R.gc(2);R.mc("dataSource",i.kinds)("ngModel",e.kindName)("fields",i.fieldsKindEdit)("allowFiltering",!0)}}function be(e,t){1&e&&(R.Kc(0),R.hc(1,"translate")),2&e&&R.Mc(" ",R.ic(1,1,"PART")," ")}function pe(e,t){if(1&e){const e=R.Tb();R.Sb(0,"ejs-dropdownlist",43,44),R.cc("ngModelChange",function(e){return t.$implicit.partName=e})("select",function(t){return R.Bc(e),R.gc(2).onChangePartEdit(t)}),R.Rb()}if(2&e){const e=t.$implicit,i=R.gc(2);R.mc("dataSource",i.parts)("ngModel",e.partName)("fields",i.fieldsPartEdit)("allowFiltering",!0)}}function fe(e,t){1&e&&(R.Kc(0),R.hc(1,"translate")),2&e&&R.Mc(" ",R.ic(1,1,"MATERIAL")," ")}function Ie(e,t){if(1&e){const e=R.Tb();R.Sb(0,"ejs-dropdownlist",43,44),R.cc("ngModelChange",function(e){return t.$implicit.materialName=e})("select",function(t){return R.Bc(e),R.gc(2).onChangeMaterialEdit(t)}),R.Rb()}if(2&e){const e=t.$implicit,i=R.gc(2);R.mc("dataSource",i.materials)("ngModel",e.materialName)("fields",i.fieldsMaterialEdit)("allowFiltering",!0)}}function De(e,t){if(1&e){const e=R.Tb();R.Sb(0,"div",28),R.Sb(1,"ejs-grid",29,30),R.cc("rowDeselected",function(t){return R.Bc(e),R.gc().rowDeselected(t)})("actionBegin",function(t){return R.Bc(e),R.gc().actionBeginGlue(t)})("rowSelected",function(t){return R.Bc(e),R.gc().rowSelected(t)})("created",function(){return R.Bc(e),R.gc().onCreatedGridGlue()})("toolbarClick",function(t){return R.Bc(e),R.gc().toolbarClick(t)})("dataBound",function(){return R.Bc(e),R.gc().dataBoundGlue()}),R.Sb(3,"e-columns"),R.Sb(4,"e-column",31),R.Ic(5,re,2,3,"ng-template",null,32,R.Jc),R.Ic(7,ce,2,2,"ng-template",null,33,R.Jc),R.Rb(),R.Sb(9,"e-column",34),R.Ic(10,de,2,3,"ng-template",null,32,R.Jc),R.Ic(12,he,2,3,"ng-template",null,33,R.Jc),R.Rb(),R.Sb(14,"e-column",35),R.Ic(15,ue,2,3,"ng-template",null,32,R.Jc),R.Rb(),R.Sb(17,"e-column",36),R.Ic(18,ge,2,3,"ng-template",null,32,R.Jc),R.Ic(20,me,2,4,"ng-template",null,37,R.Jc),R.Rb(),R.Sb(22,"e-column",38),R.Ic(23,be,2,3,"ng-template",null,32,R.Jc),R.Ic(25,pe,2,4,"ng-template",null,37,R.Jc),R.Rb(),R.Sb(27,"e-column",39),R.Ic(28,fe,2,3,"ng-template",null,32,R.Jc),R.Ic(30,Ie,2,4,"ng-template",null,37,R.Jc),R.Rb(),R.Rb(),R.Rb(),R.Rb()}if(2&e){const e=R.gc();R.zb(1),R.mc("dataSource",e.glues)("editSettings",e.editSettings)("toolbar",e.toolbar)("allowSorting",!0)("selectedRowIndex",e.rowIndex)}}function Se(e,t){if(1&e){const e=R.Tb();R.Sb(0,"ejs-switch",52,53),R.cc("click",function(){return R.Bc(e),R.gc(2).done()})("ngModelChange",function(t){return R.Bc(e),R.gc(2).createdStatus=t}),R.hc(2,"translate"),R.hc(3,"translate"),R.Rb()}if(2&e){const e=R.gc(2);R.nc("onLabel",R.ic(2,5,"DONE")),R.nc("offLabel",R.ic(3,7,"UNDONE")),R.mc("disabled",e.approvalStatus)("ngModel",e.createdStatus)("checked",e.createdStatus)}}function Ne(e,t){if(1&e){const e=R.Tb();R.Sb(0,"ejs-switch",55),R.cc("click",function(){return R.Bc(e),R.gc(3).approval()})("ngModelChange",function(t){return R.Bc(e),R.gc(3).approvalStatus=t}),R.hc(1,"translate"),R.Rb()}if(2&e){const e=R.gc(3);R.nc("offLabel",R.ic(1,3,"NOT_APPROVED")),R.mc("ngModel",e.approvalStatus)("checked",e.approvalStatus)}}function Ce(e,t){if(1&e&&(R.Qb(0),R.Ic(1,Ne,2,5,"ejs-switch",54),R.Pb()),2&e){const e=R.gc(2);R.zb(1),R.mc("ngIf",e.modelNameID>0)}}function ve(e,t){if(1&e){const e=R.Tb();R.Sb(0,"button",56),R.cc("click",function(){return R.Bc(e),R.gc(2).finished()}),R.Nb(1,"i",57),R.Kc(2),R.hc(3,"translate"),R.Rb()}2&e&&(R.zb(2),R.Mc(" ",R.ic(3,1,"FINISHED")," "))}function ye(e,t){if(1&e){const e=R.Tb();R.Sb(0,"button",58),R.cc("click",function(){R.Bc(e);const t=R.gc(2),i=R.yc(50);return t.openModalHistory(i)}),R.Nb(1,"i",59),R.Kc(2," History"),R.Rb()}}function Be(e,t){if(1&e&&(R.Sb(0,"div",45),R.Sb(1,"button",46),R.Nb(2,"i",47),R.Kc(3," Reset "),R.Rb(),R.Ic(4,Se,4,9,"ejs-switch",48),R.Ic(5,Ce,2,1,"ng-container",49),R.Ic(6,ve,4,3,"button",50),R.Ic(7,ye,3,0,"button",51),R.Rb()),2&e){const e=R.gc();R.zb(4),R.mc("ngIf",e.modelNameID>0),R.zb(1),R.mc("ngIf",3!==e.level&&4!==e.level),R.zb(1),R.mc("ngIf",e.modelNameID>0),R.zb(1),R.mc("ngIf",e.modelNameID>0)}}function we(e,t){if(1&e&&(R.Sb(0,"li",76),R.Sb(1,"a"),R.Kc(2),R.Sb(3,"span",77),R.Kc(4),R.Rb(),R.Rb(),R.Rb()),2&e){const e=t.$implicit;R.zb(2),R.Nc(" ",e.position,". ",e.ingredientName," "),R.zb(2),R.Mc("(",e.percentage,"%)")}}function Pe(e,t){if(1&e&&(R.Sb(0,"ul"),R.Sb(1,"span",73),R.Kc(2),R.Rb(),R.Sb(3,"li",74),R.Kc(4),R.Sb(5,"ul"),R.Ic(6,we,5,3,"li",75),R.Rb(),R.Rb(),R.Rb()),2&e){const e=R.gc(2);R.zb(2),R.Lc(e.formulaTamp()),R.zb(2),R.Mc(" ",e.formula()," "),R.zb(2),R.mc("ngForOf",e.renderchemical())}}function xe(e,t){if(1&e){const e=R.Tb();R.Sb(0,"button",78),R.cc("click",function(){R.Bc(e);const i=t.$implicit;return R.gc(2).sortBySup(i.id)}),R.Nb(1,"i",79),R.Kc(2),R.Rb()}if(2&e){const e=t.$implicit;R.zb(2),R.Mc(" ",e.name," ")}}function Ae(e,t){1&e&&(R.Kc(0),R.hc(1,"translate")),2&e&&R.Mc(" ",R.ic(1,1,"ITEM")," ")}function Re(e,t){if(1&e){const e=R.Tb();R.Sb(0,"ejs-dropdownlist",80,81),R.cc("change",function(i){R.Bc(e);const n=t.$implicit;return R.gc(2).onChangePosition(i,n,n.index)}),R.Rb()}if(2&e){const e=t.$implicit,i=R.gc(2);R.mc("dataSource",i.dataPosition)("value",e.position)("fields",i.fieldsPosition)("allowFiltering",!0)}}function Me(e,t){if(1&e){const e=R.Tb();R.Sb(0,"ejs-dropdownlist",80,81),R.cc("change",function(i){R.Bc(e);const n=t.$implicit;return R.gc(2).onChangePosition(i,n,n.index)}),R.Rb()}if(2&e){const e=t.$implicit,i=R.gc(2);R.mc("dataSource",i.dataPosition)("value",e.position)("fields",i.fieldsPosition)("allowFiltering",!0)}}function Fe(e,t){1&e&&(R.Kc(0),R.hc(1,"translate")),2&e&&R.Mc(" ",R.ic(1,1,"INGREDIENT_NAME")," ")}function ke(e,t){1&e&&R.Kc(0),2&e&&R.Mc(" ",t.$implicit.name," ")}function Te(e,t){1&e&&R.Kc(0),2&e&&R.Mc(" ",t.$implicit.name," ")}function Ee(e,t){if(1&e&&(R.Sb(0,"div"),R.Kc(1),R.Rb()),2&e){const e=t.$implicit,i=R.gc(2);R.Bb(i.changePercentageColor(e)),R.zb(1),R.Lc(e.percentage)}}function Ge(e,t){1&e&&(R.Sb(0,"div"),R.Nb(1,"i",82),R.Rb())}function $e(e,t){if(1&e&&(R.Sb(0,"div"),R.Kc(1),R.Rb()),2&e){const e=t.$implicit,i=R.gc(2);R.Bb(i.changeAllowColor(e)),R.zb(1),R.Mc("\xb1 ",e.allow,"")}}function Oe(e,t){1&e&&(R.Kc(0),R.hc(1,"translate")),2&e&&R.Mc(" ",R.ic(1,1,"ITEM")," ")}function Ke(e,t){if(1&e){const e=R.Tb();R.Sb(0,"ejs-dropdownlist",80,81),R.cc("change",function(i){R.Bc(e);const n=t.$implicit;return R.gc(2).onChangePosition(i,n,n.index)}),R.Rb()}if(2&e){const e=t.$implicit,i=R.gc(2);R.mc("dataSource",i.dataPosition)("value",e.position)("fields",i.fieldsPosition)("allowFiltering",!0)}}function Le(e,t){if(1&e){const e=R.Tb();R.Sb(0,"ejs-dropdownlist",80,81),R.cc("change",function(i){R.Bc(e);const n=t.$implicit;return R.gc(2).onChangePosition(i,n,n.index)}),R.Rb()}if(2&e){const e=t.$implicit,i=R.gc(2);R.mc("dataSource",i.dataPosition)("value",e.position)("fields",i.fieldsPosition)("allowFiltering",!0)}}function Ue(e,t){1&e&&(R.Kc(0),R.hc(1,"translate")),2&e&&R.Mc(" ",R.ic(1,1,"INGREDIENT_NAME")," ")}function Je(e,t){1&e&&R.Kc(0),2&e&&R.Mc(" ",t.$implicit.name," ")}function ze(e,t){1&e&&R.Kc(0),2&e&&R.Mc(" ",t.$implicit.name," ")}function je(e,t){1&e&&(R.Sb(0,"div"),R.Nb(1,"i",82),R.Rb())}function He(e,t){if(1&e&&(R.Sb(0,"div"),R.Kc(1),R.Rb()),2&e){const e=t.$implicit,i=R.gc(2);R.Bb(i.changeAllowColor(e)),R.zb(1),R.Mc("\xb1 ",e.allow,"")}}function _e(e,t){if(1&e){const e=R.Tb();R.Sb(0,"div",60),R.Ic(1,Pe,7,3,"ul",49),R.Sb(2,"div",0),R.Sb(3,"div",61),R.Sb(4,"button",62),R.cc("click",function(){return R.Bc(e),R.gc().sortBySup(0)}),R.Kc(5),R.hc(6,"translate"),R.Rb(),R.Ic(7,xe,3,1,"button",63),R.Rb(),R.Rb(),R.Sb(8,"div",0),R.Sb(9,"div",64),R.Sb(10,"div",15),R.Sb(11,"div",28),R.Sb(12,"ejs-grid",65,66),R.cc("actionComplete",function(t){return R.Bc(e),R.gc().actionCompleteIngredient(t)})("recordDoubleClick",function(t){return R.Bc(e),R.gc().onDoubleClickIngredient(t)})("actionBegin",function(t){return R.Bc(e),R.gc().actionBeginIngredient(t)})("toolbarClick",function(t){return R.Bc(e),R.gc().toolbarClickIngredient(t)})("rowSelected",function(t){return R.Bc(e),R.gc().rowSelectedIngredient(t)}),R.Sb(14,"e-columns"),R.Sb(15,"e-column",67),R.Ic(16,Ae,2,3,"ng-template",null,32,R.Jc),R.Ic(18,Re,2,4,"ng-template",null,33,R.Jc),R.Ic(20,Me,2,4,"ng-template",null,37,R.Jc),R.Rb(),R.Sb(22,"e-column",68),R.Ic(23,Fe,2,3,"ng-template",null,32,R.Jc),R.Ic(25,ke,1,1,"ng-template",null,37,R.Jc),R.Ic(27,Te,1,1,"ng-template",null,33,R.Jc),R.Rb(),R.Sb(29,"e-column",69),R.Ic(30,Ee,2,3,"ng-template",null,33,R.Jc),R.Rb(),R.Sb(32,"e-column",70),R.Ic(33,Ge,2,0,"ng-template",null,32,R.Jc),R.Ic(35,$e,2,3,"ng-template",null,33,R.Jc),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Sb(37,"div",64),R.Sb(38,"div",15),R.Sb(39,"div",28),R.Sb(40,"ejs-grid",71,72),R.cc("actionComplete",function(t){return R.Bc(e),R.gc().actionCompleteIngredient(t)})("recordDoubleClick",function(t){return R.Bc(e),R.gc().onDoubleClickIngredient(t)})("actionBegin",function(t){return R.Bc(e),R.gc().actionBeginIngredient(t)})("toolbarClick",function(t){return R.Bc(e),R.gc().toolbarClickIngredient(t)})("rowSelected",function(t){return R.Bc(e),R.gc().rowSelectedIngredient(t)}),R.Sb(42,"e-columns"),R.Sb(43,"e-column",67),R.Ic(44,Oe,2,3,"ng-template",null,32,R.Jc),R.Ic(46,Ke,2,4,"ng-template",null,33,R.Jc),R.Ic(48,Le,2,4,"ng-template",null,37,R.Jc),R.Rb(),R.Sb(50,"e-column",68),R.Ic(51,Ue,2,3,"ng-template",null,32,R.Jc),R.Ic(53,Je,1,1,"ng-template",null,37,R.Jc),R.Ic(55,ze,1,1,"ng-template",null,33,R.Jc),R.Rb(),R.Nb(57,"e-column",69),R.Sb(58,"e-column",70),R.Ic(59,je,2,0,"ng-template",null,32,R.Jc),R.Ic(61,He,2,3,"ng-template",null,33,R.Jc),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Rb()}if(2&e){const e=R.gc();R.zb(1),R.mc("ngIf",e.renderchemical().length>0),R.zb(4),R.Mc(" ",R.ic(6,12,"DEFAULT")," "),R.zb(2),R.mc("ngForOf",e.supplier),R.zb(5),R.mc("dataSource",e.ingredients1)("allowSorting",!0)("allowSorting",!0)("editSettings",e.editSettings)("toolbar",e.toolbarOptions2),R.zb(28),R.mc("dataSource",e.ingredients2)("allowSorting",!0)("editSettings",e.editSettings)("toolbar",e.toolbarOptions2)}}function Qe(e,t){if(1&e){const e=R.Tb();R.Sb(0,"div",83),R.Sb(1,"h4",84),R.Nb(2,"i",85),R.Kc(3," Clone Article "),R.Rb(),R.Sb(4,"button",86),R.cc("click",function(){return t.$implicit.dismiss("Cross click")}),R.Sb(5,"span",87),R.Kc(6,"\xd7"),R.Rb(),R.Rb(),R.Rb(),R.Sb(7,"div",88),R.Sb(8,"div",0),R.Sb(9,"div",89),R.Sb(10,"div",90),R.Sb(11,"label",91),R.Kc(12,"Article Name"),R.Rb(),R.Sb(13,"span",92),R.Kc(14,"(*)"),R.Rb(),R.Sb(15,"input",93),R.cc("ngModelChange",function(t){return R.Bc(e),R.gc().articleName=t}),R.Rb(),R.Rb(),R.Rb(),R.Sb(16,"div",89),R.Sb(17,"div",90),R.Sb(18,"label",91),R.Kc(19,"Process"),R.Rb(),R.Sb(20,"ejs-dropdownlist",94,95),R.cc("change",function(t){return R.Bc(e),R.gc().onChangeProcessCloneModal(t)}),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Sb(22,"div",96),R.Sb(23,"button",97),R.cc("click",function(){return t.$implicit.close("Close click")}),R.Kc(24,"Close"),R.Rb(),R.Sb(25,"button",98),R.cc("click",function(){return R.Bc(e),R.gc().cloneArticleModelname()}),R.Kc(26,"Clone"),R.Rb(),R.Rb()}if(2&e){const e=R.gc();R.zb(15),R.mc("ngModel",e.articleName),R.zb(5),R.mc("value",e.valueProcess)("dataSource",e.processData)("allowFiltering",!0)("fields",e.processfields)}}function qe(e,t){if(1&e){const e=R.Tb();R.Qb(0),R.Sb(1,"ejs-radiobutton",102),R.cc("ngModelChange",function(t){return R.Bc(e),R.gc(2).artProcessIDClone=t}),R.Rb(),R.Pb()}if(2&e){const e=t.$implicit,i=R.gc(2);R.zb(1),R.mc("label",e.name)("value",e.id)("ngModel",i.artProcessIDClone)}}function Ve(e,t){if(1&e){const e=R.Tb();R.Sb(0,"div",83),R.Sb(1,"h4",84),R.Nb(2,"i",85),R.Kc(3," Clone BPFC "),R.Rb(),R.Sb(4,"button",86),R.cc("click",function(){return t.$implicit.dismiss("Cross click")}),R.Sb(5,"span",87),R.Kc(6,"\xd7"),R.Rb(),R.Rb(),R.Rb(),R.Sb(7,"div",88),R.Sb(8,"div",0),R.Sb(9,"div",89),R.Sb(10,"div",90),R.Sb(11,"label",91),R.Kc(12,"Model Name"),R.Rb(),R.Sb(13,"span",92),R.Kc(14,"(*)"),R.Rb(),R.Sb(15,"ejs-dropdownlist",99,7),R.cc("open",function(){return R.Bc(e),R.gc().openPopupDropdownlist()})("filtering",function(t){return R.Bc(e),R.gc().onFilteringModelNameClone(t)})("select",function(t){return R.Bc(e),R.gc().onChangeModelNameClone(t)}),R.Rb(),R.Kc(17),R.Rb(),R.Rb(),R.Sb(18,"div",89),R.Sb(19,"div",90),R.Sb(20,"label",91),R.Kc(21,"Model NO"),R.Rb(),R.Sb(22,"span",92),R.Kc(23,"(*)"),R.Rb(),R.Sb(24,"ejs-dropdownlist",100,10),R.cc("dataBound",function(t){return R.Bc(e),R.gc().OndataBound(t)})("filtering",function(t){return R.Bc(e),R.gc().onFilteringModelNOClone(t)})("select",function(t){return R.Bc(e),R.gc().onChangeModelNoClone(t)}),R.Rb(),R.Kc(26),R.Rb(),R.Rb(),R.Sb(27,"div",89),R.Sb(28,"div",90),R.Sb(29,"label",91),R.Kc(30,"Article NO"),R.Rb(),R.Sb(31,"span",92),R.Kc(32,"(*)"),R.Rb(),R.Sb(33,"ejs-dropdownlist",101,7),R.cc("filtering",function(t){return R.Bc(e),R.gc().onFilteringArticleNOClone(t)})("ngModelChange",function(t){return R.Bc(e),R.gc().articleNOIDClone=t})("select",function(t){return R.Bc(e),R.gc().onChangeArticleNoClone(t)}),R.Rb(),R.Kc(35),R.Rb(),R.Rb(),R.Sb(36,"div",89),R.Sb(37,"div",90),R.Sb(38,"label",91),R.Kc(39,"Process"),R.Rb(),R.Sb(40,"span",92),R.Kc(41,"(*)"),R.Rb(),R.Sb(42,"div",13),R.Ic(43,qe,2,3,"ng-container",14),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Sb(44,"div",96),R.Sb(45,"button",97),R.cc("click",function(){return t.$implicit.close("Close click")}),R.Kc(46,"Close"),R.Rb(),R.Sb(47,"button",98),R.cc("click",function(){return R.Bc(e),R.gc().onClickClone()}),R.Kc(48,"Clone"),R.Rb(),R.Rb()}if(2&e){const e=R.gc();R.zb(15),R.mc("dataSource",e.modelNameDataClone)("fields",e.fieldsBPFCs)("allowFiltering",!0)("value",e.value),R.zb(2),R.Mc(" ",e.modelNameIDClone," "),R.zb(7),R.mc("dataSource",e.modelNOsDataClone)("fields",e.fieldsBPFCs)("allowFiltering",!0)("value",e.valuemodelNo),R.zb(2),R.Mc(" ",e.modelNOIDClone," "),R.zb(7),R.mc("dataSource",e.articleNosDataClone)("fields",e.fieldsBPFCs)("allowFiltering",!0)("ngModel",e.articleNOIDClone),R.zb(2),R.Mc(" ",e.articleNOIDClone," "),R.zb(8),R.mc("ngForOf",e.artProcessDataClone2)}}function Xe(e,t){1&e&&(R.Kc(0),R.hc(1,"date")),2&e&&R.Mc(" ",R.jc(1,1,t.$implicit.createdTime,"yyyy-MM-dd , hh:mm:ss a")," ")}function Ye(e,t){if(1&e&&(R.Qb(0),R.Nb(1,"input",115),R.Pb()),2&e){const e=R.gc().$implicit;R.zb(1),R.mc("value",e.remark)}}function We(e,t){if(1&e&&R.Nb(0,"input",116),2&e){const e=R.gc().$implicit;R.mc("value",e.remark)}}function Ze(e,t){if(1&e&&(R.Sb(0,"span",112),R.Ic(1,Ye,2,1,"ng-container",113),R.Ic(2,We,1,1,"ng-template",null,114,R.Jc),R.Rb()),2&e){const e=t.$implicit,i=R.yc(3);R.mc("ngClass","Improve"==e.action?"e-input-group e-control-wrapper e-valid-input":"e-input-group e-control-wrapper e-valid-input e-disabled"),R.zb(1),R.mc("ngIf","Improve"==e.action)("ngIfElse",i)}}function et(e,t){if(1&e){const e=R.Tb();R.Sb(0,"div",83),R.Sb(1,"h4",84),R.Nb(2,"i",85),R.Kc(3," BPFC History "),R.Rb(),R.Sb(4,"button",86),R.cc("click",function(){return t.$implicit.dismiss("Cross click")}),R.Sb(5,"span",87),R.Kc(6,"\xd7"),R.Rb(),R.Rb(),R.Rb(),R.Sb(7,"div",88),R.Sb(8,"ejs-grid",103,104),R.cc("actionBegin",function(t){return R.Bc(e),R.gc().actionBeginHistory(t)}),R.Sb(10,"e-columns"),R.Sb(11,"e-column",105),R.Ic(12,Xe,2,4,"ng-template",null,33,R.Jc),R.Rb(),R.Nb(14,"e-column",106),R.Nb(15,"e-column",107),R.Nb(16,"e-column",108),R.Sb(17,"e-column",109),R.Ic(18,Ze,4,3,"ng-template",null,37,R.Jc),R.Rb(),R.Nb(20,"e-column",110),R.Rb(),R.Rb(),R.Rb(),R.Sb(21,"div",96),R.Sb(22,"button",111),R.cc("click",function(){return t.$implicit.close("Close click")}),R.Kc(23,"Close"),R.Rb(),R.Rb()}if(2&e){const e=R.gc();R.zb(8),R.mc("dataSource",e.historyData)("allowSorting",!0)("allowSorting",!0)("editSettings",e.editSettingsHis)("toolbar",e.toolbarOptionsHistory),R.zb(9),R.mc("edit",e.editparamsHis)}}let tt=(()=>{class e{constructor(e,t,i,n,s,l,a,o,r,c,d,h,u,g,m,b){this.glueIngredientService=e,this.modalNameService=t,this.glueService=i,this.alertify=n,this.modalService=s,this.route=l,this.authService=a,this.bPFCEstablishService=o,this.modelNoService=r,this.articleNoService=c,this.kindService=d,this.partService=h,this.materialService=u,this.buildingUserService=g,this.artProcessService=m,this.ingredientService=b,this.positions=["B","C","D","E"],this.approvalStatus=!1,this.createdStatus=!1,this.role=JSON.parse(localStorage.getItem("user")).user.role,this.isShow=!1,this.selectedRow=[],this.LANG=localStorage.getItem("lang")||"vi",this.glue={},this.ingredient={},this.editPercentage={glueID:0,ingredientID:0,percentage:0},this.editAllow={glueID:0,ingredientID:0,allow:0},this.page=1,this.supplier=[],this.toolbarOptions=["Search","Delete"],this.toolbarOptions2=["Search","Add","Delete","Cancel"],this.toolbarOptionsHistory=["Search"],this.selectionOptions={type:"Multiple",mode:"Both"},this.editSettingsHis={allowEditing:!0,mode:"Normal",allowEditOnDblClick:!0},this.detailIngredient=[],this.totalPercentage=0,this.fieldsBPFCs={text:"name",value:"id"},this.fieldsBPFCss={text:"name",value:"id"},this.fieldsGlueChemical={text:"name",value:"name"},this.textGlue="Select Model Name",this.textModelName="Select Model Name - Model #",this.textGlueMaterial="Select ",this.fieldsGlue2={text:"name",value:"id"},this.articleNofields={text:"name",value:"id"},this.processfields={text:"name",value:"id"},this.processData=[{id:1,name:"ASY"},{id:2,name:"STF"}],this.valueProcess=1,this.textGlue2="Select Model No",this.existGlue=!1,this.editparamsHis={params:{format:"n"}},this.dataPosition=[{id:"0",name:""},{id:"1",name:"A"},{id:"2",name:"B"},{id:"3",name:"C"},{id:"4",name:"D"},{id:"5",name:"E"}],this.fieldsKindEdit={text:"name",value:"name"},this.fieldsPartEdit={text:"name",value:"name"},this.fieldsMaterialEdit={text:"name",value:"name"},this.fieldsGlueEdit={text:"name",value:"name"},this.fieldsChemical={text:"name",value:"name"},this.fieldsPosition={text:"name",value:"name"},this.rowIndex="",this.glueIngredient2={ingredientID:0,percentage:0,glueID:0,position:""},this.history={Action:"Created",BPFCEstablishID:0,GlueID:0,Before:"",BeforeAllow:"",After:"",AfterAllow:"",UserID:0,Remark:""},this.valuess="Badminton",this.modelNameSelect=!1,this.modelNoSelect=!1,this.modelArtSelect=!1,this.modelProcessSelect=!1,this.userData=[],this.onFiltering=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.modelNameData,t)},this.onFilteringModelName=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.modelNameData,t)},this.onFilteringModelNO=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.modelNoData,t)},this.onFilteringArticleNO=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.articleNoData,t)},this.onFilteringModelNameClone=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.modelNameData,t)},this.onFilteringModelNOClone=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.modelNoData,t)},this.onFilteringArticleNOClone=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.articleNoData,t)},this.onFilteringArtProcessClone=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.artProcessDataClone,t)}}ngOnInit(){this.getModelNames(),this.getAllUsers(),this.modelNameID=0,this.subID=0,this.selIndex=[],this.isAdd=!1,this.existGlue=!1,this.oldDetail=[],this.glueIngredientDetail=[],this.removeLocalStore("details"),this.glueid=0,this.onService(),this.getAllSupllier(),this.sortOptions={columns:[{field:"item",direction:"Decending"}]},this.editParams={params:{value:""}},0===this.glue.id?(this.showBarCode=!1,this.genaratorGlueCode()):this.showBarCode=!0,this.ingredientService.currentIngredient.subscribe(e=>{200===e&&this.getIngredients()}),this.pageSettings={pageSize:12},this.paginationI={currentPage:1,itemsPerPage:10,totalItems:0,totalPages:0},this.editSettings={showDeleteConfirmDialog:!1,allowEditing:!0,allowAdding:!0,allowDeleting:!0,mode:"Normal"},this.toolbar=[{text:"Add New",tooltipText:"Add new row",prefixIcon:"e-add",id:"AddNew"},"Edit","Delete","Update","Cancel","Search"],this.orderidrules={required:!0,number:!0},this.customeridrules={required:!0},this.freightrules={required:!0},this.editparams={paramss:{popupHeight:"300px"}}}onChangeProcessCloneModal(e){e.itemData&&(this.processID=e.itemData.id)}resetLifeCycleBPFC(){this.selIndex=[],this.oldDetail=[],this.glueIngredientDetail=[],this.removeLocalStore("details"),this.removeLocalStore("detailsTamp"),this.ingredients1=[],this.ingredients2=[],this.glues=[],this.BPFCID=0}onCreatedGridGlue(){}ngAfterViewInit(){$('[data-toggle="tooltip"]').tooltip();const e=JSON.parse(localStorage.getItem("level"));this.level=e.id,this.getBuilding()}onChangeKindEdit(e){this.kindEdit=e.value,this.kindID=e.itemData.id}onChangePartEdit(e){this.partEdit=e.value,this.partID=e.itemData.id}onChangeMaterialEdit(e){this.kindEdit=e.value,this.materialID=e.itemData.id}dataBoundGlue(){$('[data-toggle="tooltip"]').tooltip(),this.selectedRow.length?(this.gridglue.selectRows(this.selectedRow),this.selectedRow=[]):this.gridglue.selectRows(this.selIndex)}actionBeginGlue(e){"beginEdit"===e.requestType&&(this.chemicalNameEdit=e.rowData.name,this.pathNameEdit=e.rowData.pathName,this.modelNoEdit=e.rowData.modelNo,this.materialNameEdit=e.rowData.materialName,this.glue.consumption=e.rowData.consumption,this.glue.kindID=e.rowData.kindID||null,this.glue.partID=e.rowData.partID||null,this.glue.materialID=e.rowData.materialID||null,this.glue.BPFCEstablishID=e.rowData.bpfcEstablishID,this.glue.name=e.rowData.name,this.glue.expiredTime=this.expiredTime,this.history.Before=""===e.rowData.consumption?"0":"Consumption "+e.rowData.consumption,this.detailGlue=!0),"save"===e.requestType&&(this.glue.id=e.rowData.id||0,this.glue.code=e.data.code||"",this.glue.consumption=e.data.consumption,this.glue.glueNameID=e.data.glueNameID,this.glue.kindID=this.kindID||null,this.glue.partID=this.partID||null,this.glue.materialID=this.materialID||null,this.glue.BPFCEstablishID=this.BPFCID,this.glue.name=this.chemicalNameEdit,this.glue.expiredTime=this.expiredTime,this.history.Action="Consumption",this.history.BPFCEstablishID=this.BPFCID,this.history.GlueID=this.glueid,this.history.After="Consumption "+e.data.consumption,this.history.UserID=JSON.parse(localStorage.getItem("user")).user.id,this.glue.createdBy=JSON.parse(localStorage.getItem("user")).user.id,this.bPFCEstablishService.AddHistoryBPFC(this.history).subscribe(()=>{this.getBPFCID({modelNameID:this.modelNameID,modelNoID:this.modelNoID,articleNoID:this.articleNoID,artProcessID:this.artProcessID})}),this.saveGlue()),"delete"===e.requestType&&0!==e.data[0].id&&(this.glueid=e.data[0].id,this.history.Action="Delete",this.history.Before=e.data[0].name,this.history.BPFCEstablishID=this.BPFCID,this.history.GlueID=e.data[0].id,this.history.UserID=JSON.parse(localStorage.getItem("user")).user.id,this.bPFCEstablishService.AddHistoryBPFC(this.history).subscribe(()=>{this.glueService.delete(e.data[0].id).subscribe(()=>{this.getAllGluesByBPFCID(this.BPFCID),this.detailGlue=!1,this.removeLocalStore("details"),this.glueIngredientDetail=[],this.oldDetail=[],this.grid.refresh(),this.grid2.refresh(),this.alertify.success("Glue has been deleted")},e=>{this.alertify.error("Failed to delete the Glue")})}))}rowDeselected(e){const t=e.rowIndex,i=this.getLocalStore("details").sort(this.dynamicSort("position"));!1===this.compareArray(this.oldDetail,i)&&!0===e.isInteracted&&this.alertify.valid("C\u1ea3nh b\xe1o!","B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n b\u1ecf qua s\u1ef1 thay \u0111\u1ed5i n\xe0y kh\xf4ng?").then(e=>{if(this.modified=!0,this.gridglue.getSelectedRowIndexes().length){const e=this.gridglue.dataSource[t];e.name=e.chemical.name,this.gridglue.refresh()}}).catch(e=>{this.gridglue.selectRows([t])})}rowSelected(e){e.data[0]&&(this.GlueNameDefault=e.data[0].name);const t=e.data[0]||e.data;this.selIndex=[e.rowIndex],!e.isInteracted&&e.previousRowIndex&&(this.selIndex=[e.previousRowIndex]),e.isInteracted&&void 0!==e.data.name&&this.modified&&this.loadPreview(Number(e.data.id)),!1!==e.isInteracted&&null===e.target||void 0!==t.name&&this.modified&&this.loadPreview(Number(t.id))}onChangePosition(e,t,i){this.modified=!1,this.history.BeforeAllow=this.glueNewName;const n=e.value;let s=this.getLocalStore("details");if(""===e.value);else{if(0!==s.length){let t="";switch(s[s.length-1].position){case"A":t="B";break;case"B":t="C";break;case"C":t="D";break;case"D":t="E"}if(n!==t)return this.alertify.warning("H\xe3y ch\u1ecdn ch\u1ea5t ti\u1ebfp theo l\xe0 "+t,!0),this.grid.refresh(),this.grid2.refresh(),void(e.cancel=!0)}if(0===s.filter(t=>t.position===e.value).length&&null!==e.value)if(s=this.getLocalStore("details"),this.percentage=0,this.position=e.value,0!==s.filter(e=>e.ingredientName===t.name&&e.position===t.position).length){const i=s.findIndex(e=>e.ingredientName===t.name);s[i].position=e.value,this.setLocalStore("details",s),this.glueIngredientDetail=this.getLocalStore("details"),this.makeFormula(),this.updateChemicalList(),this.grid.refresh()}else{s=this.getLocalStore("details");const i={id:0,glueID:this.glueid,ingredientID:t.id,glueName:"",ingredientName:t.name,percentage:this.percentage,position:e.value,createdDate:new Date,allow:0,expiredTime:t.expiredTime};"A"===e.value&&(i.percentage=100,i.expiredTime=t.expiredTime),s.push(i),this.setLocalStore("details",s),this.glueIngredientDetail=this.getLocalStore("details"),this.makeFormula(),this.updateChemicalList(),"A"===e.value&&this.grid.refresh()}}}recordDoubleClick(e){this.modifiedGlue=!0}toolbarClickIngredient(e){switch(e.item.text){case"Add":e.cancel=!0,this.openIngredientModalComponent()}}onDoubleClickIngredient(e){this.setFocus=e.column}rowSelectedIngredient(e){this.ingridientID=e.data.id}genaratorGlueCode(){this.glue.code=this.makeid(8)}makeid(e){let t="";const i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",n=i.length;for(let s=0;s<e;s++)t+=i.charAt(Math.floor(Math.random()*n));return t}compareArray(e,t){return JSON.stringify(e)===JSON.stringify(t)}setLocalStore(e,t){localStorage.removeItem(e);const i=JSON.stringify(t);localStorage.setItem(e,i)}getLocalStore(e){return(JSON.parse(localStorage.getItem(e))||[]).sort(this.dynamicSort("position"))}removeLocalStore(e){localStorage.removeItem(e)}dynamicSort(e){let t=1;return"-"===e[0]&&(t=-1,e=e.substr(1)),(i,n)=>-1===t?n[e].localeCompare(i[e]):i[e].localeCompare(n[e])}checkColorCode(e){return!0===e.approvalStatus&&!0===e.finishedStatus}checkDone(e){return!0===e.approvalStatus&&!0===e.finishedStatus?"Done":"Undone"}checkStatus(e,t){return!0===e&&!0===t?"Done":"Undone"}renderchemical(){return this.glueIngredientDetail=this.glueIngredientDetail||[],this.glueIngredientDetail.sort(this.dynamicSort("position"))}makeFormula(){var e,t;const i=this.getLocalStore("details").filter(e=>"A"===e.position)||[];this.nameGlue=(null===(e=i[0])||void 0===e?void 0:e.ingredientName)||"",this.nameGlues=(null===(t=i[0])||void 0===t?void 0:t.ingredientName)+"^"+this.glueIngredientDetail[0].allow+"%"||!1,this.A=i[0].ingredientName,this.glueIngredientDetail=this.renderchemical(),void 0===this.glueIngredientDetail[1]?this.B="":(this.B=this.glueIngredientDetail[1].percentage+"%"+this.glueIngredientDetail[1].ingredientName,this.BB=this.glueIngredientDetail[1].percentage+"%"+this.glueIngredientDetail[1].ingredientName+"^"+this.glueIngredientDetail[1].allow+"%"),void 0===this.glueIngredientDetail[2]?this.C="":(this.C=this.glueIngredientDetail[2].percentage+"%"+this.glueIngredientDetail[2].ingredientName,this.CC=this.glueIngredientDetail[2].percentage+"%"+this.glueIngredientDetail[2].ingredientName+"^"+this.glueIngredientDetail[2].allow+"%"),void 0===this.glueIngredientDetail[3]?this.D="":(this.D=this.glueIngredientDetail[3].percentage+"%"+this.glueIngredientDetail[3].ingredientName,this.DD=this.glueIngredientDetail[3].percentage+"%"+this.glueIngredientDetail[3].ingredientName+"^"+this.glueIngredientDetail[3].allow+"%"),void 0===this.glueIngredientDetail[4]?this.E="":(this.E=this.glueIngredientDetail[4].percentage+"%"+this.glueIngredientDetail[4].ingredientName,this.EE=this.glueIngredientDetail[4].percentage+"%"+this.glueIngredientDetail[4].ingredientName+"^"+this.glueIngredientDetail[4].allow+"%"),this.glueIngredientDetail.length>0?(this.percentageCount=this.glueIngredientDetail.map(e=>e.percentage),this.percentageCountEdit=this.glueIngredientDetail.map(e=>e),this.totalPercentage=this.percentageCount.reduce((e,t)=>e+t,0)):(this.percentageCount=[],this.percentageCountEdit=[],this.totalPercentage=0);const n=this.gridglue.getSelectedRowIndexes()[0];this.gridglue.getSelectedRowIndexes().length&&(this.gridglue.getSelectedRecords(),this.gridglue.dataSource[n].name=this.formula(),this.gridglue.refresh())}formula(){return this.B&&this.C&&this.D&&this.E?`{[ (${this.nameGlue}+ ${this.B}) + ${this.C} ] + ${this.D}}+ ${this.E}`:this.B&&this.C&&this.D?`[(${this.nameGlue} + ${this.B}) + ${this.C}] + ${this.D}`:this.B&&this.C?`(${this.nameGlue} + ${this.B}) + ${this.C}`:this.B?`${this.nameGlue} + ${this.B}`:""+this.nameGlue}formulaTamp(){return this.BB&&this.CC&&this.DD&&this.EE?(this.glueNewName=`{[ (${this.nameGlues}+ ${this.BB}) + ${this.CC} ] + ${this.DD}}+ ${this.EE}`,`{[ (${this.nameGlues}+ ${this.BB}) + ${this.CC} ] + ${this.DD}}+ ${this.EE}`):this.BB&&this.CC&&this.DD?(this.glueNewName=`[(${this.nameGlues} + ${this.BB}) + ${this.CC}] + ${this.DD}`,`[(${this.nameGlues} + ${this.BB}) + ${this.CC}] + ${this.DD}`):this.BB&&this.CC?(this.glueNewName=`(${this.nameGlues} + ${this.BB}) + ${this.CC}`,`(${this.nameGlues} + ${this.BB}) + ${this.CC}`):this.BB?(this.glueNewName=`${this.nameGlues} + ${this.BB}`,`${this.nameGlues} + ${this.BB}`):""+this.nameGlues}getDetail(e){this.glueIngredientService.getDetail(e).subscribe(e=>{var t,i,n,s;this.glueIngredientDetail=e.glueIngredients,this.setLocalStore("details",this.glueIngredientDetail),this.setLocalStore("detailsTamp",this.glueIngredientDetail),this.glueIngredientDetail=this.renderchemical(),this.oldDetail=this.renderchemical();const l=this.glueIngredientDetail.filter(e=>"A"===e.position)||[];this.nameGlue=(null===(t=l[0])||void 0===t?void 0:t.ingredientName)||"",this.nameGlues=(null===(i=l[0])||void 0===i?void 0:i.ingredientName)+"^"+(null===(n=this.glueIngredientDetail[0])||void 0===n?void 0:n.allow)+"%"||!1,this.A=(null===(s=l[0])||void 0===s?void 0:s.ingredientName)||"",void 0===this.glueIngredientDetail[1]?this.B="":(this.B=this.glueIngredientDetail[1].percentage+"%"+this.glueIngredientDetail[1].ingredientName,this.BB=this.glueIngredientDetail[1].percentage+"%"+this.glueIngredientDetail[1].ingredientName+"^"+this.glueIngredientDetail[1].allow+"%"),void 0===this.glueIngredientDetail[2]?this.C="":(this.C=this.glueIngredientDetail[2].percentage+"%"+this.glueIngredientDetail[2].ingredientName,this.CC=this.glueIngredientDetail[2].percentage+"%"+this.glueIngredientDetail[2].ingredientName+"^"+this.glueIngredientDetail[2].allow+"%"),void 0===this.glueIngredientDetail[3]?this.D="":(this.D=this.glueIngredientDetail[3].percentage+"%"+this.glueIngredientDetail[3].ingredientName,this.DD=this.glueIngredientDetail[3].percentage+"%"+this.glueIngredientDetail[3].ingredientName+"^"+this.glueIngredientDetail[3].allow+"%"),void 0===this.glueIngredientDetail[4]?this.E="":(this.E=this.glueIngredientDetail[4].percentage+"%"+this.glueIngredientDetail[4].ingredientName,this.EE=this.glueIngredientDetail[4].percentage+"%"+this.glueIngredientDetail[4].ingredientName+"^"+this.glueIngredientDetail[4].allow+"%"),this.glueIngredientDetail.length>0?(this.percentageCount=this.glueIngredientDetail.map(e=>e.percentage),this.percentageCount.join("+"),this.percentageCountEdit=this.glueIngredientDetail.map(e=>e),this.totalPercentage=this.percentageCount.reduce((e,t)=>e+t,0)):(this.percentageCount=[],this.percentageCountEdit=[],this.totalPercentage=0)})}updateChemicalList(){const e=this.getLocalStore("details");for(const t of e){const e=this.ingredients1.findIndex(e=>e.name===t.ingredientName&&e.id===t.ingredientID);-1!==e&&(this.ingredients1[e].position=t.position,this.ingredients1[e].percentage=t.percentage,this.ingredients1[e].allow=t.allow)}for(const t of e){const e=this.ingredients2.findIndex(e=>e.name===t.ingredientName&&e.id===t.ingredientID);-1!==e&&(this.ingredients2[e].position=t.position,this.ingredients2[e].percentage=t.percentage,this.ingredients2[e].allow=t.allow)}}actionBeginIngredient(e){if("beginEdit"===e.requestType){if(null===e.rowData.position)return this.alertify.warning("H\xe3y ch\u1ecdn t\xean tr\u01b0\u1edbc khi ch\u1ec9nh s\u1eeda!",!0),void(e.cancel=!0);if("A"===e.rowData.position)return this.alertify.warning("Kh\xf4ng \u0111\u01b0\u1ee3c ch\u1ec9nh s\u1eeda ch\u1ea5t A!",!0),void(e.cancel=!0);this.editPercentage.glueID=this.glueid,this.editPercentage.ingredientID=e.rowData.id,this.percentageDefault=e.rowData.percentage,this.editAllow.glueID=this.glueid,this.history.BeforeAllow="",this.history.AfterAllow="",this.editAllow.ingredientID=e.rowData.id,this.allowDefault=e.rowData.allow||0}if("save"===e.requestType){this.percentageEdit={percentage:Number(e.data.percentage),id:Number(e.rowData.id)},this.allowEdit={allow:Number(e.data.allow),id:Number(e.rowData.id)},"edit"===e.action&&(this.allowChange=e.data.allow||0,this.percentageChange=e.data.percentage),this.editPercentage.percentage=e.data.percentage,this.editAllow.allow=e.data.allow;const t=Number(this.percentageDefault)!==Number(this.percentageChange),i=Number(this.allowDefault)!==Number(this.allowChange);if(t){this.modified=!1;const t=this.getLocalStore("details"),i=t.findIndex(t=>t.ingredientName===e.data.name&&t.ingredientID===e.data.id);t[i].percentage=e.data.percentage,this.setLocalStore("details",t),this.updateChemicals()}if(i){const t=this.getLocalStore("details"),i=t.findIndex(t=>t.ingredientName===e.data.name&&t.ingredientID===e.data.id);t[i].allow=e.data.allow,this.setLocalStore("details",t),this.modified=!1,this.history.BeforeAllow=this.glueNewName,this.updateChemicals()}}"delete"===e.requestType&&this.deleteIngredient()}updateGlueIngredient(){}loadPreview(e){this.glueid=Number(e),this.getIngredients(),this.getDetail(this.glueid),this.detailGlue=!0}resolver(){this.route.data.subscribe(e=>{this.glues=e.glues.result,this.paginationG=e.glues.pagination})}onService(){this.ingredientService.currentIngredient.subscribe(e=>{300===e&&(this.getIngredients(),this.updateChemicalList(),this.ingredientService.changeIngredient(0))})}mapGlue(e){1==!e.status?(this.percentage=0,this.mapGlueIngredient({ingredientID:e.id,percentage:this.percentage,glueID:this.glueid})):this.delete(this.glueid,e.id)}getIngredients(){this.glueIngredientService.getIngredients(this.glueid).subscribe(e=>{this.ingredients1=e.result.list1,this.ingredients2=e.result.list2},e=>{this.alertify.error(e)})}getGlues(){this.glueService.getAllGlue().subscribe(e=>{this.glues=e},e=>{this.alertify.error(e)})}mapGlueIngredients(e){this.glueIngredientService.mapGlueIngredient(e).subscribe(e=>{void 0===this.subID?(this.sortBySup(0),this.getDetail(this.glueid)):(this.sortBySup(this.subID),this.getDetail(this.glueid))})}mapGlueIngredient(e){this.glueIngredientService.mappGlueIngredient(e).subscribe(e=>{void 0===this.subID?(this.getAllGluesByBPFCID(this.BPFCID),this.sortBySup(0),this.getDetail(this.glueid)):(this.sortBySup(this.subID),this.getDetail(this.glueid),this.getAllGluesByBPFCID(this.BPFCID))})}mapGlueIngredientByGlueID(e){this.glueIngredientService.mapGlueIngredientByGlueID(e).subscribe(e=>{this.alertify.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng!"),this.getAllGluesByBPFCID(this.BPFCID),this.detailGlue=!0,this.modified=!0,this.modified=!0,void 0===this.subID?(this.sortBySup(0),this.getDetail(this.glueid)):(this.sortBySup(this.subID),this.getDetail(this.glueid))})}openIngredientModalComponent(){const e=this.modalService.open(O.a,{size:"md"});e.componentInstance.ingredient=this.ingredient,e.componentInstance.title="Add Ingredient",e.result.then(e=>{},e=>{})}actionCompleteIngredient(e){"beginEdit"===e.requestType&&"Item"!==this.setFocus.field&&(e.form.elements.namedItem(this.setFocus.field).focus(),e.form.elements.namedItem(this.setFocus.field).value="")}openPopupDropdownlist(){$('[data-toggle="tooltip"]').tooltip()}toolbarClick(e){switch(e.item.text){case"Add New":const t=this.getLocalStore("details").sort(this.dynamicSort("position"));!1===this.compareArray(this.oldDetail,t)&&t.length>0&&this.oldDetail.length>0?this.alertify.valid("C\u1ea3nh b\xe1o!","B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n b\u1ecf qua nh\u1eefng thay \u0111\u1ed5i n\xe0y?").then(e=>{this.glue.id=0,this.glue.name="1",this.glue.BPFCEstablishID=this.BPFCID,this.glue.createdBy=JSON.parse(localStorage.getItem("user")).user.id,this.saveGlue()}).catch(t=>{e.cancel=!0}):(this.glue.id=0,this.glue.name="1",this.glue.BPFCEstablishID=this.BPFCID,this.glue.createdBy=JSON.parse(localStorage.getItem("user")).user.id,this.saveGlue())}}openModal(e){this.getModelNamesClone(),this.getAllProcess(),this.modalReference=this.modalService.open(e)}openModalHistory(e){this.modalReference=this.modalService.open(e,{size:"xxl"}),this.LoadHistoryBPFC()}LoadHistoryBPFC(){this.bPFCEstablishService.LoadHistoryBPFC(this.BPFCID).subscribe(e=>{this.historyData=e.map(e=>({id:e.id,glueID:e.glueID,createdTime:e.createdTime,bpfcEstablishID:e.bpfcEstablishID,before:e.before,after:e.after,action:e.action,remark:e.remark,userID:e.userID,createdBy:this.createdBy(e.userID)}))})}actionBeginHistory(e){"save"===e.requestType&&this.bPFCEstablishService.UpdateHistoryBPFC({ID:e.data.id,Remark:e.data.remark}).subscribe(e=>{e&&this.alertify.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng!")})}getAllUsers(){this.buildingUserService.getAllUsers(1,1e3).subscribe(e=>{this.userData=e.result})}createdBy(e){if(0===e)return"#N/A";const t=this.userData.filter(t=>t.ID===e)[0];return void 0!==t?t.Username:"#N/A"}cloneModelname(){this.alertify.confirm("Sao ch\xe9p model name!","B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n sao ch\xe9p model name kh\xf4ng?",()=>{this.modalNameService.cloneModelname(this.modelNameID,this.modelNameClone,this.modelNoClone,this.valueProcess).subscribe(e=>{this.alertify.success("the model name has been cloned"),this.modalReference.close(),this.modelNameDropdownlist.hidePopup()})})}cloneArticleModelname(){this.alertify.confirm("Sao ch\xe9p article!","B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n sao ch\xe9p article kh\xf4ng?",()=>{this.modalNameService.cloneArticleModelname(this.modelNameID,this.modelNameClone,this.modelNoClone,this.articleName,this.processID).subscribe(e=>{this.alertify.success("Sao ch\xe9p th\xe0nh c\xf4ng!"),this.modalReference.close(),this.modelNameDropdownlist.hidePopup()})})}delete(e,t){this.glueIngredientService.delete(e,t).subscribe(t=>{this.alertify.success("\u0110\xe3 x\xf3a th\xe0nh c\xf4ng!"),this.getIngredients(),this.getDetail(e)})}deleteGlue(e){this.alertify.confirm("X\xf3a keo",'B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n x\xf3a keo n\xe0y kh\xf4ng "'+e.id+'" ?',()=>{this.glueService.delete(e.id).subscribe(()=>{this.getGlues(),this.alertify.success("\u0110\xe3 x\xf3a th\xe0nh c\xf4ng!")},e=>{this.alertify.error("X\xf3a th\u1ea5t b\u1ea1i r\u1ed3i!")})})}deleteIngridient(e){this.alertify.confirm("X\xf3a ingredient",'B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n x\xf3a ingredient n\xe0y kh\xf4ng "'+e.id+'" ?',()=>{this.ingredientService.delete(e.id).subscribe(()=>{this.getIngredients(),this.alertify.success("\u0110\xe3 x\xf3a th\xe0nh c\xf4ng!")},e=>{this.alertify.error("X\xf3a th\u1ea5t b\u1ea1i r\u1ed3i!")})})}getAllGluesByBPFCID(e){this.glueService.getAllGluesByBPFCID(e).subscribe(e=>{this.glues=e})}getAllGluesByBPFCID2(e){this.glueService.getAllGluesByBPFCID(e).subscribe(e=>{void 0===this.ingredientID?(this.glues=e,e.length>0&&(this.detailGlue=!0)):(this.glueid=e[0].id,this.glueIngredient2.ingredientID=this.ingredientID,this.glueIngredient2.percentage=100,this.glueIngredient2.glueID=this.glueid,this.glueIngredient2.position="A",this.mapGlueIngredient(this.glueIngredient2))})}updateChemicals(){this.ingredientService.sortBySup(this.glueid,this.subID).subscribe(e=>{this.ingredients1=e.list1,this.ingredients2=e.list2;const t=this.getLocalStore("details");for(const i of t){const e=this.ingredients1.findIndex(e=>e.name===i.ingredientName&&e.id===i.ingredientID);-1!==e&&(this.ingredients1[e].position=i.position,this.ingredients1[e].percentage=i.percentage,this.ingredients1[e].allow=i.allow)}for(const i of t){const e=this.ingredients2.findIndex(e=>e.name===i.ingredientName&&e.id===i.ingredientID);-1!==e&&(this.ingredients2[e].position=i.position,this.ingredients2[e].percentage=i.percentage,this.ingredients2[e].allow=i.allow)}this.glueIngredientDetail=t,this.makeFormula()})}sortBySup(e){0===this.gridglue.getSelectedRowIndexes().length?this.alertify.warning("Please select a glue!",!0):(this.subID=e,this.ingredientService.sortBySup(this.glueid,e).subscribe(t=>{if(this.ingredients1=t.list1,this.ingredients2=t.list2,0===e){const e=this.getLocalStore("details");this.ingredients1=e.map(e=>({id:e.ingredientID,name:e.ingredientName,code:"",percentage:e.percentage,createdDate:e.createdDate,supplierID:0,allow:e.allow,position:e.position,expiredTime:e.expiredTime,daysToExpiration:e.daysToExpiration,voc:e.voc,materialNO:e.materialNO,unit:e.unit,real:e.real,glueTypeID:0,cbd:e.cbd,replacementFrequency:0,prepareTime:0,partNO:"",standardCycle:0})),this.glueIngredientDetail=e}else this.updateChemicalList()}))}saveGlue(){0===this.glue.id||void 0===this.glue.id?(""===this.glue.code&&this.genaratorGlueCode(),this.createGlue()):this.onChangeChemical?this.updateChemical():this.update(),this.oldDetail=[],localStorage.removeItem("details"),this.glueIngredientDetail=[],this.gridglue.refresh(),this.selectedRow=[0],this.selIndex=[0],this.modified=!0}getBuilding(){JSON.parse(localStorage.getItem("user"))}getAllIngredient(){this.ingredientService.getAllIngredient().subscribe(e=>{this.ingrediented=e})}createGlue(){this.glueService.create(this.glue).subscribe(()=>{this.alertify.success("Add successfully!<br>\u0110\xe3 t\u1ea1o th\xe0nh c\xf4ng!"),this.getAllGluesByBPFCID(this.BPFCID),this.clearGlueForm(),this.genaratorGlueCode(),this.expiredTime=0},e=>{this.alertify.error(e),this.genaratorGlueCode()})}finished(){const e=JSON.parse(localStorage.getItem("user")).user.id;if(0===this.gridglue.getSelectedRowIndexes().length)this.alertify.warning("H\xe3y ch\u1ecdn v\xe0o 1 glue v\xe0 t\u1ea1o c\xf4ng th\u1ee9c sau \u0111\xf3 m\u1edbi b\u1ea5m ho\xe0n th\xe0nh!",!0);else{this.history.BPFCEstablishID=this.BPFCID,this.history.GlueID=this.glueid,this.history.After=this.GlueNameDefault,this.history.AfterAllow=this.glueNewName,this.history.UserID=e,this.bPFCEstablishService.AddHistoryBPFC(this.history).subscribe(()=>{});const t=this.getLocalStore("details"),i=this.gridglue.getSelectedRecords()[0];i.expiredTime=t.filter(e=>"A"===e.position)[0].expiredTime,i.kindID=0===i.kindID?null:i.kindID,i.partID=0===i.partID?null:i.partID,i.materialID=0===i.materialID?null:i.materialID,this.selectedRow=this.gridglue.getSelectedRowIndexes(),t.length>0&&this.mapGlueIngredientByGlueID({glueName:i.name,glueID:i.id,glueIngredientForMapDto:t})}}clearGlueForm(){this.glue.gluename="",this.glue.kindID=null,this.glue.partID=null,this.glue.materialID=null,this.glue.consumption="",this.showBarCode=!1}update(){this.glueService.update(this.glue).subscribe(e=>{this.alertify.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng!"),this.getAllGluesByBPFCID(this.BPFCID),this.detailGlue=!1,this.history.Action="Created",this.expiredTime=0})}updateChemical(){this.glueService.updateChemical(this.glue).subscribe(e=>{this.alertify.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng!"),this.getAllGluesByBPFCID(this.BPFCID),this.detailGlue=!1,this.onChangeChemical=!1,this.history.Action="Created"})}deleteIngredient(){this.ingredientService.delete(this.ingridientID).subscribe(()=>{const e=this.getLocalStore("details").filter(e=>e.ingredientID!==this.ingridientID);this.setLocalStore("details",e),this.glueIngredientDetail=e,this.getIngredients(),this.makeFormula(),this.alertify.success("\u0110\xe3 x\xf3a th\xe0nh c\xf4ng!")},e=>{this.alertify.error("X\xf3a th\u1ea5t b\u1ea1i r\u1ed3i!")})}approval(){const e=this.gridglue.dataSource;let t=!1,i=!1,n=!1;if(e){for(const l of e){if("STF"===this.artProcess&&null===l.kindID)return this.alertify.warning("Please maintain the kind for each glue <br>\n             Vui l\xf2ng c\xe0i \u0111\u1eb7t kind cho m\u1ed7i lo\u1ea1i keo!<br>\n          <br>\n              ",!0),void(this.approvalStatus=!this.approvalStatus);if(l.glueIngredients.length>0){const e=l.glueIngredients.filter(e=>"A"!==e.position);for(const n of e){if(n.allow<=0&&"A"!==n.position)return t=!1,this.approvalStatus=!this.approvalStatus,void this.alertify.warning(`The allowance of checmical name ${n.ingredient.name} must be greater than 0 <br>\n              M\u1ee9c cho ph\xe9p c\u1ee7a h\xf3a ch\u1ea5t ${n.ingredient.name} ph\u1ea3i l\u1edbn h\u01a1n 0!<br>\n               <label>Glue Name: </label> ${l.name} <br>\n              `,!0);if(n.percentage<=0&&"A"!==n.position)return i=!1,this.approvalStatus=!this.approvalStatus,void this.alertify.warning(`The percentage of checmical name ${n.ingredient.name} must be greater than 0 <br>\n              Ph\u1ea7n tr\u0103m c\u1ee7a h\xf3a ch\u1ea5t ${n.ingredient.name} ph\u1ea3i l\u1edbn h\u01a1n 0!<br>\n               <label>Glue Name: </label> ${l.name} <br>\n              `,!0);t=!0,i=!0}}if(+l.consumption<=0)return n=!1,this.approvalStatus=!this.approvalStatus,void this.alertify.warning(`The consumption of glue name ${l.name} must be greater than 0 <br>\n          M\u1ee9c ti\xeau th\u1ee5 c\u1ee7a keo ${l.name} ph\u1ea3i l\u1edbn h\u01a1n 0! <br>\n          <label>Glue Name: </label> ${l.name} <br>\n          `,!0);n=!0}const s=JSON.parse(localStorage.getItem("user")).user.id;this.bPFCEstablishService.approval(this.BPFCID,s).subscribe(e=>{this.alertify.success("The BPFC has been approved!"),this.createdStatus=this.approvalStatus;const t=this.modelNameDropdownlist.getDataByValue(this.modelNameDropdownlist.value);this.modelNameDropdownlist.valueTemplate=`(${this.checkStatus(this.approvalStatus,this.createdStatus)}) ${t.name}`})}}done(){const e=this.gridglue.dataSource;let t=!1,i=!1,n=!1;if(e){for(const s of e){if("STF"===this.artProcess&&null===s.kindID)return this.alertify.warning("Please maintain the kind for each glue <br>\n             Vui l\xf2ng c\xe0i \u0111\u1eb7t kind cho m\u1ed7i lo\u1ea1i keo!<br>\n          <br>\n              ",!0),void(this.createdStatus=!this.createdStatus);if(s.glueIngredients.length>0){const e=s.glueIngredients.filter(e=>"A"!==e.position);for(const n of e){if(n.allow<=0)return t=!1,this.createdStatus=!this.createdStatus,void this.alertify.warning(`The allow of checmical name ${n.ingredient.name} is greater than 0 <br>\n              M\u1ee9c cho ph\xe9p c\u1ee7a h\xf3a ch\u1ea5t ${n.ingredient.name} ph\u1ea3i l\u1edbn h\u01a1n 0!<br>\n               <label>Glue Name: </label> ${s.name} <br>\n              `,!0);if(n.percentage<=0)return i=!1,this.createdStatus=!this.createdStatus,void this.alertify.warning(`The percentage of checmical name ${n.ingredient.name} is greater than 0 <br>\n              Ph\u1ea7n tr\u0103m c\u1ee7a h\xf3a ch\u1ea5t ${n.ingredient.name} ph\u1ea3i l\u1edbn h\u01a1n 0!<br>\n               <label>Glue Name: </label> ${s.name} <br>\n              `,!0);t=!0,i=!0}0===e.length&&(t=!0,i=!0)}if(s.consumption<=0)return n=!1,this.createdStatus=!this.createdStatus,void this.alertify.warning(`The consumption of glue name ${s.name} is greater than 0 <br>\n          M\u1ee9c ti\xeau th\u1ee5 c\u1ee7a keo ${s.name} ph\u1ea3i l\u1edbn h\u01a1n 0! <br>\n          <label>Glue Name: </label> ${s.name} <br>\n          `,!0);n=!0}if(t&&i&&n){const e=JSON.parse(localStorage.getItem("user")).user.id;this.bPFCEstablishService.done(this.BPFCID,e).subscribe(e=>{!0===e.status?(this.alertify.success(e.message),this.createdStatus=this.createdStatus):this.alertify.success(e.message)})}}}getModelNames(){this.modalNameService.getAllModalName().subscribe(e=>{this.modelNameData=e.map(e=>({id:e.id,name:e.name}))})}getArticleNoByModelNameID(e){this.articleNoService.getArticleNoByModelNoID(e).subscribe(e=>{this.articleNoData=e})}getModelNoByModelNameID(e){this.modelNoService.getModelNoByModelNameID(e).subscribe(e=>{this.modelNoData=e})}getArtProcessByArticleNoID(e){this.artProcessService.getArtProcessByArticleNoID(e).subscribe(e=>{this.artProcessData=e.map(e=>({id:e.id,name:1===e.processID?"ASY":"STF"}))})}getAllProcess(){this.artProcessService.GetAllProcess().subscribe(e=>{this.artProcessDataClone2=e})}getAllKind(){this.kindService.getAllKind().subscribe(e=>{this.kinds=e})}getAllPart(){this.partService.getAllPart().subscribe(e=>{this.parts=e})}getAllMaterial(){this.materialService.getAllMaterial().subscribe(e=>{this.materials=e})}getIngredientsByGlueID(){this.ingredientService.getIngredientsByGlueID(this.glueid).subscribe(e=>{this.ingredients1=e.list1,this.ingredients2=e.list2})}getAllSupllier(){this.ingredientService.getAllSupplier().subscribe(e=>{this.supplier=e})}getArticleNoByModelNoID(e){this.articleNoService.getArticleNoByModelNoID(e).subscribe(e=>{this.articleNosData=e})}getBPFCID(e){this.bPFCEstablishService.getBPFCID(e).subscribe(e=>{this.resetLifeCycleBPFC(),this.BPFCID=null==e?void 0:e.id,this.approvalStatus=e.approvalStatus,this.createdStatus=e.finishedStatus,this.artProcess=e.artProcess,this.glue.BPFCEstablishID=this.BPFCID,this.getAllGluesByBPFCID(this.BPFCID),this.getAllPart(),this.getAllKind(),this.getAllMaterial(),this.getAllIngredient(),this.existGlue=!0,this.modified=!0})}OndataBound(e){this.modelNoDropdownlist.value=this.value}getModelNamesClone(){this.modalNameService.getAllModalName().subscribe(e=>{this.modelNameDataClone=e.map(e=>({id:e.id,name:e.name})),this.getModelNoByModelNameIDClone(this.modelNameIDClone),this.articleNosDataClone=[],this.artProcessDataClone=[]})}getArticleNoByModelNameIDClone(e){this.articleNoService.getArticleNoByModelNoID(e).subscribe(e=>{this.articleNosDataClone=e})}getModelNoByModelNameIDClone(e){this.modelNoService.getModelNoByModelNameID(e).subscribe(e=>{this.modelNOsDataClone=e}),this.getArticleNoByModelNameIDClone(this.valuemodelNo)}getArtProcessByArticleNoIDClone(e){this.artProcessService.getArtProcessByArticleNoID(e).subscribe(e=>{this.artProcessDataClone=e.map(e=>({id:e.id,name:1===e.ProcessID?"ASY":"STF"}))})}clone(e){this.modalNameService.clone(e).subscribe(e=>{!0===e.status?(this.alertify.success("\u0110\xe3 sao ch\xe9p th\xe0nh c\xf4ng!"),this.modalService.dismissAll(),this.getArtProcessByArticleNoID(this.articleNoID),this.clearFormClone()):this.alertify.error("The BPFC exists!")})}onChangeModelName(e){this.resetLifeCycleBPFC(),this.modelNameID=e.itemData.id,this.getModelNoByModelNameID(this.modelNameID),this.existGlue=!1,this.modelNameIDClone=e.value,this.value=e.value,this.valuemodelNo=0,this.modified=!1,this.modelNoData=[],this.articleNosData=[],this.artProcessData=[],this.modelNameSelect=!0,this.modelNoSelect=!1,this.modelArtSelect=!1,this.modelProcessSelect=!1}onChangeModelNo(e){e.isInteracted&&(this.modelNoID=e.itemData.id,this.valuemodelNo=e.itemData.id,this.getArticleNoByModelNoID(this.modelNoID),this.existGlue=!1,this.modified=!1,this.articleNosData=[],this.artProcessData=[],this.modelNoSelect=!0)}onChangeArticleNo(e){e.isInteracted&&(this.articleNoID=e.itemData.id,this.getArtProcessByArticleNoID(this.articleNoID),this.existGlue=!1,this.modified=!1,this.modelArtSelect=!0,this.artProcessData=[])}onClickProcess(e){this.modelProcessSelect=!0,e.target.defaultValue&&(this.artProcessID=Number(e.target.defaultValue),this.getBPFCID({modelNameID:this.modelNameID,modelNoID:this.modelNoID,articleNoID:this.articleNoID,artProcessID:this.artProcessID}))}ClickProcessData(e){}clearFormClone(){this.modelNameIDClone=this.value,this.modelNOIDClone=this.valuemodelNo,this.articleNOIDClone=0,this.artProcessIDClone=0,this.articleNosDataClone=[],this.artProcessDataClone=[],this.artProcessDataClone2=[]}onClickClone(){const e={modelNameID:this.modelNameIDClone,modelNOID:this.modelNOIDClone,articleNOID:this.articleNOIDClone,artProcessID:Number(this.artProcessIDClone),bpfcID:this.BPFCID,cloneBy:JSON.parse(localStorage.getItem("user")).user.id};this.clone(e)}onChangeModelNameClone(e){this.value!==e.itemData.id&&(this.modelNOsDataClone=[],this.modelNameIDClone=e.itemData.id,this.getModelNoByModelNameIDClone(this.modelNameIDClone)),this.modelNameIDClone=e.itemData.id,this.getModelNoByModelNameIDClone(this.modelNameIDClone)}onChangeModelNoClone(e){this.modelNOIDClone=e.itemData.id,null!==this.modelNOIDClone&&this.getArticleNoByModelNameIDClone(this.modelNOIDClone),this.articleNosDataClone=[],this.artProcessDataClone=[]}onChangeArticleNoClone(e){e.isInteracted&&(this.articleNOIDClone=e.itemData.id,this.getArtProcessByArticleNoIDClone(this.articleNOIDClone))}onChangeProcessClone(e){e.isInteracted&&(this.artProcessIDClone=e.itemData.id)}changeAllowColor(e){return null===e.position?"":this.positions.includes(e.position)&&0===e.allow||this.positions.includes(e.position)&&null===e.allow?"font-weight-bold text-white p-2 rounded-circle warning-text":void 0}changePercentageColor(e){return null===e.percentage?"":this.positions.includes(e.position)&&0===e.percentage?"font-weight-bold text-white p-2 rounded-circle warning-text":void 0}changeConsumptionColor(e){return 0===e.glueIngredients.length?"":""===e.consumption?"font-weight-bold text-white p-2 rounded-circle warning-text":void 0}}return e.\u0275fac=function(t){return new(t||e)(R.Mb(J),R.Mb(M.a),R.Mb(z.a),R.Mb(F.a),R.Mb(c.b),R.Mb(P.a),R.Mb(j.a),R.Mb(T.a),R.Mb(H),R.Mb(_),R.Mb(Q.a),R.Mb(q.a),R.Mb(V.a),R.Mb(k.a),R.Mb(X),R.Mb(Y.a))},e.\u0275cmp=R.Gb({type:e,selectors:[["app-glue-ingredient"]],viewQuery:function(e,t){if(1&e&&(R.Qc(W,!0),R.Qc(Z,!0),R.Qc(ee,!0),R.Qc(te,!0),R.Qc(ie,!0),R.Qc(ne,!0),R.Qc(se,!0),R.Qc(le,!0)),2&e){let e;R.xc(e=R.dc())&&(t.switch=e.first),R.xc(e=R.dc())&&(t.grid=e.first),R.xc(e=R.dc())&&(t.gridglue=e.first),R.xc(e=R.dc())&&(t.grid2=e.first),R.xc(e=R.dc())&&(t.modelNameDropdownlist=e.first),R.xc(e=R.dc())&&(t.modelNoDropdownlist=e.first),R.xc(e=R.dc())&&(t.chemicalDropdownlist=e.first),R.xc(e=R.dc())&&(t.positionDropdownlist=e)}},features:[R.yb([S.n,S.f,S.k])],decls:51,vars:20,consts:[[1,"row"],[1,"col-md-5"],[1,"card"],[1,"col-md-12","card-body","table-responsive"],[1,"col-md-3","mt-2"],[1,"col-md-8","mt-2"],["placeholder","Select a Model Name",1,"w-100","float-left",3,"dataSource","fields","allowFiltering","ngModel","open","ngModelChange","filtering","select"],["modelNameDropdownlist",""],["class","col-md-1 mt-2",4,"ngIf"],["placeholder","Select a Model NO",1,"w-100","float-left",3,"dataSource","fields","allowFiltering","ngModel","open","ngModelChange","filtering","select"],["modelNoDropdownlist",""],[1,"col-md-1","mt-2"],["placeholder","Select article NO   ",1,"w-100","float-left",3,"dataSource","fields","allowFiltering","ngModel","open","ngModelChange","filtering","select"],[1,"col-md-9","mt-2"],[4,"ngFor","ngForOf"],[1,"card-body","table-responsive","p-0"],["class","control-section",4,"ngIf"],[1,"col-md-7"],[1,"card-header"],[1,"card-title"],["class","card-tools",4,"ngIf"],["class","card-body",4,"ngIf"],["cloneArticleModal",""],["cloneModal",""],["HistoryModal",""],["ejs-button","","cssClass","e-info",1,"float-right","ml-1",3,"click"],[1,"fa","fa-clone"],["name","process",3,"label","value","click"],[1,"control-section"],["height","250px","showColumnMenu","true","allowSorting","true","allowResizing","true","gridLines","Both",3,"dataSource","editSettings","toolbar","allowSorting","selectedRowIndex","rowDeselected","actionBegin","rowSelected","created","toolbarClick","dataBound"],["gridglue",""],["field","name","isPrimaryKey","true","headerText","Chemical","textAlign","Center","width","150"],["headerTemplate",""],["template",""],["field","consumption","headerText","Std. Con.(g)","textAlign","Center","width","150"],["field","expiredTime","headerText","Expired Time","isPrimaryKey","true","textAlign","Center","width","150"],["field","kindName","headerText","Kind","textAlign","Center","width","150"],["editTemplate",""],["field","partName","headerText","Part","textAlign","Center","width","150"],["field","materialName","headerText","Material","textAlign","Center","width","150"],["data-toggle","tooltip","data-placement","top",3,"title"],[3,"dataSource","ngModel","fields","allowFiltering","ngModelChange","select"],["kindDropdownlist",""],["popupHeight","200px","popupWidth","250px",3,"dataSource","ngModel","fields","allowFiltering","ngModelChange","select"],["glueDropdownlist",""],[1,"card-tools"],["type","button",1,"btn","btn-danger","btn-sm","mr-2","d-none"],[1,"fas","fa-undo"],["style","width: 100px; margin-right: 10px;",3,"onLabel","offLabel","disabled","ngModel","checked","click","ngModelChange",4,"ngIf"],[4,"ngIf"],["type","button","ejs-button","","cssClass","e-small e-success ml-2",3,"click",4,"ngIf"],["type","button","ejs-button","","cssClass","e-small e-default ml-2",3,"click",4,"ngIf"],[2,"width","100px","margin-right","10px",3,"onLabel","offLabel","disabled","ngModel","checked","click","ngModelChange"],["switch",""],["onLabel","Approved","style","width: 120px;",3,"offLabel","ngModel","checked","click","ngModelChange",4,"ngIf"],["onLabel","Approved",2,"width","120px",3,"offLabel","ngModel","checked","click","ngModelChange"],["type","button","ejs-button","","cssClass","e-small e-success ml-2",3,"click"],[1,"fas","fa-save"],["type","button","ejs-button","","cssClass","e-small e-default ml-2",3,"click"],[1,"fas","fa-history"],[1,"card-body"],[1,"col-lg-12","col-xs-12","col-12",2,"text-align","center"],["type","button",1,"btn","bg-gradient-secondary","btn-sm","rounded-pill",3,"click"],["type","button","style","margin: 3px","class","btn btn-info btn-sm rounded-pill",3,"click",4,"ngFor","ngForOf"],[1,"col-md-6"],["height","675px","gridLines","Both","showColumnMenu","true","allowSorting","true","allowResizing","true",3,"dataSource","allowSorting","editSettings","toolbar","actionComplete","recordDoubleClick","actionBegin","toolbarClick","rowSelected"],["grid",""],["field","Item","isPrimaryKey","true","headerText","Item","width","80","textAlign","Center"],["field","name","isPrimaryKey","true","headerText","Name","width","140","textAlign","Center"],["field","percentage","headerText","%","textAlign","Center","width","60"],["field","allow","headerText","Allow (%)","textAlign","Center","width","60"],["height","675px","showColumnMenu","true","allowSorting","true","allowResizing","true","gridLines","Both",3,"dataSource","allowSorting","editSettings","toolbar","actionComplete","recordDoubleClick","actionBegin","toolbarClick","rowSelected"],["grid2",""],[2,"visibility","hidden"],[2,"list-style-type","square","font-weight","bold"],["style","list-style: none;",4,"ngFor","ngForOf"],[2,"list-style","none"],[1,"font-weight-bold","text-danger"],["type","button",1,"btn","btn-info","btn-sm","rounded-pill",2,"margin","3px",3,"click"],[1,"fas","fa-cannabis"],[3,"dataSource","value","fields","allowFiltering","change"],["positionDropdownlist",""],[1,"fas","fa-exclamation-circle"],[1,"modal-header"],[1,"modal-title"],[1,"fas","fa-plus"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"col-md-12"],[1,"form-group"],["for","Name"],[2,"color","red"],["type","text",1,"form-control",3,"ngModel","ngModelChange"],["placeholder","Select a process",1,"w-100",3,"value","dataSource","allowFiltering","fields","change"],["processDropdownlist",""],[1,"modal-footer"],["type","button",1,"btn","btn-light",3,"click"],["type","submit",1,"btn","btn-primary",3,"click"],["placeholder","Select a Model Name",1,"w-100","float-left",3,"dataSource","fields","allowFiltering","value","open","filtering","select"],["placeholder","Select a Model NO",1,"w-100","float-left",3,"dataSource","fields","allowFiltering","value","dataBound","filtering","select"],["placeholder","Select article NO   ",1,"w-100","float-left",3,"dataSource","fields","allowFiltering","ngModel","filtering","ngModelChange","select"],["name","process2",3,"label","value","ngModel","ngModelChange"],["height","675px","gridLines","Both","showColumnMenu","true","allowSorting","true","allowResizing","true",3,"dataSource","allowSorting","editSettings","toolbar","actionBegin"],["gridHistory",""],["field","createdTime","isPrimaryKey","true","headerText","Time","textAlign","Center"],["field","action","isPrimaryKey","true","headerText","Status","width","150","textAlign","Center"],["field","before","headerText","Before","width","450","isPrimaryKey","true","textAlign","Left"],["field","after","headerText","After","width","450","isPrimaryKey","true","textAlign","Left"],["field","remark","headerText","Remark","textAlign","Center",3,"edit"],["field","createdBy","headerText","Created By","isPrimaryKey","true","textAlign","Center"],["type","button",1,"btn","btn-primary",3,"click"],[3,"ngClass"],[4,"ngIf","ngIfElse"],["elseTemplate",""],["type","text","name","remark",1,"e-field","e-input","e-defaultcell",2,"text-align","Center",3,"value"],["disabled","disabled","type","text","name","remark",1,"e-field","e-input","e-defaultcell",2,"text-align","Center",3,"value"]],template:function(e,t){1&e&&(R.Sb(0,"div",0),R.Sb(1,"div",1),R.Sb(2,"div",2),R.Sb(3,"div",3),R.Sb(4,"div",0),R.Sb(5,"div",4),R.Sb(6,"label"),R.Kc(7,"Model Name: "),R.Rb(),R.Rb(),R.Sb(8,"div",5),R.Sb(9,"ejs-dropdownlist",6,7),R.cc("open",function(){return t.openPopupDropdownlist()})("ngModelChange",function(e){return t.modelNameID=e})("filtering",function(e){return t.onFilteringModelName(e)})("select",function(e){return t.onChangeModelName(e)}),R.Rb(),R.Rb(),R.Ic(11,ae,3,0,"div",8),R.Rb(),R.Sb(12,"div",0),R.Sb(13,"div",4),R.Sb(14,"label"),R.Kc(15,"Model NO: "),R.Rb(),R.Rb(),R.Sb(16,"div",5),R.Sb(17,"ejs-dropdownlist",9,10),R.cc("open",function(){return t.openPopupDropdownlist()})("ngModelChange",function(e){return t.modelNoID=e})("filtering",function(e){return t.onFilteringModelNO(e)})("select",function(e){return t.onChangeModelNo(e)}),R.Rb(),R.Rb(),R.Nb(19,"div",11),R.Rb(),R.Sb(20,"div",0),R.Sb(21,"div",4),R.Sb(22,"label"),R.Kc(23,"Article NO: "),R.Rb(),R.Rb(),R.Sb(24,"div",5),R.Sb(25,"ejs-dropdownlist",12,7),R.cc("open",function(){return t.openPopupDropdownlist()})("ngModelChange",function(e){return t.articleNoID=e})("filtering",function(e){return t.onFilteringArticleNO(e)})("select",function(e){return t.onChangeArticleNo(e)}),R.Rb(),R.Rb(),R.Nb(27,"div",11),R.Rb(),R.Sb(28,"div",0),R.Sb(29,"div",4),R.Sb(30,"label"),R.Kc(31,"Process: "),R.Rb(),R.Rb(),R.Sb(32,"div",13),R.Ic(33,oe,2,2,"ng-container",14),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Sb(34,"div",2),R.Sb(35,"div",15),R.Ic(36,De,32,5,"div",16),R.Rb(),R.Rb(),R.Rb(),R.Sb(37,"div",17),R.Sb(38,"div",2),R.Sb(39,"div",18),R.Sb(40,"h3",19),R.Kc(41),R.hc(42,"translate"),R.Rb(),R.Ic(43,Be,8,4,"div",20),R.Rb(),R.Ic(44,_e,63,14,"div",21),R.Rb(),R.Rb(),R.Ic(45,Qe,27,5,"ng-template",null,22,R.Jc),R.Ic(47,Ve,49,16,"ng-template",null,23,R.Jc),R.Ic(49,et,24,6,"ng-template",null,24,R.Jc),R.Rb()),2&e&&(R.zb(9),R.mc("dataSource",t.modelNameData)("fields",t.fieldsBPFCs)("allowFiltering",!0)("ngModel",t.modelNameID),R.zb(2),R.mc("ngIf",t.modelNameSelect&&t.modelNoSelect&&t.modelArtSelect&&t.modelProcessSelect),R.zb(6),R.mc("dataSource",t.modelNoData)("fields",t.fieldsBPFCs)("allowFiltering",!0)("ngModel",t.modelNoID),R.zb(8),R.mc("dataSource",t.articleNosData)("fields",t.fieldsBPFCs)("allowFiltering",!0)("ngModel",t.articleNoID),R.zb(8),R.mc("ngForOf",t.artProcessData),R.zb(3),R.mc("ngIf",t.existGlue),R.zb(5),R.Mc("",R.ic(42,18,"PREVIEW")," "),R.zb(2),R.mc("ngIf",t.existGlue),R.zb(1),R.mc("ngIf",t.existGlue))},directives:[r.c,l.g,l.j,s.m,s.l,u.b,u.g,S.j,h.d,v.d,v.b,S.e,S.b,h.c,v.c,v.a,S.d,S.a,u.i,l.b,s.k],pipes:[p.c,s.d],styles:[".e-grid[_ngcontent-%COMP%]   td.e-active[_ngcontent-%COMP%]{background:#6597ce!important;color:#000}.radiobutton-control[_ngcontent-%COMP%]{margin:5% 0 5% 40%}@media only screen and (max-width:500px){.radiobutton-control[_ngcontent-%COMP%]{margin-left:21%;margin-top:20%;margin-bottom:27%}}@media only screen and (max-width:700px){.checkbox-control[_ngcontent-%COMP%]{margin-left:35%;margin-top:8%}.control-section[_ngcontent-%COMP%]{min-height:200px}}.control-section[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{margin:20px 0}.radiobutton-control[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:18px}.e-bigger[_ngcontent-%COMP%]   .radiobutton-control[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:20px}.warning-text[_ngcontent-%COMP%]{-webkit-animation:warning-frames .5s infinite;animation:warning-frames .5s infinite;color:#000}@-webkit-keyframes warning-frames{0%{background-color:#d40a0a}to{background-color:#ff6565}}@keyframes warning-frames{0%{background-color:#d40a0a}to{background-color:#ff6565}}"]}),e})();const it=["switch"],nt=["grid"],st=["gridglue"],lt=["grid2"],at=["modelNameDropdownlist"],ot=["modelNoDropdownlist"],rt=["chemicalDropdownlist"],ct=["positionDropdownlist"];function dt(e,t){1&e&&(R.Kc(0),R.hc(1,"translate")),2&e&&R.Mc(" ",R.ic(1,1,"GLUE")," ")}function ht(e,t){if(1&e&&(R.Sb(0,"div",31),R.Kc(1),R.Rb()),2&e){const e=t.$implicit;R.nc("title",e.name),R.zb(1),R.Mc(" ",e.name," ")}}function ut(e,t){1&e&&(R.Kc(0),R.hc(1,"translate")),2&e&&R.Mc(" ",R.ic(1,1,"CONSUMPTION")," ")}function gt(e,t){if(1&e&&(R.Sb(0,"span"),R.Kc(1),R.Rb()),2&e){const e=t.$implicit,i=R.gc(2);R.Bb(i.changeConsumptionColor(e)),R.zb(1),R.Lc(""===e.consumption?"0":e.consumption)}}function mt(e,t){1&e&&(R.Kc(0),R.hc(1,"translate")),2&e&&R.Mc(" ",R.ic(1,1,"EXPIRED_TIME")," ")}function bt(e,t){1&e&&(R.Kc(0),R.hc(1,"translate")),2&e&&R.Mc(" ",R.ic(1,1,"KIND")," ")}function pt(e,t){if(1&e){const e=R.Tb();R.Sb(0,"ejs-dropdownlist",32,33),R.cc("ngModelChange",function(e){return t.$implicit.kindName=e})("select",function(t){return R.Bc(e),R.gc(2).onChangeKindEdit(t)}),R.Rb()}if(2&e){const e=t.$implicit,i=R.gc(2);R.mc("dataSource",i.kinds)("ngModel",e.kindName)("fields",i.fieldsKindEdit)("allowFiltering",!0)}}function ft(e,t){1&e&&(R.Kc(0),R.hc(1,"translate")),2&e&&R.Mc(" ",R.ic(1,1,"PART")," ")}function It(e,t){if(1&e){const e=R.Tb();R.Sb(0,"ejs-dropdownlist",34,33),R.cc("ngModelChange",function(e){return t.$implicit.partName=e})("select",function(t){return R.Bc(e),R.gc(2).onChangePartEdit(t)}),R.Rb()}if(2&e){const e=t.$implicit,i=R.gc(2);R.mc("dataSource",i.parts)("ngModel",e.partName)("fields",i.fieldsPartEdit)("allowFiltering",!0)}}function Dt(e,t){1&e&&(R.Kc(0),R.hc(1,"translate")),2&e&&R.Mc(" ",R.ic(1,1,"MATERIAL")," ")}function St(e,t){if(1&e){const e=R.Tb();R.Sb(0,"ejs-dropdownlist",34,33),R.cc("ngModelChange",function(e){return t.$implicit.materialName=e})("select",function(t){return R.Bc(e),R.gc(2).onChangeMaterialEdit(t)}),R.Rb()}if(2&e){const e=t.$implicit,i=R.gc(2);R.mc("dataSource",i.materials)("ngModel",e.materialName)("fields",i.fieldsMaterialEdit)("allowFiltering",!0)}}function Nt(e,t){if(1&e){const e=R.Tb();R.Sb(0,"div",19),R.Sb(1,"ejs-grid",20,21),R.cc("rowDeselected",function(t){return R.Bc(e),R.gc().rowDeselected(t)})("actionBegin",function(t){return R.Bc(e),R.gc().actionBeginGlue(t)})("rowSelected",function(t){return R.Bc(e),R.gc().rowSelected(t)})("created",function(){return R.Bc(e),R.gc().onCreatedGridGlue()})("toolbarClick",function(t){return R.Bc(e),R.gc().toolbarClick(t)})("dataBound",function(){return R.Bc(e),R.gc().dataBoundGlue()}),R.Sb(3,"e-columns"),R.Sb(4,"e-column",22),R.Ic(5,dt,2,3,"ng-template",null,23,R.Jc),R.Ic(7,ht,2,2,"ng-template",null,24,R.Jc),R.Rb(),R.Sb(9,"e-column",25),R.Ic(10,ut,2,3,"ng-template",null,23,R.Jc),R.Ic(12,gt,2,3,"ng-template",null,24,R.Jc),R.Rb(),R.Sb(14,"e-column",26),R.Ic(15,mt,2,3,"ng-template",null,23,R.Jc),R.Rb(),R.Sb(17,"e-column",27),R.Ic(18,bt,2,3,"ng-template",null,23,R.Jc),R.Ic(20,pt,2,4,"ng-template",null,28,R.Jc),R.Rb(),R.Sb(22,"e-column",29),R.Ic(23,ft,2,3,"ng-template",null,23,R.Jc),R.Ic(25,It,2,4,"ng-template",null,28,R.Jc),R.Rb(),R.Sb(27,"e-column",30),R.Ic(28,Dt,2,3,"ng-template",null,23,R.Jc),R.Ic(30,St,2,4,"ng-template",null,28,R.Jc),R.Rb(),R.Rb(),R.Rb(),R.Rb()}if(2&e){const e=R.gc();R.zb(1),R.mc("dataSource",e.glues)("editSettings",e.editSettings)("toolbar",e.toolbar)("allowSorting",!0)("selectedRowIndex",e.rowIndex)}}function Ct(e,t){if(1&e){const e=R.Tb();R.Sb(0,"ejs-switch",42,43),R.cc("click",function(){return R.Bc(e),R.gc(2).done()})("ngModelChange",function(t){return R.Bc(e),R.gc(2).createdStatus=t}),R.hc(2,"translate"),R.hc(3,"translate"),R.Rb()}if(2&e){const e=R.gc(2);R.nc("onLabel",R.ic(2,5,"DONE")),R.nc("offLabel",R.ic(3,7,"UNDONE")),R.mc("disabled",e.approvalStatus)("ngModel",e.createdStatus)("checked",e.createdStatus)}}function vt(e,t){if(1&e){const e=R.Tb();R.Sb(0,"ejs-switch",45),R.cc("click",function(){return R.Bc(e),R.gc(3).approval()})("ngModelChange",function(t){return R.Bc(e),R.gc(3).approvalStatus=t}),R.hc(1,"translate"),R.Rb()}if(2&e){const e=R.gc(3);R.nc("offLabel",R.ic(1,3,"NOT_APPROVED")),R.mc("ngModel",e.approvalStatus)("checked",e.approvalStatus)}}function yt(e,t){if(1&e&&(R.Qb(0),R.Ic(1,vt,2,5,"ejs-switch",44),R.Pb()),2&e){const e=R.gc(2);R.zb(1),R.mc("ngIf",e.modelNameID>0)}}function Bt(e,t){if(1&e){const e=R.Tb();R.Sb(0,"button",46),R.cc("click",function(){return R.Bc(e),R.gc(2).finished()}),R.Nb(1,"i",47),R.Kc(2),R.hc(3,"translate"),R.Rb()}2&e&&(R.zb(2),R.Mc(" ",R.ic(3,1,"FINISHED")," "))}function wt(e,t){if(1&e){const e=R.Tb();R.Sb(0,"button",48),R.cc("click",function(){R.Bc(e);const t=R.gc(2),i=R.yc(45);return t.openModalHistory(i)}),R.Nb(1,"i",49),R.Kc(2," History"),R.Rb()}}function Pt(e,t){if(1&e&&(R.Sb(0,"div",35),R.Sb(1,"button",36),R.Nb(2,"i",37),R.Kc(3," Reset "),R.Rb(),R.Ic(4,Ct,4,9,"ejs-switch",38),R.Ic(5,yt,2,1,"ng-container",39),R.Ic(6,Bt,4,3,"button",40),R.Ic(7,wt,3,0,"button",41),R.Rb()),2&e){const e=R.gc();R.zb(4),R.mc("ngIf",e.modelNameID>0),R.zb(1),R.mc("ngIf",3!==e.level&&4!==e.level),R.zb(1),R.mc("ngIf",e.modelNameID>0),R.zb(1),R.mc("ngIf",e.modelNameID>0)}}function xt(e,t){if(1&e&&(R.Sb(0,"li",66),R.Sb(1,"a"),R.Kc(2),R.Sb(3,"span",67),R.Kc(4),R.Rb(),R.Rb(),R.Rb()),2&e){const e=t.$implicit;R.zb(2),R.Nc(" ",e.position,". ",e.ingredientName," "),R.zb(2),R.Mc("(",e.percentage,"%)")}}function At(e,t){if(1&e&&(R.Sb(0,"ul"),R.Sb(1,"span",63),R.Kc(2),R.Rb(),R.Sb(3,"li",64),R.Kc(4),R.Sb(5,"ul"),R.Ic(6,xt,5,3,"li",65),R.Rb(),R.Rb(),R.Rb()),2&e){const e=R.gc(2);R.zb(2),R.Lc(e.formulaTamp()),R.zb(2),R.Mc(" ",e.formula()," "),R.zb(2),R.mc("ngForOf",e.renderchemical())}}function Rt(e,t){if(1&e){const e=R.Tb();R.Sb(0,"button",68),R.cc("click",function(){R.Bc(e);const i=t.$implicit;return R.gc(2).sortBySup(i.id)}),R.Nb(1,"i",69),R.Kc(2),R.Rb()}if(2&e){const e=t.$implicit;R.zb(2),R.Mc(" ",e.name," ")}}function Mt(e,t){1&e&&(R.Kc(0),R.hc(1,"translate")),2&e&&R.Mc(" ",R.ic(1,1,"ITEM")," ")}function Ft(e,t){if(1&e){const e=R.Tb();R.Sb(0,"ejs-dropdownlist",70,71),R.cc("change",function(i){R.Bc(e);const n=t.$implicit;return R.gc(2).onChangePosition(i,n,n.index)}),R.Rb()}if(2&e){const e=t.$implicit,i=R.gc(2);R.mc("dataSource",i.dataPosition)("value",e.position)("fields",i.fieldsPosition)("allowFiltering",!0)}}function kt(e,t){if(1&e){const e=R.Tb();R.Sb(0,"ejs-dropdownlist",70,71),R.cc("change",function(i){R.Bc(e);const n=t.$implicit;return R.gc(2).onChangePosition(i,n,n.index)}),R.Rb()}if(2&e){const e=t.$implicit,i=R.gc(2);R.mc("dataSource",i.dataPosition)("value",e.position)("fields",i.fieldsPosition)("allowFiltering",!0)}}function Tt(e,t){1&e&&(R.Kc(0),R.hc(1,"translate")),2&e&&R.Mc(" ",R.ic(1,1,"INGREDIENT_NAME")," ")}function Et(e,t){1&e&&R.Kc(0),2&e&&R.Mc(" ",t.$implicit.name," ")}function Gt(e,t){1&e&&R.Kc(0),2&e&&R.Mc(" ",t.$implicit.name," ")}function $t(e,t){if(1&e&&(R.Sb(0,"div"),R.Kc(1),R.Rb()),2&e){const e=t.$implicit,i=R.gc(2);R.Bb(i.changePercentageColor(e)),R.zb(1),R.Lc(e.percentage)}}function Ot(e,t){1&e&&(R.Sb(0,"div"),R.Nb(1,"i",72),R.Rb())}function Kt(e,t){if(1&e&&(R.Sb(0,"div"),R.Kc(1),R.Rb()),2&e){const e=t.$implicit,i=R.gc(2);R.Bb(i.changeAllowColor(e)),R.zb(1),R.Mc("\xb1 ",e.allow,"")}}function Lt(e,t){1&e&&(R.Kc(0),R.hc(1,"translate")),2&e&&R.Mc(" ",R.ic(1,1,"ITEM")," ")}function Ut(e,t){if(1&e){const e=R.Tb();R.Sb(0,"ejs-dropdownlist",70,71),R.cc("change",function(i){R.Bc(e);const n=t.$implicit;return R.gc(2).onChangePosition(i,n,n.index)}),R.Rb()}if(2&e){const e=t.$implicit,i=R.gc(2);R.mc("dataSource",i.dataPosition)("value",e.position)("fields",i.fieldsPosition)("allowFiltering",!0)}}function Jt(e,t){if(1&e){const e=R.Tb();R.Sb(0,"ejs-dropdownlist",70,71),R.cc("change",function(i){R.Bc(e);const n=t.$implicit;return R.gc(2).onChangePosition(i,n,n.index)}),R.Rb()}if(2&e){const e=t.$implicit,i=R.gc(2);R.mc("dataSource",i.dataPosition)("value",e.position)("fields",i.fieldsPosition)("allowFiltering",!0)}}function zt(e,t){1&e&&(R.Kc(0),R.hc(1,"translate")),2&e&&R.Mc(" ",R.ic(1,1,"INGREDIENT_NAME")," ")}function jt(e,t){1&e&&R.Kc(0),2&e&&R.Mc(" ",t.$implicit.name," ")}function Ht(e,t){1&e&&R.Kc(0),2&e&&R.Mc(" ",t.$implicit.name," ")}function _t(e,t){1&e&&(R.Sb(0,"div"),R.Nb(1,"i",72),R.Rb())}function Qt(e,t){if(1&e&&(R.Sb(0,"div"),R.Kc(1),R.Rb()),2&e){const e=t.$implicit,i=R.gc(2);R.Bb(i.changeAllowColor(e)),R.zb(1),R.Mc("\xb1 ",e.allow,"")}}function qt(e,t){if(1&e){const e=R.Tb();R.Sb(0,"div",50),R.Ic(1,At,7,3,"ul",39),R.Sb(2,"div",0),R.Sb(3,"div",51),R.Sb(4,"button",52),R.cc("click",function(){return R.Bc(e),R.gc().sortBySup(0)}),R.Kc(5),R.hc(6,"translate"),R.Rb(),R.Ic(7,Rt,3,1,"button",53),R.Rb(),R.Rb(),R.Sb(8,"div",0),R.Sb(9,"div",54),R.Sb(10,"div",9),R.Sb(11,"div",19),R.Sb(12,"ejs-grid",55,56),R.cc("actionComplete",function(t){return R.Bc(e),R.gc().actionCompleteIngredient(t)})("recordDoubleClick",function(t){return R.Bc(e),R.gc().onDoubleClickIngredient(t)})("actionBegin",function(t){return R.Bc(e),R.gc().actionBeginIngredient(t)})("toolbarClick",function(t){return R.Bc(e),R.gc().toolbarClickIngredient(t)})("rowSelected",function(t){return R.Bc(e),R.gc().rowSelectedIngredient(t)}),R.Sb(14,"e-columns"),R.Sb(15,"e-column",57),R.Ic(16,Mt,2,3,"ng-template",null,23,R.Jc),R.Ic(18,Ft,2,4,"ng-template",null,24,R.Jc),R.Ic(20,kt,2,4,"ng-template",null,28,R.Jc),R.Rb(),R.Sb(22,"e-column",58),R.Ic(23,Tt,2,3,"ng-template",null,23,R.Jc),R.Ic(25,Et,1,1,"ng-template",null,28,R.Jc),R.Ic(27,Gt,1,1,"ng-template",null,24,R.Jc),R.Rb(),R.Sb(29,"e-column",59),R.Ic(30,$t,2,3,"ng-template",null,24,R.Jc),R.Rb(),R.Sb(32,"e-column",60),R.Ic(33,Ot,2,0,"ng-template",null,23,R.Jc),R.Ic(35,Kt,2,3,"ng-template",null,24,R.Jc),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Sb(37,"div",54),R.Sb(38,"div",9),R.Sb(39,"div",19),R.Sb(40,"ejs-grid",61,62),R.cc("actionComplete",function(t){return R.Bc(e),R.gc().actionCompleteIngredient(t)})("recordDoubleClick",function(t){return R.Bc(e),R.gc().onDoubleClickIngredient(t)})("actionBegin",function(t){return R.Bc(e),R.gc().actionBeginIngredient(t)})("toolbarClick",function(t){return R.Bc(e),R.gc().toolbarClickIngredient(t)})("rowSelected",function(t){return R.Bc(e),R.gc().rowSelectedIngredient(t)}),R.Sb(42,"e-columns"),R.Sb(43,"e-column",57),R.Ic(44,Lt,2,3,"ng-template",null,23,R.Jc),R.Ic(46,Ut,2,4,"ng-template",null,24,R.Jc),R.Ic(48,Jt,2,4,"ng-template",null,28,R.Jc),R.Rb(),R.Sb(50,"e-column",58),R.Ic(51,zt,2,3,"ng-template",null,23,R.Jc),R.Ic(53,jt,1,1,"ng-template",null,28,R.Jc),R.Ic(55,Ht,1,1,"ng-template",null,24,R.Jc),R.Rb(),R.Nb(57,"e-column",59),R.Sb(58,"e-column",60),R.Ic(59,_t,2,0,"ng-template",null,23,R.Jc),R.Ic(61,Qt,2,3,"ng-template",null,24,R.Jc),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Rb()}if(2&e){const e=R.gc();R.zb(1),R.mc("ngIf",e.renderchemical().length>0),R.zb(4),R.Mc(" ",R.ic(6,12,"DEFAULT")," "),R.zb(2),R.mc("ngForOf",e.supplier),R.zb(5),R.mc("dataSource",e.ingredients1)("allowSorting",!0)("allowSorting",!0)("editSettings",e.editSettings)("toolbar",e.toolbarOptions2),R.zb(28),R.mc("dataSource",e.ingredients2)("allowSorting",!0)("editSettings",e.editSettings)("toolbar",e.toolbarOptions2)}}function Vt(e,t){if(1&e){const e=R.Tb();R.Sb(0,"div",73),R.Sb(1,"h4",74),R.Nb(2,"i",75),R.Kc(3," Clone Article "),R.Rb(),R.Sb(4,"button",76),R.cc("click",function(){return t.$implicit.dismiss("Cross click")}),R.Sb(5,"span",77),R.Kc(6,"\xd7"),R.Rb(),R.Rb(),R.Rb(),R.Sb(7,"div",78),R.Sb(8,"div",0),R.Sb(9,"div",79),R.Sb(10,"div",80),R.Sb(11,"label",81),R.Kc(12,"Article Name"),R.Rb(),R.Sb(13,"span",82),R.Kc(14,"(*)"),R.Rb(),R.Sb(15,"input",83),R.cc("ngModelChange",function(t){return R.Bc(e),R.gc().articleName=t}),R.Rb(),R.Rb(),R.Rb(),R.Sb(16,"div",79),R.Sb(17,"div",80),R.Sb(18,"label",81),R.Kc(19,"Process"),R.Rb(),R.Sb(20,"ejs-dropdownlist",84,85),R.cc("change",function(t){return R.Bc(e),R.gc().onChangeProcessCloneModal(t)}),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Sb(22,"div",86),R.Sb(23,"button",87),R.cc("click",function(){return t.$implicit.close("Close click")}),R.Kc(24,"Close"),R.Rb(),R.Sb(25,"button",88),R.cc("click",function(){return R.Bc(e),R.gc().cloneArticleModelname()}),R.Kc(26,"Clone"),R.Rb(),R.Rb()}if(2&e){const e=R.gc();R.zb(15),R.mc("ngModel",e.articleName),R.zb(5),R.mc("value",e.valueProcess)("dataSource",e.processData)("allowFiltering",!0)("fields",e.processfields)}}function Xt(e,t){1&e&&(R.Kc(0),R.hc(1,"date")),2&e&&R.Mc(" ",R.jc(1,1,t.$implicit.createdTime,"yyyy-MM-dd , hh:mm:ss a")," ")}function Yt(e,t){if(1&e&&(R.Qb(0),R.Nb(1,"input",101),R.Pb()),2&e){const e=R.gc().$implicit;R.zb(1),R.mc("value",e.remark)}}function Wt(e,t){if(1&e&&R.Nb(0,"input",102),2&e){const e=R.gc().$implicit;R.mc("value",e.remark)}}function Zt(e,t){if(1&e&&(R.Sb(0,"span",98),R.Ic(1,Yt,2,1,"ng-container",99),R.Ic(2,Wt,1,1,"ng-template",null,100,R.Jc),R.Rb()),2&e){const e=t.$implicit,i=R.yc(3);R.mc("ngClass","Improve"==e.action?"e-input-group e-control-wrapper e-valid-input":"e-input-group e-control-wrapper e-valid-input e-disabled"),R.zb(1),R.mc("ngIf","Improve"==e.action)("ngIfElse",i)}}function ei(e,t){if(1&e){const e=R.Tb();R.Sb(0,"div",73),R.Sb(1,"h4",74),R.Nb(2,"i",75),R.Kc(3," BPFC History "),R.Rb(),R.Sb(4,"button",76),R.cc("click",function(){return t.$implicit.dismiss("Cross click")}),R.Sb(5,"span",77),R.Kc(6,"\xd7"),R.Rb(),R.Rb(),R.Rb(),R.Sb(7,"div",78),R.Sb(8,"ejs-grid",89,90),R.cc("actionBegin",function(t){return R.Bc(e),R.gc().actionBeginHistory(t)}),R.Sb(10,"e-columns"),R.Sb(11,"e-column",91),R.Ic(12,Xt,2,4,"ng-template",null,24,R.Jc),R.Rb(),R.Nb(14,"e-column",92),R.Nb(15,"e-column",93),R.Nb(16,"e-column",94),R.Sb(17,"e-column",95),R.Ic(18,Zt,4,3,"ng-template",null,28,R.Jc),R.Rb(),R.Nb(20,"e-column",96),R.Rb(),R.Rb(),R.Rb(),R.Sb(21,"div",86),R.Sb(22,"button",97),R.cc("click",function(){return t.$implicit.close("Close click")}),R.Kc(23,"Close"),R.Rb(),R.Rb()}if(2&e){const e=R.gc();R.zb(8),R.mc("dataSource",e.historyData)("allowSorting",!0)("allowSorting",!0)("editSettings",e.editSettingsHis)("toolbar",e.toolbarOptionsHistory),R.zb(9),R.mc("edit",e.editparamsHis)}}function ti(e,t){if(1&e){const e=R.Tb();R.Sb(0,"div",73),R.Sb(1,"h4",74),R.Nb(2,"i",75),R.Kc(3," Clone BPFC "),R.Rb(),R.Sb(4,"button",76),R.cc("click",function(){return t.$implicit.dismiss("Cross click")}),R.Sb(5,"span",77),R.Kc(6,"\xd7"),R.Rb(),R.Rb(),R.Rb(),R.Sb(7,"div",78),R.Sb(8,"div",0),R.Sb(9,"div",79),R.Sb(10,"div",80),R.Sb(11,"label",81),R.Kc(12,"Model Name"),R.Rb(),R.Sb(13,"span",82),R.Kc(14,"(*)"),R.Rb(),R.Nb(15,"input",6),R.Rb(),R.Rb(),R.Sb(16,"div",79),R.Sb(17,"div",80),R.Sb(18,"label",81),R.Kc(19,"Model NO"),R.Rb(),R.Sb(20,"span",82),R.Kc(21,"(*)"),R.Rb(),R.Nb(22,"input",6),R.Rb(),R.Rb(),R.Sb(23,"div",79),R.Sb(24,"div",80),R.Sb(25,"label",81),R.Kc(26,"Article NO"),R.Rb(),R.Sb(27,"span",82),R.Kc(28,"(*)"),R.Rb(),R.Sb(29,"input",103),R.cc("ngModelChange",function(t){return R.Bc(e),R.gc().articleNoNewLeo=t}),R.Rb(),R.Rb(),R.Rb(),R.Sb(30,"div",79),R.Sb(31,"div",80),R.Sb(32,"label",81),R.Kc(33,"Process"),R.Rb(),R.Sb(34,"span",82),R.Kc(35,"(*)"),R.Rb(),R.Nb(36,"input",6),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Sb(37,"div",86),R.Sb(38,"button",87),R.cc("click",function(){return t.$implicit.close("Close click")}),R.Kc(39,"Close"),R.Rb(),R.Sb(40,"button",88),R.cc("click",function(){return R.Bc(e),R.gc().onClickClone()}),R.Kc(41,"Clone"),R.Rb(),R.Rb()}if(2&e){const e=R.gc();R.zb(15),R.mc("value",e.modelNameLeo),R.zb(7),R.mc("value",e.modelNoLeo),R.zb(7),R.mc("ngModel",e.articleNoNewLeo)("value",e.articleNoLeo),R.zb(7),R.mc("value",e.artProcessLeo)}}let ii=(()=>{class e{constructor(e,t,i,n,s,l,a,o,r,c,d,h,u,g,m,b,p){this.glueIngredientService=e,this.modalNameService=t,this.glueService=i,this.alertify=n,this.modalService=s,this.route=l,this.authService=a,this.bPFCEstablishService=o,this.modelNoService=r,this.articleNoService=c,this.kindService=d,this.partService=h,this.materialService=u,this.buildingUserService=g,this.artProcessService=m,this.ingredientService=b,this.dataService=p,this.positions=["B","C","D","E"],this.approvalStatus=!1,this.createdStatus=!1,this.role=JSON.parse(localStorage.getItem("user")).user.role,this.isShow=!1,this.selectedRow=[],this.LANG=localStorage.getItem("lang")||"vi",this.glue={id:0,name:"",gluename:"",code:"",createdDate:"",partID:0,kindID:0,materialID:0,BPFCEstablishID:0,consumption:"",expiredTime:0,createdBy:0,glueNameID:0,glueIngredients:[]},this.ingredient={id:0,name:"",code:"",percentage:0,createdDate:new Date,supplierID:0,position:0,allow:0,voc:0,expiredTime:0,daysToExpiration:0,materialNO:"",unit:0,real:0,cbd:0},this.editPercentage={glueID:0,ingredientID:0,percentage:0},this.editAllow={glueID:0,ingredientID:0,allow:0},this.page=1,this.supplier=[],this.toolbarOptions=["Search","Delete"],this.toolbarOptions2=["Search","Add","Delete","Cancel"],this.toolbarOptionsHistory=["Search"],this.selectionOptions={type:"Multiple",mode:"Both"},this.editSettingsHis={allowEditing:!0,mode:"Normal",allowEditOnDblClick:!0},this.detailIngredient=[],this.totalPercentage=0,this.fieldsBPFCs={text:"name",value:"id"},this.fieldsBPFCss={text:"name",value:"id"},this.fieldsGlueChemical={text:"name",value:"name"},this.textGlue="Select Model Name",this.textModelName="Select Model Name - Model #",this.textGlueMaterial="Select ",this.fieldsGlue2={text:"name",value:"id"},this.articleNofields={text:"name",value:"id"},this.processfields={text:"name",value:"id"},this.processData=[{id:1,name:"ASY"},{id:2,name:"STF"}],this.valueProcess=1,this.textGlue2="Select Model No",this.existGlue=!1,this.editparamsHis={params:{format:"n"}},this.dataPosition=[{id:"0",name:""},{id:"1",name:"A"},{id:"2",name:"B"},{id:"3",name:"C"},{id:"4",name:"D"},{id:"5",name:"E"}],this.fieldsKindEdit={text:"name",value:"name"},this.fieldsPartEdit={text:"name",value:"name"},this.fieldsMaterialEdit={text:"name",value:"name"},this.fieldsGlueEdit={text:"name",value:"name"},this.fieldsChemical={text:"name",value:"name"},this.fieldsPosition={text:"name",value:"name"},this.rowIndex="",this.glueIngredient2={ingredientID:0,percentage:0,glueID:0,position:""},this.history={Action:"Created",BPFCEstablishID:0,GlueID:0,Before:"",BeforeAllow:"",After:"",AfterAllow:"",UserID:0,Remark:""},this.valuess="Badminton",this.modelNameSelect=!1,this.modelNoSelect=!1,this.modelArtSelect=!1,this.modelProcessSelect=!1,this.userData=[],this.modelNameLeo=null,this.modelNoLeo=null,this.articleNoLeo=null,this.articleNoNewLeo=null,this.artProcessLeo=null,this.modelNameIDLeo=0,this.modelNoIDLeo=0,this.articleNoIDLeo=0,this.artProcessIDLeo=0,this.BPFCIDLeo=0,this.textSearch=null,this.onFiltering=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.modelNameData,t)},this.onFilteringModelName=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.modelNameData,t)},this.onFilteringModelNO=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.modelNoData,t)},this.onFilteringArticleNO=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.articleNoData,t)},this.onFilteringModelNameClone=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.modelNameData,t)},this.onFilteringModelNOClone=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.modelNoData,t)},this.onFilteringArticleNOClone=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.articleNoData,t)},this.onFilteringArtProcessClone=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.artProcessDataClone,t)},this.dataSearch=this.dataService.currentMessage.subscribe(e=>{this.textSearch=e})}ngOnInit(){this.getModelNames(),this.getAllUsers(),this.modelNameID=0,this.subID=0,this.selIndex=[],this.isAdd=!1,this.existGlue=!1,this.oldDetail=[],this.glueIngredientDetail=[],this.removeLocalStore("details"),this.glueid=0,this.onService(),this.getAllSupllier(),this.GetDetailBPFC(),this.sortOptions={columns:[{field:"item",direction:"Decending"}]},this.editParams={params:{value:""}},0===this.glue.id?(this.showBarCode=!1,this.genaratorGlueCode()):this.showBarCode=!0,this.ingredientService.currentIngredient.subscribe(e=>{200===e&&this.getIngredients()}),this.pageSettings={pageSize:12},this.paginationI={currentPage:1,itemsPerPage:10,totalItems:0,totalPages:0},this.editSettings={showDeleteConfirmDialog:!1,allowEditing:!0,allowAdding:!0,allowDeleting:!0,mode:"Normal"},this.toolbar=[{text:"Add New",tooltipText:"Add new row",prefixIcon:"e-add",id:"AddNew"},"Edit","Delete","Update","Cancel","Search"],this.orderidrules={required:!0,number:!0},this.customeridrules={required:!0},this.freightrules={required:!0},this.editparams={paramss:{popupHeight:"300px"}}}ngOnDestroy(){this.dataService.changeMessages(this.textSearch),this.dataSearch.unsubscribe()}GetDetailBPFC(){this.BPFCID=this.route.snapshot.params.id,this.bPFCEstablishService.getDetailBPFC(this.BPFCID).subscribe(e=>{var t;const i=e[0];this.BPFCIDLeo=i.id,this.modelNameLeo=i.modelName,this.modelNoLeo=i.modelNo,this.articleNoLeo=i.articleNo,this.artProcessLeo=i.artProcess,this.articleNoNewLeo=i.articleNo,this.modelNameID=i.modelNameID,this.modelNoID=i.modelNoID,this.articleNoID=i.articleNoID,this.artProcessIDLeo="ASY"===i.artProcess?1:2,this.modelNameDetail=e[0].modelName,this.modelNameID=e[0].modelNameID,this.modelNoDetail=e[0].modelNo,this.articleNoDetail=e[0].articleNo,this.artProcessDetail=e[0].artProcess,this.modelNameIDClone=e[0].modelNameID,this.value=e[0].modelNameID,this.valuemodelNo=e[0].modelNoID,this.articleNoID=e[0].articleNoID,this.resetLifeCycleBPFC(),this.BPFCID=null===(t=e[0])||void 0===t?void 0:t.id,this.approvalStatus=e[0].approvalStatus,this.createdStatus=e[0].finishedStatus,localStorage.removeItem("details"),this.glue.BPFCEstablishID=this.BPFCID,this.getAllGluesByBPFCID(this.BPFCID),this.getAllPart(),this.getAllKind(),this.getAllMaterial(),this.getAllIngredient(),this.existGlue=!0,this.modified=!0})}onChangeProcessCloneModal(e){e.itemData&&(this.processID=e.itemData.id)}resetLifeCycleBPFC(){this.selIndex=[],this.oldDetail=[],this.glueIngredientDetail=[],this.removeLocalStore("details"),this.removeLocalStore("detailsTamp"),this.ingredients1=[],this.ingredients2=[],this.glues=[],this.BPFCID=0}onCreatedGridGlue(){}ngAfterViewInit(){$('[data-toggle="tooltip"]').tooltip();const e=JSON.parse(localStorage.getItem("level"));this.level=e.id,this.getBuilding()}onChangeKindEdit(e){this.kindEdit=e.value,this.kindID=e.itemData.id}onChangePartEdit(e){this.partEdit=e.value,this.partID=e.itemData.id}onChangeMaterialEdit(e){this.kindEdit=e.value,this.materialID=e.itemData.id}dataBoundGlue(){this.gridglue.selectRows(this.selectedRow.length?this.selectedRow:this.selIndex)}actionBeginGlue(e){"beginEdit"===e.requestType&&(this.chemicalNameEdit=e.rowData.name,this.pathNameEdit=e.rowData.pathName,this.modelNoEdit=e.rowData.modelNo,this.materialNameEdit=e.rowData.materialName,this.glue.consumption=e.rowData.consumption,this.glue.kindID=e.rowData.kindID||null,this.glue.partID=e.rowData.partID||null,this.glue.materialID=e.rowData.materialID||null,this.glue.BPFCEstablishID=e.rowData.bpfcEstablishID,this.glue.name=e.rowData.name,this.glue.expiredTime=this.expiredTime,this.history.Before=""===e.rowData.consumption?"0":"Consumption "+e.rowData.consumption,this.detailGlue=!0),"save"===e.requestType&&(this.glue.id=e.rowData.id||0,this.glue.code=e.data.code||"",this.glue.consumption=e.data.consumption,this.glue.glueNameID=e.data.glueNameID,this.glue.kindID=this.kindID||null,this.glue.partID=this.partID||null,this.glue.materialID=this.materialID||null,this.glue.BPFCEstablishID=this.BPFCID,this.glue.name=this.chemicalNameEdit,this.glue.expiredTime=this.expiredTime,this.history.Action="Consumption",this.history.BPFCEstablishID=this.BPFCID,this.history.GlueID=this.glueid,this.history.After="Consumption "+e.data.consumption,this.history.UserID=JSON.parse(localStorage.getItem("user")).user.id,this.glue.createdBy=JSON.parse(localStorage.getItem("user")).user.id,this.bPFCEstablishService.AddHistoryBPFC(this.history).subscribe(()=>{}),this.saveGlue()),"delete"===e.requestType&&0!==e.data[0].id&&(this.glueid=e.data[0].id,this.history.Action="Delete",this.history.Before=e.data[0].name,this.history.BPFCEstablishID=this.BPFCID,this.history.GlueID=e.data[0].id,this.history.UserID=JSON.parse(localStorage.getItem("user")).user.id,this.bPFCEstablishService.AddHistoryBPFC(this.history).subscribe(()=>{this.glueService.delete(e.data[0].id).subscribe(()=>{this.getAllGluesByBPFCID(this.BPFCID),this.detailGlue=!1,this.removeLocalStore("details"),this.glueIngredientDetail=[],this.oldDetail=[],this.alertify.success("Glue has been deleted")},e=>{this.alertify.error("Failed to delete the Glue")})}))}rowDeselected(e){const t=e.rowIndex,i=this.getLocalStore("details").sort(this.dynamicSort("position"));!1===this.compareArray(this.oldDetail,i)&&!0===e.isInteracted&&this.alertify.valid("C\u1ea3nh b\xe1o!","B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n b\u1ecf qua s\u1ef1 thay \u0111\u1ed5i n\xe0y kh\xf4ng?").then(e=>{if(this.modified=!0,this.gridglue.getSelectedRowIndexes().length){const e=this.gridglue.dataSource[t];e.name=e.chemical.name,this.gridglue.refresh()}}).catch(e=>{this.gridglue.selectRows([t])})}rowSelected(e){e.data[0]&&(this.GlueNameDefault=e.data[0].name);const t=e.data[0]||e.data;this.selIndex=[e.rowIndex],!e.isInteracted&&e.previousRowIndex&&(this.selIndex=[e.previousRowIndex]),e.isInteracted&&void 0!==e.data.name&&this.modified&&this.loadPreview(Number(e.data.id)),!1!==e.isInteracted&&null===e.target||void 0!==t.name&&this.modified&&this.loadPreview(Number(t.id))}onChangePosition(e,t,i){this.modified=!1,this.history.BeforeAllow=this.glueNewName;const n=e.value;let s=this.getLocalStore("details");if(""===e.value);else{if(0!==s.length){let t="";switch(s[s.length-1].position){case"A":t="B";break;case"B":t="C";break;case"C":t="D";break;case"D":t="E"}if(n!==t)return this.alertify.warning("H\xe3y ch\u1ecdn ch\u1ea5t ti\u1ebfp theo l\xe0 "+t,!0),this.grid.refresh(),this.grid2.refresh(),void(e.cancel=!0)}if(0===s.filter(t=>t.position===e.value).length&&null!==e.value)if(s=this.getLocalStore("details"),this.percentage=0,this.position=e.value,0!==s.filter(e=>e.ingredientName===t.name&&e.position===t.position).length){const i=s.findIndex(e=>e.ingredientName===t.name);s[i].position=e.value,this.setLocalStore("details",s),this.glueIngredientDetail=this.getLocalStore("details"),this.makeFormula(),this.updateChemicalList(),this.grid.refresh()}else{s=this.getLocalStore("details");const i={id:0,glueID:this.glueid,ingredientID:t.id,glueName:"",ingredientName:t.name,percentage:this.percentage,position:e.value,createdDate:new Date,allow:0,expiredTime:t.expiredTime};"A"===e.value&&(i.percentage=100,i.expiredTime=t.expiredTime),s.push(i),this.setLocalStore("details",s),this.glueIngredientDetail=this.getLocalStore("details"),this.makeFormula(),this.updateChemicalList(),"A"===e.value&&this.grid.refresh()}}}recordDoubleClick(e){this.modifiedGlue=!0}toolbarClickIngredient(e){switch(e.item.text){case"Add":e.cancel=!0,this.openIngredientModalComponent()}}onDoubleClickIngredient(e){this.setFocus=e.column}rowSelectedIngredient(e){this.ingridientID=e.data.id}genaratorGlueCode(){this.glue.code=this.makeid(8)}makeid(e){let t="";const i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",n=i.length;for(let s=0;s<e;s++)t+=i.charAt(Math.floor(Math.random()*n));return t}compareArray(e,t){return JSON.stringify(e)===JSON.stringify(t)}setLocalStore(e,t){localStorage.removeItem(e);const i=JSON.stringify(t);localStorage.setItem(e,i)}getLocalStore(e){return(JSON.parse(localStorage.getItem(e))||[]).sort(this.dynamicSort("position"))}removeLocalStore(e){localStorage.removeItem(e)}dynamicSort(e){let t=1;return"-"===e[0]&&(t=-1,e=e.substr(1)),(i,n)=>-1===t?n[e].localeCompare(i[e]):i[e].localeCompare(n[e])}checkColorCode(e){return!0===e.approvalStatus&&!0===e.finishedStatus}checkDone(e){return!0===e.approvalStatus&&!0===e.finishedStatus?"Done":"Undone"}checkStatus(e,t){return!0===e&&!0===t?"Done":"Undone"}renderchemical(){return this.glueIngredientDetail=this.glueIngredientDetail||[],this.glueIngredientDetail.sort(this.dynamicSort("position"))}makeFormula(){var e,t;const i=this.getLocalStore("details").filter(e=>"A"===e.position)||[];this.nameGlue=(null===(e=i[0])||void 0===e?void 0:e.ingredientName)||"",this.nameGlues=(null===(t=i[0])||void 0===t?void 0:t.ingredientName)+"^"+this.glueIngredientDetail[0].allow+"%"||!1,this.A=i[0].ingredientName,this.glueIngredientDetail=this.renderchemical(),void 0===this.glueIngredientDetail[1]?this.B="":(this.B=this.glueIngredientDetail[1].percentage+"%"+this.glueIngredientDetail[1].ingredientName,this.BB=this.glueIngredientDetail[1].percentage+"%"+this.glueIngredientDetail[1].ingredientName+"^"+this.glueIngredientDetail[1].allow+"%"),void 0===this.glueIngredientDetail[2]?this.C="":(this.C=this.glueIngredientDetail[2].percentage+"%"+this.glueIngredientDetail[2].ingredientName,this.CC=this.glueIngredientDetail[2].percentage+"%"+this.glueIngredientDetail[2].ingredientName+"^"+this.glueIngredientDetail[2].allow+"%"),void 0===this.glueIngredientDetail[3]?this.D="":(this.D=this.glueIngredientDetail[3].percentage+"%"+this.glueIngredientDetail[3].ingredientName,this.DD=this.glueIngredientDetail[3].percentage+"%"+this.glueIngredientDetail[3].ingredientName+"^"+this.glueIngredientDetail[3].allow+"%"),void 0===this.glueIngredientDetail[4]?this.E="":(this.E=this.glueIngredientDetail[4].percentage+"%"+this.glueIngredientDetail[4].ingredientName,this.EE=this.glueIngredientDetail[4].percentage+"%"+this.glueIngredientDetail[4].ingredientName+"^"+this.glueIngredientDetail[4].allow+"%"),this.glueIngredientDetail.length>0?(this.percentageCount=this.glueIngredientDetail.map(e=>e.percentage),this.percentageCountEdit=this.glueIngredientDetail.map(e=>e),this.totalPercentage=this.percentageCount.reduce((e,t)=>e+t,0)):(this.percentageCount=[],this.percentageCountEdit=[],this.totalPercentage=0);const n=this.gridglue.getSelectedRowIndexes()[0];this.gridglue.getSelectedRowIndexes().length&&(this.gridglue.getSelectedRecords(),this.gridglue.dataSource[n].name=this.formula(),this.gridglue.refresh())}formula(){return this.B&&this.C&&this.D&&this.E?`{[ (${this.nameGlue}+ ${this.B}) + ${this.C} ] + ${this.D}}+ ${this.E}`:this.B&&this.C&&this.D?`[(${this.nameGlue} + ${this.B}) + ${this.C}] + ${this.D}`:this.B&&this.C?`(${this.nameGlue} + ${this.B}) + ${this.C}`:this.B?`${this.nameGlue} + ${this.B}`:""+this.nameGlue}formulaTamp(){return this.BB&&this.CC&&this.DD&&this.EE?(this.glueNewName=`{[ (${this.nameGlues}+ ${this.BB}) + ${this.CC} ] + ${this.DD}}+ ${this.EE}`,`{[ (${this.nameGlues}+ ${this.BB}) + ${this.CC} ] + ${this.DD}}+ ${this.EE}`):this.BB&&this.CC&&this.DD?(this.glueNewName=`[(${this.nameGlues} + ${this.BB}) + ${this.CC}] + ${this.DD}`,`[(${this.nameGlues} + ${this.BB}) + ${this.CC}] + ${this.DD}`):this.BB&&this.CC?(this.glueNewName=`(${this.nameGlues} + ${this.BB}) + ${this.CC}`,`(${this.nameGlues} + ${this.BB}) + ${this.CC}`):this.BB?(this.glueNewName=`${this.nameGlues} + ${this.BB}`,`${this.nameGlues} + ${this.BB}`):""+this.nameGlues}getDetail(e){this.glueIngredientService.getDetail(e).subscribe(e=>{var t,i,n,s;this.glueIngredientDetail=e.glueIngredients,this.setLocalStore("details",this.glueIngredientDetail),this.setLocalStore("detailsTamp",this.glueIngredientDetail),this.glueIngredientDetail=this.renderchemical(),this.oldDetail=this.renderchemical();const l=this.glueIngredientDetail.filter(e=>"A"===e.position)||[];this.nameGlue=(null===(t=l[0])||void 0===t?void 0:t.ingredientName)||"",this.nameGlues=(null===(i=l[0])||void 0===i?void 0:i.ingredientName)+"^"+(null===(n=this.glueIngredientDetail[0])||void 0===n?void 0:n.allow)+"%"||!1,this.A=(null===(s=l[0])||void 0===s?void 0:s.ingredientName)||"",void 0===this.glueIngredientDetail[1]?this.B="":(this.B=this.glueIngredientDetail[1].percentage+"%"+this.glueIngredientDetail[1].ingredientName,this.BB=this.glueIngredientDetail[1].percentage+"%"+this.glueIngredientDetail[1].ingredientName+"^"+this.glueIngredientDetail[1].allow+"%"),void 0===this.glueIngredientDetail[2]?this.C="":(this.C=this.glueIngredientDetail[2].percentage+"%"+this.glueIngredientDetail[2].ingredientName,this.CC=this.glueIngredientDetail[2].percentage+"%"+this.glueIngredientDetail[2].ingredientName+"^"+this.glueIngredientDetail[2].allow+"%"),void 0===this.glueIngredientDetail[3]?this.D="":(this.D=this.glueIngredientDetail[3].percentage+"%"+this.glueIngredientDetail[3].ingredientName,this.DD=this.glueIngredientDetail[3].percentage+"%"+this.glueIngredientDetail[3].ingredientName+"^"+this.glueIngredientDetail[3].allow+"%"),void 0===this.glueIngredientDetail[4]?this.E="":(this.E=this.glueIngredientDetail[4].percentage+"%"+this.glueIngredientDetail[4].ingredientName,this.EE=this.glueIngredientDetail[4].percentage+"%"+this.glueIngredientDetail[4].ingredientName+"^"+this.glueIngredientDetail[4].allow+"%"),this.glueIngredientDetail.length>0?(this.percentageCount=this.glueIngredientDetail.map(e=>e.percentage),this.percentageCount.join("+"),this.percentageCountEdit=this.glueIngredientDetail.map(e=>e),this.totalPercentage=this.percentageCount.reduce((e,t)=>e+t,0)):(this.percentageCount=[],this.percentageCountEdit=[],this.totalPercentage=0)})}updateChemicalList(){const e=this.getLocalStore("details");for(const t of e){const e=this.ingredients1.findIndex(e=>e.name===t.ingredientName&&e.id===t.ingredientID);-1!==e&&(this.ingredients1[e].position=t.position,this.ingredients1[e].percentage=t.percentage,this.ingredients1[e].allow=t.allow)}for(const t of e){const e=this.ingredients2.findIndex(e=>e.name===t.ingredientName&&e.id===t.ingredientID);-1!==e&&(this.ingredients2[e].position=t.position,this.ingredients2[e].percentage=t.percentage,this.ingredients2[e].allow=t.allow)}}actionBeginIngredient(e){if("beginEdit"===e.requestType){if(null===e.rowData.position)return this.alertify.warning("H\xe3y ch\u1ecdn t\xean tr\u01b0\u1edbc khi ch\u1ec9nh s\u1eeda!",!0),void(e.cancel=!0);if("A"===e.rowData.position)return this.alertify.warning("Kh\xf4ng \u0111\u01b0\u1ee3c ch\u1ec9nh s\u1eeda ch\u1ea5t A!",!0),void(e.cancel=!0);this.editPercentage.glueID=this.glueid,this.editPercentage.ingredientID=e.rowData.id,this.percentageDefault=e.rowData.percentage,this.editAllow.glueID=this.glueid,this.history.BeforeAllow="",this.history.AfterAllow="",this.editAllow.ingredientID=e.rowData.id,this.allowDefault=e.rowData.allow||0}if("save"===e.requestType){this.percentageEdit={percentage:Number(e.data.percentage),id:Number(e.rowData.id)},this.allowEdit={allow:Number(e.data.allow),id:Number(e.rowData.id)},"edit"===e.action&&(this.allowChange=e.data.allow||0,this.percentageChange=e.data.percentage),this.editPercentage.percentage=e.data.percentage,this.editAllow.allow=e.data.allow;const t=Number(this.percentageDefault)!==Number(this.percentageChange),i=Number(this.allowDefault)!==Number(this.allowChange);if(t){this.modified=!1;const t=this.getLocalStore("details"),i=t.findIndex(t=>t.ingredientName===e.data.name&&t.ingredientID===e.data.id);t[i].percentage=e.data.percentage,this.setLocalStore("details",t),this.updateChemicals()}if(i){const t=this.getLocalStore("details"),i=t.findIndex(t=>t.ingredientName===e.data.name&&t.ingredientID===e.data.id);t[i].allow=e.data.allow,this.setLocalStore("details",t),this.modified=!1,this.history.BeforeAllow=this.glueNewName,this.updateChemicals()}}"delete"===e.requestType&&this.deleteIngredient()}updateGlueIngredient(){}loadPreview(e){this.glueid=Number(e),this.getIngredients(),this.getDetail(this.glueid),this.detailGlue=!0}resolver(){this.route.data.subscribe(e=>{this.glues=e.glues.result,this.paginationG=e.glues.pagination})}onService(){this.ingredientService.currentIngredient.subscribe(e=>{300===e&&(this.getIngredients(),this.updateChemicalList(),this.ingredientService.changeIngredient(0))})}mapGlue(e){1==!e.status?(this.percentage=0,this.mapGlueIngredient({ingredientID:e.id,percentage:this.percentage,glueID:this.glueid})):this.delete(this.glueid,e.id)}getIngredients(){this.glueIngredientService.getIngredients(this.glueid).subscribe(e=>{this.ingredients1=e.result.list1,this.ingredients2=e.result.list2},e=>{this.alertify.error(e)})}getGlues(){this.glueService.getAllGlue().subscribe(e=>{this.glues=e},e=>{this.alertify.error(e)})}mapGlueIngredients(e){this.glueIngredientService.mapGlueIngredient(e).subscribe(e=>{void 0===this.subID?(this.sortBySup(0),this.getDetail(this.glueid)):(this.sortBySup(this.subID),this.getDetail(this.glueid))})}mapGlueIngredient(e){this.glueIngredientService.mappGlueIngredient(e).subscribe(e=>{void 0===this.subID?(this.getAllGluesByBPFCID(this.BPFCID),this.sortBySup(0),this.getDetail(this.glueid)):(this.sortBySup(this.subID),this.getDetail(this.glueid),this.getAllGluesByBPFCID(this.BPFCID))})}openIngredientModalComponent(){const e=this.modalService.open(O.a,{size:"md"});e.componentInstance.ingredient=this.ingredient,e.componentInstance.title="Add Ingredient",e.result.then(e=>{},e=>{})}actionCompleteIngredient(e){"beginEdit"===e.requestType&&"Item"!==this.setFocus.field&&(e.form.elements.namedItem(this.setFocus.field).focus(),e.form.elements.namedItem(this.setFocus.field).value="")}openPopupDropdownlist(){$('[data-toggle="tooltip"]').tooltip()}toolbarClick(e){switch(e.item.text){case"Add New":const t=this.getLocalStore("details").sort(this.dynamicSort("position"));if(!1===this.compareArray(this.oldDetail,t)&&t.length>0&&this.oldDetail.length>0)this.alertify.valid("C\u1ea3nh b\xe1o!","B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n b\u1ecf qua nh\u1eefng thay \u0111\u1ed5i n\xe0y?").then(e=>{const t={id:0,name:"1",code:"",gluename:"",createdDate:"",BPFCEstablishID:this.BPFCID,kindID:null,partID:null,materialID:null,consumption:"",expiredTime:0,createdBy:JSON.parse(localStorage.getItem("user")).user.id,glueNameID:0,glueIngredients:[]};this.glue=t,this.saveGlue()}).catch(t=>{e.cancel=!0});else{const e={id:0,name:"1",code:"",gluename:"",createdDate:"",BPFCEstablishID:this.BPFCID,kindID:null,partID:null,materialID:null,consumption:"",expiredTime:0,createdBy:JSON.parse(localStorage.getItem("user")).user.id,glueNameID:0,glueIngredients:[]};this.glue=e,this.saveGlue()}}}openModal(e){this.modalReference=this.modalService.open(e)}openModalHistory(e){this.modalReference=this.modalService.open(e,{size:"xxl"}),this.LoadHistoryBPFC()}LoadHistoryBPFC(){this.bPFCEstablishService.LoadHistoryBPFC(this.BPFCID).subscribe(e=>{this.historyData=e.map(e=>({id:e.id,glueID:e.glueID,createdTime:e.createdTime,bpfcEstablishID:e.bpfcEstablishID,before:e.before,after:e.after,action:e.action,remark:e.remark,userID:e.userID,createdBy:this.createdBy(e.userID)}))})}actionBeginHistory(e){"save"===e.requestType&&this.bPFCEstablishService.UpdateHistoryBPFC({ID:e.data.id,Remark:e.data.remark}).subscribe(e=>{e&&this.alertify.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng!")})}getAllUsers(){this.buildingUserService.getAllUsers(1,1e3).subscribe(e=>{this.userData=e.result})}createdBy(e){if(0===e)return"#N/A";const t=this.userData.filter(t=>t.ID===e)[0];return void 0!==t?t.Username:"#N/A"}cloneModelname(){this.alertify.confirm("Sao ch\xe9p model name!","B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n sao ch\xe9p model name kh\xf4ng?",()=>{this.modalNameService.cloneModelname(this.modelNameID,this.modelNameClone,this.modelNoClone,this.valueProcess).subscribe(e=>{this.alertify.success("the model name has been cloned"),this.modalReference.close(),this.modelNameDropdownlist.hidePopup()})})}cloneArticleModelname(){this.alertify.confirm("Sao ch\xe9p article!","B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n sao ch\xe9p article kh\xf4ng?",()=>{this.modalNameService.cloneArticleModelname(this.modelNameID,this.modelNameClone,this.modelNoClone,this.articleName,this.processID).subscribe(e=>{this.alertify.success("Sao ch\xe9p th\xe0nh c\xf4ng!"),this.modalReference.close(),this.modelNameDropdownlist.hidePopup()})})}delete(e,t){this.glueIngredientService.delete(e,t).subscribe(t=>{this.alertify.success("\u0110\xe3 x\xf3a th\xe0nh c\xf4ng!"),this.getIngredients(),this.getDetail(e)})}deleteGlue(e){this.alertify.confirm("X\xf3a keo",'B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n x\xf3a keo n\xe0y kh\xf4ng "'+e.id+'" ?',()=>{this.glueService.delete(e.id).subscribe(()=>{this.getGlues(),this.alertify.success("\u0110\xe3 x\xf3a th\xe0nh c\xf4ng!")},e=>{this.alertify.error("X\xf3a th\u1ea5t b\u1ea1i r\u1ed3i!")})})}deleteIngridient(e){this.alertify.confirm("X\xf3a ingredient",'B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n x\xf3a ingredient n\xe0y kh\xf4ng "'+e.id+'" ?',()=>{this.ingredientService.delete(e.id).subscribe(()=>{this.getIngredients(),this.alertify.success("\u0110\xe3 x\xf3a th\xe0nh c\xf4ng!")},e=>{this.alertify.error("X\xf3a th\u1ea5t b\u1ea1i r\u1ed3i!")})})}getAllGluesByBPFCID(e){this.glueService.getAllGluesByBPFCID(e).subscribe(e=>{this.glues=e})}getAllGluesByBPFCID2(e){this.glueService.getAllGluesByBPFCID(e).subscribe(e=>{void 0===this.ingredientID?(this.glues=e,e.length>0&&(this.detailGlue=!0)):(this.glueid=e[0].id,this.glueIngredient2.ingredientID=this.ingredientID,this.glueIngredient2.percentage=100,this.glueIngredient2.glueID=this.glueid,this.glueIngredient2.position="A",this.mapGlueIngredient(this.glueIngredient2))})}updateChemicals(){this.ingredientService.sortBySup(this.glueid,this.subID).subscribe(e=>{this.ingredients1=e.list1,this.ingredients2=e.list2;const t=this.getLocalStore("details");for(const i of t){const e=this.ingredients1.findIndex(e=>e.name===i.ingredientName&&e.id===i.ingredientID);-1!==e&&(this.ingredients1[e].position=i.position,this.ingredients1[e].percentage=i.percentage,this.ingredients1[e].allow=i.allow)}for(const i of t){const e=this.ingredients2.findIndex(e=>e.name===i.ingredientName&&e.id===i.ingredientID);-1!==e&&(this.ingredients2[e].position=i.position,this.ingredients2[e].percentage=i.percentage,this.ingredients2[e].allow=i.allow)}this.glueIngredientDetail=t,this.makeFormula()})}sortBySup(e){0===this.gridglue.getSelectedRowIndexes().length?this.alertify.warning("Please select a glue!",!0):(this.subID=e,this.ingredientService.sortBySup(this.glueid,e).subscribe(t=>{if(this.ingredients1=t.list1,this.ingredients2=t.list2,0===e){const e=this.getLocalStore("details");this.ingredients1=e.map(e=>({id:e.ingredientID,name:e.ingredientName,code:"",percentage:e.percentage,createdDate:e.createdDate,supplierID:0,allow:e.allow,position:e.position,expiredTime:e.expiredTime,daysToExpiration:e.daysToExpiration,voc:e.voc,materialNO:e.materialNO,unit:e.unit,real:e.real,cbd:e.cbd})),this.glueIngredientDetail=e}else this.updateChemicalList()}))}saveGlue(){0===this.glue.id||void 0===this.glue.id?(""===this.glue.code&&this.genaratorGlueCode(),this.createGlue()):this.onChangeChemical?this.updateChemical():this.update(),this.oldDetail=[],localStorage.removeItem("details"),this.glueIngredientDetail=[],this.gridglue.refresh(),this.selectedRow=[0],this.selIndex=[0],this.modified=!0}getBuilding(){JSON.parse(localStorage.getItem("user"))}getAllIngredient(){this.ingredientService.getAllIngredient().subscribe(e=>{this.ingrediented=e})}createGlue(){this.glueService.create(this.glue).subscribe(()=>{this.alertify.success("\u0110\xe3 t\u1ea1o th\xe0nh c\xf4ng!"),this.getAllGluesByBPFCID(this.BPFCID),this.clearGlueForm(),this.genaratorGlueCode(),this.expiredTime=0},e=>{this.alertify.error(e),this.genaratorGlueCode()})}finished(){const e=JSON.parse(localStorage.getItem("user")).user.id;if(0===this.gridglue.getSelectedRowIndexes().length)this.alertify.warning("H\xe3y ch\u1ecdn v\xe0o 1 glue v\xe0 t\u1ea1o c\xf4ng th\u1ee9c sau \u0111\xf3 m\u1edbi b\u1ea5m ho\xe0n th\xe0nh!",!0);else{this.history.BPFCEstablishID=this.BPFCID,this.history.GlueID=this.glueid,this.history.After=this.GlueNameDefault,this.history.AfterAllow=this.glueNewName,this.history.UserID=e,this.bPFCEstablishService.AddHistoryBPFC(this.history).subscribe(()=>{});const t=this.getLocalStore("details"),i=this.gridglue.getSelectedRecords()[0];i.expiredTime=t.filter(e=>"A"===e.position)[0].expiredTime,i.kindID=0===i.kindID?null:i.kindID,i.partID=0===i.partID?null:i.partID,i.materialID=0===i.materialID?null:i.materialID,this.selectedRow=this.gridglue.getSelectedRowIndexes(),this.glueService.update(i).subscribe(e=>{this.alertify.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng!"),this.getAllGluesByBPFCID(this.BPFCID),this.detailGlue=!0,this.modified=!0}),t.length>0&&(this.mapGlueIngredients(t),this.modified=!0)}}clearGlueForm(){this.glue.gluename="",this.glue.kindID=null,this.glue.partID=null,this.glue.materialID=null,this.glue.consumption="",this.showBarCode=!1}update(){this.glueService.update(this.glue).subscribe(e=>{this.alertify.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng!"),this.getAllGluesByBPFCID(this.BPFCID),this.detailGlue=!1,this.history.Action="Created",this.expiredTime=0})}updateChemical(){this.glueService.updateChemical(this.glue).subscribe(e=>{this.alertify.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng!"),this.getAllGluesByBPFCID(this.BPFCID),this.detailGlue=!1,this.onChangeChemical=!1,this.history.Action="Created"})}deleteIngredient(){this.ingredientService.delete(this.ingridientID).subscribe(()=>{const e=this.getLocalStore("details").filter(e=>e.ingredientID!==this.ingridientID);this.setLocalStore("details",e),this.glueIngredientDetail=e,this.getIngredients(),this.makeFormula(),this.alertify.success("\u0110\xe3 x\xf3a th\xe0nh c\xf4ng!")},e=>{this.alertify.error("X\xf3a th\u1ea5t b\u1ea1i r\u1ed3i!")})}approval(){const e=this.gridglue.dataSource;let t=!1,i=!1,n=!1;if(e){for(const l of e){if(l.glueIngredients.length>0){const e=l.glueIngredients.filter(e=>"A"!==e.position);for(const n of e){if(n.allow<=0&&"A"!==n.position)return t=!1,this.approvalStatus=!this.approvalStatus,void this.alertify.warning(`The allowance of checmical name ${n.ingredient.name} must be greater than 0 <br>\n              M\u1ee9c cho ph\xe9p c\u1ee7a h\xf3a ch\u1ea5t ${n.ingredient.name} ph\u1ea3i l\u1edbn h\u01a1n 0!<br>\n               <label>Glue Name: </label> ${l.name} <br>\n              `,!0);if(n.percentage<=0&&"A"!==n.position)return i=!1,this.approvalStatus=!this.approvalStatus,void this.alertify.warning(`The percentage of checmical name ${n.ingredient.name} must be greater than 0 <br>\n              Ph\u1ea7n tr\u0103m c\u1ee7a h\xf3a ch\u1ea5t ${n.ingredient.name} ph\u1ea3i l\u1edbn h\u01a1n 0!<br>\n               <label>Glue Name: </label> ${l.name} <br>\n              `,!0);t=!0,i=!0}}if(+l.consumption<=0)return n=!1,this.approvalStatus=!this.approvalStatus,void this.alertify.warning(`The consumption of glue name ${l.name} must be greater than 0 <br>\n          M\u1ee9c ti\xeau th\u1ee5 c\u1ee7a keo ${l.name} ph\u1ea3i l\u1edbn h\u01a1n 0! <br>\n          <label>Glue Name: </label> ${l.name} <br>\n          `,!0);n=!0}const s=JSON.parse(localStorage.getItem("user")).user.id;this.bPFCEstablishService.approval(this.BPFCID,s).subscribe(e=>{this.alertify.success("The BPFC has been approved!"),this.createdStatus=this.approvalStatus;const t=this.modelNameDropdownlist.getDataByValue(this.modelNameDropdownlist.value);this.modelNameDropdownlist.valueTemplate=`(${this.checkStatus(this.approvalStatus,this.createdStatus)}) ${t.name}`})}}done(){const e=this.gridglue.dataSource;let t=!1,i=!1,n=!1;if(e){for(const s of e){if(s.glueIngredients.length>0){const e=s.glueIngredients.filter(e=>"A"!==e.position);for(const n of e){if(n.allow<=0)return t=!1,this.createdStatus=!this.createdStatus,void this.alertify.warning(`The allow of checmical name ${n.ingredient.name} is greater than 0 <br>\n              M\u1ee9c cho ph\xe9p c\u1ee7a h\xf3a ch\u1ea5t ${n.ingredient.name} ph\u1ea3i l\u1edbn h\u01a1n 0!<br>\n               <label>Glue Name: </label> ${s.name} <br>\n              `,!0);if(n.percentage<=0)return i=!1,this.createdStatus=!this.createdStatus,void this.alertify.warning(`The percentage of checmical name ${n.ingredient.name} is greater than 0 <br>\n              Ph\u1ea7n tr\u0103m c\u1ee7a h\xf3a ch\u1ea5t ${n.ingredient.name} ph\u1ea3i l\u1edbn h\u01a1n 0!<br>\n               <label>Glue Name: </label> ${s.name} <br>\n              `,!0);t=!0,i=!0}0===e.length&&(t=!0,i=!0)}if(+s.consumption<=0)return n=!1,this.createdStatus=!this.createdStatus,void this.alertify.warning(`The consumption of glue name ${s.name} is greater than 0 <br>\n          M\u1ee9c ti\xeau th\u1ee5 c\u1ee7a keo ${s.name} ph\u1ea3i l\u1edbn h\u01a1n 0! <br>\n          <label>Glue Name: </label> ${s.name} <br>\n          `,!0);n=!0}if(t&&i&&n){const e=JSON.parse(localStorage.getItem("user")).user.id;this.bPFCEstablishService.done(this.BPFCID,e).subscribe(e=>{!0===e.status?(this.alertify.success(e.message),this.createdStatus=this.createdStatus):this.alertify.success(e.message)})}}}getModelNames(){this.modalNameService.getAllModalName().subscribe(e=>{this.modelNameData=e.map(e=>({id:e.id,name:e.name}))})}getArticleNoByModelNameID(e){this.articleNoService.getArticleNoByModelNoID(e).subscribe(e=>{this.articleNoData=e})}getModelNoByModelNameID(e){this.modelNoService.getModelNoByModelNameID(e).subscribe(e=>{this.modelNoData=e})}getArtProcessByArticleNoID(e){this.artProcessService.getArtProcessByArticleNoID(e).subscribe(e=>{this.artProcessData=e.map(e=>({id:e.id,name:1===e.processID?"ASY":"STF"}))})}getAllProcess(){this.artProcessService.GetAllProcess().subscribe(e=>{this.artProcessDataClone2=e})}getAllKind(){this.kindService.getAllKind().subscribe(e=>{this.kinds=e})}getAllPart(){this.partService.getAllPart().subscribe(e=>{this.parts=e})}getAllMaterial(){this.materialService.getAllMaterial().subscribe(e=>{this.materials=e})}getIngredientsByGlueID(){this.ingredientService.getIngredientsByGlueID(this.glueid).subscribe(e=>{this.ingredients1=e.list1,this.ingredients2=e.list2})}getAllSupllier(){this.ingredientService.getAllSupplier().subscribe(e=>{this.supplier=e})}getArticleNoByModelNoID(e){this.articleNoService.getArticleNoByModelNoID(e).subscribe(e=>{this.articleNosData=e})}getBPFCID(e){this.bPFCEstablishService.getBPFCID(e).subscribe(e=>{this.resetLifeCycleBPFC(),this.BPFCID=null==e?void 0:e.id,this.approvalStatus=e.approvalStatus,this.createdStatus=e.finishedStatus,this.glue.BPFCEstablishID=this.BPFCID,this.getAllGluesByBPFCID(this.BPFCID),this.getAllPart(),this.getAllKind(),this.getAllMaterial(),this.getAllIngredient(),this.existGlue=!0,this.modified=!0})}OndataBound(e){}getModelNamesClone(){this.modalNameService.getAllModalName().subscribe(e=>{this.modelNameDataClone=e.map(e=>({id:e.id,name:e.name})),this.getModelNoByModelNameIDClone(this.modelNameIDClone),this.articleNosDataClone=[],this.artProcessDataClone=[]})}getArticleNoByModelNameIDClone(e){this.articleNoService.getArticleNoByModelNoID(e).subscribe(e=>{this.articleNosDataClone=e})}getModelNoByModelNameIDClone(e){this.modelNoService.getModelNoByModelNameID(e).subscribe(e=>{this.modelNOsDataClone=e}),this.getArticleNoByModelNameIDClone(this.valuemodelNo)}getArtProcessByArticleNoIDClone(e){this.artProcessService.getArtProcessByArticleNoID(e).subscribe(e=>{this.artProcessDataClone=e.map(e=>({id:e.id,name:1===e.ProcessID?"ASY":"STF"}))})}onChangeModelName(e){this.resetLifeCycleBPFC(),this.modelNameID=e.value,this.getModelNoByModelNameID(this.modelNameID),this.existGlue=!1,this.modelNameIDClone=e.value,this.value=e.value,this.valuemodelNo=0,this.modified=!1,this.modelNoData=[],this.articleNosData=[],this.artProcessData=[],this.modelNameSelect=!0,this.modelNoSelect=!1,this.modelArtSelect=!1,this.modelProcessSelect=!1}onChangeModelNo(e){e.isInteracted&&(this.modelNoID=e.value,this.valuemodelNo=e.value,this.getArticleNoByModelNoID(this.modelNoID),this.existGlue=!1,this.modified=!1,this.articleNosData=[],this.artProcessData=[],this.modelNoSelect=!0)}onChangeArticleNo(e){e.isInteracted&&(this.articleNoID=e.value,this.getArtProcessByArticleNoID(this.articleNoID),this.existGlue=!1,this.modified=!1,this.modelArtSelect=!0,this.artProcessData=[])}onClickProcess(e){this.modelProcessSelect=!0,e.target.defaultValue&&(this.artProcessID=Number(e.target.defaultValue))}ClickProcessData(e){}clearFormClone(){this.modelNameIDClone=this.value,this.modelNOIDClone=this.valuemodelNo,this.articleNOIDClone=0,this.artProcessIDClone=0,this.articleNosDataClone=[],this.artProcessDataClone=[],this.artProcessDataClone2=[]}onClickClone(){const e={modelNameID:this.modelNameIDLeo,modelNOID:this.modelNoIDLeo,articleNOID:this.articleNoIDLeo,artProcessID:Number(this.artProcessIDLeo),bpfcID:this.BPFCIDLeo,name:this.articleNoNewLeo,cloneBy:JSON.parse(localStorage.getItem("user")).user.id};this.clone(e)}clone(e){this.articleNoNewLeo!==this.articleNoLeo?this.modalNameService.cloneBPFC(e).subscribe(e=>{!0===e.status?(this.alertify.success("\u0110\xe3 sao ch\xe9p th\xe0nh c\xf4ng!"),this.modalService.dismissAll(),this.getAllUsers()):this.alertify.error("The BPFC exists!")}):this.alertify.error("The BPFC exists!")}onChangeModelNameClone(e){this.value!==e.value&&(this.modelNOsDataClone=[],this.modelNameIDClone=e.value,this.getModelNoByModelNameIDClone(this.modelNameIDClone)),this.modelNameIDClone=e.value,this.getModelNoByModelNameIDClone(this.modelNameIDClone)}onChangeModelNoClone(e){this.modelNOIDClone=e.value,null!==this.modelNOIDClone&&this.getArticleNoByModelNameIDClone(this.modelNOIDClone),this.articleNosDataClone=[],this.artProcessDataClone=[]}onChangeArticleNoClone(e){e.isInteracted&&(this.articleNOIDClone=e.value,this.getArtProcessByArticleNoIDClone(this.articleNOIDClone))}onChangeProcessClone(e){e.isInteracted&&(this.artProcessIDClone=e.value)}changeAllowColor(e){return null===e.position?"":this.positions.includes(e.position)&&0===e.allow||this.positions.includes(e.position)&&null===e.allow?"font-weight-bold text-white p-2 rounded-circle warning-text":void 0}changePercentageColor(e){return null===e.percentage?"":this.positions.includes(e.position)&&0===e.percentage?"font-weight-bold text-white p-2 rounded-circle warning-text":void 0}changeConsumptionColor(e){return 0===e.glueIngredients.length?"":""===e.consumption?"font-weight-bold text-white p-2 rounded-circle warning-text":void 0}}return e.\u0275fac=function(t){return new(t||e)(R.Mb(J),R.Mb(M.a),R.Mb(z.a),R.Mb(F.a),R.Mb(c.b),R.Mb(P.a),R.Mb(j.a),R.Mb(T.a),R.Mb(H),R.Mb(_),R.Mb(Q.a),R.Mb(q.a),R.Mb(V.a),R.Mb(k.a),R.Mb(X),R.Mb(Y.a),R.Mb(E.a))},e.\u0275cmp=R.Gb({type:e,selectors:[["app-bpfc-detail"]],viewQuery:function(e,t){if(1&e&&(R.Qc(it,!0),R.Qc(nt,!0),R.Qc(st,!0),R.Qc(lt,!0),R.Qc(at,!0),R.Qc(ot,!0),R.Qc(rt,!0),R.Qc(ct,!0)),2&e){let e;R.xc(e=R.dc())&&(t.switch=e.first),R.xc(e=R.dc())&&(t.grid=e.first),R.xc(e=R.dc())&&(t.gridglue=e.first),R.xc(e=R.dc())&&(t.grid2=e.first),R.xc(e=R.dc())&&(t.modelNameDropdownlist=e.first),R.xc(e=R.dc())&&(t.modelNoDropdownlist=e.first),R.xc(e=R.dc())&&(t.chemicalDropdownlist=e.first),R.xc(e=R.dc())&&(t.positionDropdownlist=e)}},features:[R.yb([S.n,S.f,S.k])],decls:48,vars:10,consts:[[1,"row"],[1,"col-md-5"],[1,"card"],[1,"col-md-12","card-body","table-responsive"],[1,"col-md-3","mt-2"],[1,"col-md-8","mt-2"],["type","text","name","","disabled","","title","",1,"form-control",3,"value"],[1,"col-md-1","mt-2"],["type","button",1,"btn","btn-danger","rounded-pill"],[1,"card-body","table-responsive","p-0"],["class","control-section",4,"ngIf"],[1,"col-md-7"],[1,"card-header"],[1,"card-title"],["class","card-tools",4,"ngIf"],["class","card-body",4,"ngIf"],["cloneArticleModal",""],["HistoryModal",""],["cloneModal",""],[1,"control-section"],["height","250px","showColumnMenu","true","allowSorting","true","allowResizing","true","gridLines","Both",3,"dataSource","editSettings","toolbar","allowSorting","selectedRowIndex","rowDeselected","actionBegin","rowSelected","created","toolbarClick","dataBound"],["gridglue",""],["field","name","isPrimaryKey","true","headerText","Chemical","textAlign","Center","width","150"],["headerTemplate",""],["template",""],["field","consumption","headerText","Std. Con.(g)","textAlign","Center","width","150"],["field","expiredTime","headerText","Expired Time","isPrimaryKey","true","textAlign","Center","width","150"],["field","kindName","headerText","Kind","textAlign","Center","width","150"],["editTemplate",""],["field","partName","headerText","Part","textAlign","Center","width","150"],["field","materialName","headerText","Material","textAlign","Center","width","150"],["data-toggle","tooltip","data-placement","top",3,"title"],[3,"dataSource","ngModel","fields","allowFiltering","ngModelChange","select"],["glueDropdownlist",""],["popupHeight","200px","popupWidth","250px",3,"dataSource","ngModel","fields","allowFiltering","ngModelChange","select"],[1,"card-tools"],["type","button",1,"btn","btn-danger","btn-sm","mr-2","d-none"],[1,"fas","fa-undo"],["style","width: 100px; margin-right: 10px;",3,"onLabel","offLabel","disabled","ngModel","checked","click","ngModelChange",4,"ngIf"],[4,"ngIf"],["type","button","ejs-button","","cssClass","e-small e-success ml-2",3,"click",4,"ngIf"],["type","button","ejs-button","","cssClass","e-small e-default ml-2",3,"click",4,"ngIf"],[2,"width","100px","margin-right","10px",3,"onLabel","offLabel","disabled","ngModel","checked","click","ngModelChange"],["switch",""],["onLabel","Approved","style","width: 120px;",3,"offLabel","ngModel","checked","click","ngModelChange",4,"ngIf"],["onLabel","Approved",2,"width","120px",3,"offLabel","ngModel","checked","click","ngModelChange"],["type","button","ejs-button","","cssClass","e-small e-success ml-2",3,"click"],[1,"fas","fa-save"],["type","button","ejs-button","","cssClass","e-small e-default ml-2",3,"click"],[1,"fas","fa-history"],[1,"card-body"],[1,"col-lg-12","col-xs-12","col-12",2,"text-align","center"],["type","button",1,"btn","bg-gradient-secondary","btn-sm","rounded-pill",3,"click"],["type","button","style","margin: 3px","class","btn btn-info btn-sm rounded-pill",3,"click",4,"ngFor","ngForOf"],[1,"col-md-6"],["height","675px","gridLines","Both","showColumnMenu","true","allowSorting","true","allowResizing","true",3,"dataSource","allowSorting","editSettings","toolbar","actionComplete","recordDoubleClick","actionBegin","toolbarClick","rowSelected"],["grid",""],["field","Item","isPrimaryKey","true","headerText","Item","width","80","textAlign","Center"],["field","name","isPrimaryKey","true","headerText","Name","width","140","textAlign","Center"],["field","percentage","headerText","%","textAlign","Center","width","60"],["field","allow","headerText","Allow (%)","textAlign","Center","width","60"],["height","675px","showColumnMenu","true","allowSorting","true","allowResizing","true","gridLines","Both",3,"dataSource","allowSorting","editSettings","toolbar","actionComplete","recordDoubleClick","actionBegin","toolbarClick","rowSelected"],["grid2",""],[2,"visibility","hidden"],[2,"list-style-type","square","font-weight","bold"],["style","list-style: none;",4,"ngFor","ngForOf"],[2,"list-style","none"],[1,"font-weight-bold","text-danger"],["type","button",1,"btn","btn-info","btn-sm","rounded-pill",2,"margin","3px",3,"click"],[1,"fas","fa-cannabis"],[3,"dataSource","value","fields","allowFiltering","change"],["positionDropdownlist",""],[1,"fas","fa-exclamation-circle"],[1,"modal-header"],[1,"modal-title"],[1,"fas","fa-plus"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"col-md-12"],[1,"form-group"],["for","Name"],[2,"color","red"],["type","text",1,"form-control",3,"ngModel","ngModelChange"],["placeholder","Select a process",1,"w-100",3,"value","dataSource","allowFiltering","fields","change"],["processDropdownlist",""],[1,"modal-footer"],["type","button",1,"btn","btn-light",3,"click"],["type","submit",1,"btn","btn-primary",3,"click"],["height","675px","gridLines","Both","showColumnMenu","true","allowSorting","true","allowResizing","true",3,"dataSource","allowSorting","editSettings","toolbar","actionBegin"],["gridHistory",""],["field","createdTime","isPrimaryKey","true","headerText","Time","textAlign","Center"],["field","action","isPrimaryKey","true","headerText","Status","width","150","textAlign","Center"],["field","before","headerText","Before","width","450","isPrimaryKey","true","textAlign","Left"],["field","after","headerText","After","width","450","isPrimaryKey","true","textAlign","Left"],["field","remark","headerText","Remark","textAlign","Center",3,"edit"],["field","createdBy","headerText","Created By","isPrimaryKey","true","textAlign","Center"],["type","button",1,"btn","btn-primary",3,"click"],[3,"ngClass"],[4,"ngIf","ngIfElse"],["elseTemplate",""],["type","text","name","remark",1,"e-field","e-input","e-defaultcell",2,"text-align","Center",3,"value"],["disabled","disabled","type","text","name","remark",1,"e-field","e-input","e-defaultcell",2,"text-align","Center",3,"value"],["type","text","name","","title","",1,"form-control",3,"ngModel","value","ngModelChange"]],template:function(e,t){1&e&&(R.Sb(0,"div",0),R.Sb(1,"div",1),R.Sb(2,"div",2),R.Sb(3,"div",3),R.Sb(4,"div",0),R.Sb(5,"div",4),R.Sb(6,"label"),R.Kc(7,"Model Name: "),R.Rb(),R.Rb(),R.Sb(8,"div",5),R.Nb(9,"input",6),R.Rb(),R.Rb(),R.Sb(10,"div",0),R.Sb(11,"div",4),R.Sb(12,"label"),R.Kc(13,"Model NO: "),R.Rb(),R.Rb(),R.Sb(14,"div",5),R.Nb(15,"input",6),R.Rb(),R.Rb(),R.Sb(16,"div",0),R.Sb(17,"div",4),R.Sb(18,"label"),R.Kc(19,"Article NO: "),R.Rb(),R.Rb(),R.Sb(20,"div",5),R.Nb(21,"input",6),R.Rb(),R.Nb(22,"div",7),R.Rb(),R.Sb(23,"div",0),R.Sb(24,"div",4),R.Sb(25,"label"),R.Kc(26,"Process: "),R.Rb(),R.Rb(),R.Sb(27,"div",5),R.Sb(28,"button",8),R.Kc(29),R.Rb(),R.Rb(),R.Nb(30,"div",7),R.Rb(),R.Rb(),R.Rb(),R.Sb(31,"div",2),R.Sb(32,"div",9),R.Ic(33,Nt,32,5,"div",10),R.Rb(),R.Rb(),R.Rb(),R.Sb(34,"div",11),R.Sb(35,"div",2),R.Sb(36,"div",12),R.Sb(37,"h3",13),R.Kc(38),R.hc(39,"translate"),R.Rb(),R.Ic(40,Pt,8,4,"div",14),R.Rb(),R.Ic(41,qt,63,14,"div",15),R.Rb(),R.Rb(),R.Ic(42,Vt,27,5,"ng-template",null,16,R.Jc),R.Ic(44,ei,24,6,"ng-template",null,17,R.Jc),R.Rb(),R.Ic(46,ti,42,5,"ng-template",null,18,R.Jc)),2&e&&(R.zb(9),R.mc("value",t.modelNameDetail),R.zb(6),R.mc("value",t.modelNoDetail),R.zb(6),R.mc("value",t.articleNoDetail),R.zb(8),R.Lc(t.artProcessDetail),R.zb(4),R.mc("ngIf",t.existGlue),R.zb(5),R.Mc("",R.ic(39,8,"PREVIEW")," "),R.zb(2),R.mc("ngIf",t.existGlue),R.zb(1),R.mc("ngIf",t.existGlue))},directives:[s.m,S.j,h.d,v.d,v.b,S.e,S.b,h.c,v.c,v.a,S.d,S.a,r.c,l.g,l.j,u.i,u.b,s.l,l.b,s.k],pipes:[p.c,s.d],styles:[".e-grid[_ngcontent-%COMP%]   td.e-active[_ngcontent-%COMP%]{background:#6597ce!important;color:#000}.radiobutton-control[_ngcontent-%COMP%]{margin:5% 0 5% 40%}@media only screen and (max-width:500px){.radiobutton-control[_ngcontent-%COMP%]{margin-left:21%;margin-top:20%;margin-bottom:27%}}@media only screen and (max-width:700px){.checkbox-control[_ngcontent-%COMP%]{margin-left:35%;margin-top:8%}.control-section[_ngcontent-%COMP%]{min-height:200px}}.control-section[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{margin:20px 0}.radiobutton-control[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:18px}.e-bigger[_ngcontent-%COMP%]   .radiobutton-control[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:20px}.warning-text[_ngcontent-%COMP%]{-webkit-animation:warning-frames .5s infinite;animation:warning-frames .5s infinite;color:#000}@-webkit-keyframes warning-frames{0%{background-color:#d40a0a}to{background-color:#ff6565}}@keyframes warning-frames{0%{background-color:#d40a0a}to{background-color:#ff6565}}"]}),e})();var ni=i("dQqK"),si=i("quSY"),li=i("iStF"),ai=i("MAxt"),oi=i("NkNT");const ri=["grid"],ci=["importModal"],di=["tooltip"];function hi(e,t){if(1&e&&R.Kc(0),2&e){const e=t.$implicit,i=R.gc();R.Lc(i.NO(e.index))}}function ui(e,t){if(1&e){const e=R.Tb();R.Sb(0,"ejs-tooltip",24,25),R.cc("beforeRender",function(i){R.Bc(e);const n=t.$implicit;return R.gc().onBeforeRender(i,n,n.index)}),R.Kc(2),R.Rb()}if(2&e){const e=t.$implicit;R.zb(2),R.Mc(" ",e.modelName," ")}}function gi(e,t){if(1&e&&(R.Kc(0),R.hc(1,"date")),2&e){const e=t.$implicit;R.Mc(" ","ASY"===e.artProcess?"N/A":R.jc(1,1,e.dueDate,"d MMM, yyyy")," ")}}function mi(e,t){if(1&e){const e=R.Tb();R.Sb(0,"div"),R.Sb(1,"ejs-datepicker",28),R.cc("change",function(t){return R.Bc(e),R.gc(2).onChangeDueDate(t)}),R.Rb(),R.Rb()}if(2&e){const e=R.gc().$implicit;R.zb(1),R.mc("value",e.dueDate)}}function bi(e,t){if(1&e&&(R.Kc(0),R.hc(1,"date")),2&e){const e=R.gc().$implicit;R.Mc(" ","ASY"===e.artProcess?"N/A":R.jc(1,1,e.dueDate,"d MMM, yyyy")," ")}}function pi(e,t){if(1&e&&(R.Ic(0,mi,2,1,"div",26),R.Ic(1,bi,2,4,"ng-template",null,27,R.Jc)),2&e){const e=t.$implicit,i=R.yc(2);R.mc("ngIf","STF"===e.artProcess)("ngIfElse",i)}}function fi(e,t){if(1&e){const e=R.Tb();R.Sb(0,"button",35),R.cc("click",function(){R.Bc(e);const t=R.gc().$implicit,i=R.gc(),n=R.yc(34);return i.openModal(n,t)}),R.Nb(1,"i",36),R.Rb()}}function Ii(e,t){if(1&e){const e=R.Tb();R.Sb(0,"button",37),R.cc("click",function(){R.Bc(e);const t=R.gc().$implicit,i=R.gc(),n=R.yc(36);return i.openModalClone(n,t)}),R.Nb(1,"i",38),R.Rb()}}function Di(e,t){if(1&e){const e=R.Tb();R.Sb(0,"button",29),R.cc("click",function(){R.Bc(e);const i=t.$implicit;return R.gc().detail(i)}),R.Nb(1,"i",30),R.Rb(),R.Ic(2,fi,2,0,"button",31),R.Ic(3,Ii,2,0,"button",32),R.Sb(4,"button",33),R.cc("click",function(){R.Bc(e);const i=t.$implicit;return R.gc().delete(i.id)}),R.Nb(5,"i",34),R.Rb()}if(2&e){const e=t.$implicit;R.zb(2),R.mc("ngIf",!0===e.finishedStatus),R.zb(1),R.mc("ngIf",!1===e.finishedStatus)}}function Si(e,t){if(1&e){const e=R.Tb();R.Sb(0,"div",39),R.Sb(1,"h4",40),R.Nb(2,"i",41),R.Kc(3," Import Excel "),R.Rb(),R.Sb(4,"button",42),R.cc("click",function(){return t.$implicit.dismiss("Cross click")}),R.Sb(5,"span",43),R.Kc(6,"\xd7"),R.Rb(),R.Rb(),R.Rb(),R.Sb(7,"div",44),R.Sb(8,"div",4),R.Sb(9,"div",45),R.Sb(10,"div",46),R.Sb(11,"label",47),R.Kc(12,"Select File (*Notice: Excel file must be followed a system template. If you do not have a template, please "),R.Sb(13,"a",48),R.Kc(14,"click here"),R.Rb(),R.Kc(15," to download. Thank you!)"),R.Rb(),R.Sb(16,"input",49),R.cc("change",function(t){return R.Bc(e),R.gc().fileProgress(t)}),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Sb(17,"div",50),R.Sb(18,"button",51),R.cc("click",function(){return R.Bc(e),R.gc().uploadFile()}),R.Kc(19,"Upload File"),R.Rb(),R.Sb(20,"button",52),R.cc("click",function(){return t.$implicit.close("Close click")}),R.Kc(21,"Close"),R.Rb(),R.Rb()}if(2&e){const e=R.gc();R.zb(13),R.mc("href",e.excelDownloadUrl,R.Dc)}}function Ni(e,t){if(1&e){const e=R.Tb();R.Sb(0,"div",39),R.Sb(1,"h4",40),R.Nb(2,"i",41),R.Kc(3," New Version BPFC "),R.Rb(),R.Sb(4,"button",42),R.cc("click",function(){return t.$implicit.dismiss("Cross click")}),R.Sb(5,"span",43),R.Kc(6,"\xd7"),R.Rb(),R.Rb(),R.Rb(),R.Sb(7,"div",44),R.Sb(8,"div",4),R.Sb(9,"div",5),R.Sb(10,"div",46),R.Sb(11,"label",47),R.Kc(12,"Model Name"),R.Rb(),R.Nb(13,"input",53),R.Rb(),R.Rb(),R.Sb(14,"div",5),R.Sb(15,"div",46),R.Sb(16,"label",47),R.Kc(17,"Model NO"),R.Rb(),R.Nb(18,"input",53),R.Rb(),R.Rb(),R.Sb(19,"div",5),R.Sb(20,"div",46),R.Sb(21,"label",47),R.Kc(22,"Article NO"),R.Rb(),R.Sb(23,"span",54),R.Kc(24,"(*)"),R.Rb(),R.Sb(25,"div",55),R.Sb(26,"div",56),R.Sb(27,"span",57),R.Kc(28),R.Rb(),R.Rb(),R.Sb(29,"input",58),R.cc("ngModelChange",function(t){return R.Bc(e),R.gc().value=t}),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Sb(30,"div",5),R.Sb(31,"div",46),R.Sb(32,"label",47),R.Kc(33,"Process"),R.Rb(),R.Nb(34,"input",53),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Sb(35,"div",50),R.Sb(36,"button",59),R.cc("click",function(){return t.$implicit.close("Close click")}),R.Kc(37,"Close"),R.Rb(),R.Sb(38,"button",60),R.cc("click",function(){return R.Bc(e),R.gc().onClickCloneNewVersion()}),R.Kc(39,"Copy"),R.Rb(),R.Rb()}if(2&e){const e=R.gc();R.zb(13),R.mc("value",e.modelName),R.zb(5),R.mc("value",e.modelNo),R.zb(10),R.Lc(e.articleNoDefault),R.zb(1),R.mc("ngModel",e.value),R.zb(5),R.mc("value",e.artProcess)}}function Ci(e,t){if(1&e){const e=R.Tb();R.Sb(0,"div",39),R.Sb(1,"h4",40),R.Nb(2,"i",41),R.Kc(3," Clone BPFC "),R.Rb(),R.Sb(4,"button",42),R.cc("click",function(){return t.$implicit.dismiss("Cross click")}),R.Sb(5,"span",43),R.Kc(6,"\xd7"),R.Rb(),R.Rb(),R.Rb(),R.Sb(7,"div",44),R.Sb(8,"div",4),R.Sb(9,"div",5),R.Sb(10,"div",46),R.Sb(11,"label",47),R.Kc(12,"Model Name"),R.Rb(),R.Nb(13,"input",53),R.Rb(),R.Rb(),R.Sb(14,"div",5),R.Sb(15,"div",46),R.Sb(16,"label",47),R.Kc(17,"Model NO"),R.Rb(),R.Nb(18,"input",53),R.Rb(),R.Rb(),R.Sb(19,"div",5),R.Sb(20,"div",46),R.Sb(21,"label",47),R.Kc(22,"Article NO"),R.Rb(),R.Sb(23,"span",54),R.Kc(24,"(*)"),R.Rb(),R.Sb(25,"ejs-dropdownlist",61,62),R.cc("open",function(){return R.Bc(e),R.gc().openPopupDropdownlist()})("ngModelChange",function(t){return R.Bc(e),R.gc().articleNoID=t})("filtering",function(t){return R.Bc(e),R.gc().onFilteringArticleNO(t)})("select",function(t){return R.Bc(e),R.gc().onChangeArticleNo(t)}),R.Rb(),R.Rb(),R.Rb(),R.Sb(27,"div",5),R.Sb(28,"div",46),R.Sb(29,"label",47),R.Kc(30,"Process"),R.Rb(),R.Nb(31,"input",53),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Sb(32,"div",50),R.Sb(33,"button",59),R.cc("click",function(){return t.$implicit.close("Close click")}),R.Kc(34,"Close"),R.Rb(),R.Sb(35,"button",60),R.cc("click",function(){return R.Bc(e),R.gc().onClickClone()}),R.Kc(36,"Copy"),R.Rb(),R.Rb()}if(2&e){const e=R.gc();R.zb(13),R.mc("value",e.modelName),R.zb(5),R.mc("value",e.modelNo),R.zb(7),R.mc("dataSource",e.articleNosData)("fields",e.fieldsBPFCs)("allowFiltering",!0)("ngModel",e.articleNoID),R.zb(6),R.mc("value",e.artProcess)}}new b.e({Accept:"application/json"});let vi=(()=>{class e extends ni.a{constructor(e,t,i,n,s,l,a,o,r,c,d,h){super(),this.modalNameService=e,this.alertify=t,this.userService=i,this.bPFCEstablishService=n,this.modalService=s,this.router=l,this.datePipe=a,this.spinner=o,this.articleNoService=r,this.dataService=c,this.http=d,this.route=h,this.pageSettings={pageCount:20,pageSizes:[50,100,150,200,"All"],pageSize:50},this.modelName=null,this.modelNo=null,this.articleNo=null,this.articleNoNew=null,this.articleNoDefault=null,this.artProcess=null,this.value=null,this.modelNameID=0,this.modelNoID=0,this.articleNoID=0,this.artProcessID=0,this.BPFCID=0,this.baseUrl=A.a.apiUrlEC,this.textSearch=null,this.textSearchs=null,this.fieldsBPFCs={text:"name",value:"id"},this.sortSettings={columns:[{field:"articleNo",direction:"Ascending"}]},this.subscriptions=new si.a,this.checkCode=!1,this.styleBtn={background:"#6c757d",boxShadow:"0 0 0 3px rgba(130, 138, 145, 0.5)",border:"1px solid #6c757d",margin:"0",borderColor:"#6c757d",borderRadius:"4px",color:"#fff"},this.toolbar=["Search",{text:"Undone",tooltipText:"Undone",prefixIcon:"fa fa-remove",id:"Undone"},{text:"Done",tooltipText:"Done",prefixIcon:"fa fa-check",id:"Done"},{text:"All",tooltipText:"All",prefixIcon:"fa fa-list",id:"All"},{text:"% of done",tooltipText:"% of done",prefixIcon:"",id:"percentageOfDone"}],this.onFilteringArticleNO=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.articleNosData,t)},this.onFilteringModelNOClone=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.modelNOsDataClone,t)}}ngOnInit(){this.Permission(this.route);const e=JSON.parse(localStorage.getItem("level"));this.role=e,this.excelDownloadUrl=A.a.apiUrlEC+"ModelName/ExcelExport",this.filterSettings={type:"Excel"},this.dataText=this.dataService.currentMessages.subscribe(e=>{this.textSearch=e,0!==e&&(this.searchOptions={fields:["modelName","modelNo","articleNo","approvedBy","artProcess"],operator:"contains",key:e||"",ignoreCase:!0})})}ngOnDestroy(){this.dataText.unsubscribe()}Permission(e){const t=e.snapshot.data.functionCode;this.functions=JSON.parse(localStorage.getItem("functions")).filter(e=>e.functionCode===t)||[];for(const i of this.functions){const e=[];for(const n of i.childrens){const t=this.makeAction(n.code);e.push(...t.filter(Boolean))}e.push(...this.toolbar);const t=e.filter((e,t,i)=>t===i.indexOf(e));this.toolbarOptions=t}}makeAction(e){switch(e){case li.a.EXCEL_EXPORT:return["ExcelExport"];case li.a.EXCEL_IMPORT:return["Excel Import"];default:return[void 0]}}detail(e){return this.dataService.changeMessage(this.textSearch),this.router.navigate(["/ec/establish/bpfc-schedule/detailv2/"+e.id])}onChangeArticleNo(e){e.isInteracted&&(this.articleNoID=e.itemData.id)}onChangeDueDate(e){this.dueDate=e.value}createdSearch(e){this.getAllUsers();const t=this.gridObj.element,i=document.createElement("span");i.className="e-clear-icon",i.id=t.id+"clear",i.onclick=this.cancelBtnClick.bind(this),t.querySelector(".e-toolbar-item .e-input-group").appendChild(i),this.percentageOfDone=new u.a({cssClass:"e-tbar-btn e-tbtn-txt e-control e-lib",iconCss:""}),this.percentageOfDone.appendTo("#percentageOfDone")}cancelBtnClick(e){this.gridObj.searchSettings.key="",this.gridObj.element.querySelector(".e-input-group.e-search .e-input").value=""}getSearchText(){}getArticleNoByModelNoID(e,t){this.articleNoService.getArticleNoByModelNoID(e).subscribe(e=>{this.articleNosData=e.filter(e=>e.name!==t)})}openPopupDropdownlist(){}onBeforeRender(e,t,i){const n=this.tooltip.filter((e,t)=>t===+i)[0];n.content="Loading...",n.dataBind(),this.bPFCEstablishService.getGlueByBPFCID(t.id).subscribe(e=>{n.content=e.join("<br>"),n.dataBind()})}onClickCloneNewVersion(){null!==this.value&&(this.articleNoNew=this.articleNoDefault+this.value);const e={modelNameID:this.modelNameID,modelNOID:this.modelNoID,articleNOID:this.articleNoID,artProcessID:Number(this.artProcessID),bpfcID:this.BPFCID,name:this.articleNoNew,cloneBy:JSON.parse(localStorage.getItem("user")).user.id};this.cloneNewVersion(e)}cloneNewVersion(e){this.findArticleNo(this.articleNoNew),null!==this.value?this.checkCode?this.modalNameService.cloneBPFC(e).subscribe(e=>{!0===e.status?(this.alertify.success("\u0110\xe3 sao ch\xe9p th\xe0nh c\xf4ng! <br> Copy succeeded!"),this.modalService.dismissAll(),this.getUndone(),this.gridObj.search(this.articleNoNew),this.value=null):(this.alertify.error("The BPFC exists!"),this.value=null)}):(this.alertify.error("The BPFC exists!"),this.value=null):(this.alertify.error("Version can not be Empty!"),this.value=null)}findArticleNo(e){for(const t of this.data){if(t.articleNo===e){this.checkCode=!1;break}this.checkCode=!0}}onClickClone(){const e={modelNameID:this.modelNameID,modelNOID:this.modelNoID,articleNOID:this.articleNoID,artProcessID:Number(this.artProcessID),bpfcID:this.BPFCID,cloneBy:JSON.parse(localStorage.getItem("user")).user.id};this.clone(e)}clone(e){this.modalNameService.clone(e).subscribe(e=>{!0===e.status?(this.alertify.success("\u0110\xe3 sao ch\xe9p th\xe0nh c\xf4ng! <br> Copy succeeded!"),this.getUndone(),this.gridObj.search(this.articleNoNew),this.modalService.dismissAll()):this.alertify.error("The BPFC exists!")})}openModal(e,t){this.modalReference=this.modalService.open(e,{size:"md",backdrop:"static",keyboard:!1}),this.BPFCID=t.id,this.modelName=t.modelName,this.modelNo=t.modelNo,this.articleNo=t.articleNo,this.artProcess=t.artProcess,this.articleNoNew=t.articleNo.split("-")[0]+"-T",this.articleNoDefault=t.articleNo.split("-")[0]+"-T",this.modelNameID=t.modelNameID,this.modelNoID=t.modelNoID,this.articleNoID=0,this.artProcessID="ASY"===t.artProcess?1:2}openModalClone(e,t){this.modalReference=this.modalService.open(e,{size:"md",backdrop:"static",keyboard:!1}),this.BPFCID=t.id,this.modelName=t.modelName,this.modelNo=t.modelNo,this.artProcess=t.artProcess,this.articleNo=t.articleNo,this.modelNameID=t.modelNameID,this.modelNoID=t.modelNoID,this.articleNoID=0,this.getArticleNoByModelNoID(this.modelNoID,t.articleNo),this.artProcessID="ASY"===t.artProcess?1:2}actionBegin(e){if("searching"===e.requestType&&(this.textSearch=e.searchString),"save"===e.requestType){const t={id:e.data.id,season:e.data.season},i=e.previousData.season;(null!==i||""!==i&&i!==e.data.season)&&this.bPFCEstablishService.updateSeason(t).subscribe(()=>{this.alertify.success("Update season successfully"),this.getAllUsers()});const n={id:e.data.id,dueDate:this.dueDate},s=e.previousData.dueDate;"STF"===e.data.artProcess&&this.dueDate.toDateString()!==s&&null!=s&&this.bPFCEstablishService.updateDueDate(n).subscribe(()=>{this.getAllUsers(),this.alertify.success("Update due date successfully")})}}dataBound(e){}toolbarClick(e){switch(e.item.id){case"grid_Excel Import":this.showModal(this.importModal);break;case"Done":this.gridObj.searchSettings.key="",this.getDone();break;case"Undone":this.gridObj.searchSettings.key="",this.getUndone();break;case"All":this.gridObj.searchSettings.key="",this.getAll();break;case"grid_Excel Export":const e=this.data.map(e=>({approvedBy:e.approvedBy,approvalStatus:e.approvalStatus,createdBy:e.createdBy,articleNo:e.articleNo,createdDate:this.datePipe.transform(e.createdDate,"d MMM, yyyy HH:mm"),artProcess:e.artProcess,finishedStatus:!0===e.finishedStatus?"Yes":"No",modelName:e.modelName,modelNo:e.modelNo,season:e.season}));this.gridObj.excelExport({dataSource:e})}}fileProgress(e){this.file=e.target.files[0]}uploadFile(){const e=JSON.parse(localStorage.getItem("user")).user.id;this.bPFCEstablishService.import(this.file,e).subscribe(e=>{this.getAll(),this.modalReference.close(),this.alertify.success("The excel has been imported into system!")})}getAllUsers(){this.userService.getAllUserInfo().subscribe(e=>{this.users=e,this.getUndone()})}delete(e){this.alertify.confirm("Delete BPFC",'Are you sure you want to delete this BPFC "'+e+'" ?',()=>{this.bPFCEstablishService.delete(e).subscribe(e=>{this.alertify.success("Success"),this.getUndone()},e=>{this.alertify.warning(e)})})}rowDB(e){e.data.dueDateStatus&&e.row.classList.add("bgcolor")}editTextOfBtn(){this.undoneBtn=new u.a({cssClass:"e-tbar-btn e-tbtn-txt e-control e-btn e-lib",iconCss:"fa fa-remove",content:this.undoneText}),this.allBtn=new u.a({cssClass:"e-tbar-btn e-tbtn-txt e-control e-btn e-lib",iconCss:"fa fa-list",content:"All"}),this.doneBtn=new u.a({cssClass:"e-tbar-btn e-tbtn-txt e-control e-btn e-lib",iconCss:"fa fa-check",content:this.doneText}),this.doneBtn.appendTo("#Done"),this.allBtn.appendTo("#All"),this.undoneBtn.appendTo("#Undone"),!0===this.isDone?(this.setAttrBtn(this.doneBtn),this.resetAttrBtn(this.undoneBtn),this.resetAttrBtn(this.allBtn)):!1===this.isDone?(this.setAttrBtn(this.undoneBtn),this.resetAttrBtn(this.doneBtn),this.resetAttrBtn(this.allBtn)):(this.setAttrBtn(this.allBtn),this.resetAttrBtn(this.doneBtn),this.resetAttrBtn(this.undoneBtn))}getAll(){this.spinner.show(),this.bPFCEstablishService.getAll().subscribe(e=>{this.data=e.map(e=>{var t;return{id:e.id,modelNameID:e.modelNameID,modelNoID:e.modelNoID,articleNoID:e.articleNoID,artProcessID:e.artProcessID,modelName:e.modelName,modelNo:e.modelNo,createdDate:new Date(e.createdDate),articleNo:e.articleNo,approvalStatus:e.approvalStatus,finishedStatus:e.finishedStatus,dueDate:e.dueDate,dueDateStatus:e.dueDateStatus,approvedBy:null===(t=this.users.filter(t=>t.id===e.approvalBy)[0])||void 0===t?void 0:t.username,createdBy:e.createdBy,artProcess:e.artProcess,season:e.season}}),this.spinner.hide(),this.isDone=null,this.editTextOfBtn()})}getDone(){this.spinner.show(),this.bPFCEstablishService.getDoneBPFC().subscribe(e=>{this.data=e.data.map(e=>{var t;return{id:e.id,modelNameID:e.modelNameID,modelNoID:e.modelNoID,articleNoID:e.articleNoID,artProcessID:e.artProcessID,modelName:e.modelName,modelNo:e.modelNo,createdDate:new Date(e.createdDate),articleNo:e.articleNo,dueDate:e.dueDate,dueDateStatus:e.dueDateStatus,approvalStatus:e.approvalStatus,finishedStatus:e.finishedStatus,approvedBy:null===(t=this.users.filter(t=>t.id===e.approvalBy)[0])||void 0===t?void 0:t.username,createdBy:e.createdBy,artProcess:e.artProcess,season:e.season}}),this.percentageOfDoneData=e.percentageOfDone,this.percentageOfDone.element.innerHTML=this.percentageOfDoneData,this.doneText=`Done (${e.doneTotal})`,this.undoneText=`Undone (${e.undoneTotal})`,this.isDone=!0,this.editTextOfBtn(),this.spinner.hide()})}getUndone(){this.spinner.show(),this.bPFCEstablishService.getUndoneBPFC().subscribe(e=>{this.data=e.data.map(e=>{var t;return{id:e.id,modelNameID:e.modelNameID,modelNoID:e.modelNoID,articleNoID:e.articleNoID,artProcessID:e.artProcessID,modelName:e.modelName,modelNo:e.modelNo,createdDate:new Date(e.createdDate),articleNo:e.articleNo,dueDate:e.dueDate,dueDateStatus:e.dueDateStatus,approvalStatus:e.approvalStatus,finishedStatus:e.finishedStatus,approvedBy:null===(t=this.users.filter(t=>t.id===e.approvalBy)[0])||void 0===t?void 0:t.username,createdBy:e.createdBy,artProcess:e.artProcess,season:e.season}}),this.percentageOfDoneData=e.percentageOfDone,this.percentageOfDone.element.innerHTML=this.percentageOfDoneData,this.doneText=`Done (${e.doneTotal})`,this.undoneText=`Undone (${e.undoneTotal})`,this.isDone=!1,this.editTextOfBtn(),this.spinner.hide()})}showModal(e){this.modalReference=this.modalService.open(e,{size:"xl"})}NO(e){return(this.gridObj.pageSettings.currentPage-1)*this.gridObj.pageSettings.pageSize+Number(e)+1}setAttrBtn(e,t={background:"#6c757d",boxShadow:"0 0 0 3px rgba(130, 138, 145, 0.5)",border:"1px solid #6c757d",margin:"0",borderColor:"#6c757d",borderRadius:"4px",color:"#fff"}){e.element.style.background=t.background,e.element.style.boxShadow=t.boxShadow,e.element.style.border=t.border,e.element.style.margin=t.margin,e.element.style.borderColor=t.borderColor,e.element.style.borderRadius=t.borderRadius,e.element.style.color=t.color}resetAttrBtn(e,t={background:"#f8f9fa",boxShadow:"none",border:"none",margin:"0",borderColor:"#f8f9fa",borderRadius:"none",color:"#495057"}){e.element.style.background=t.background,e.element.style.boxShadow=t.boxShadow,e.element.style.border=t.border,e.element.style.margin=t.margin,e.element.style.borderColor=t.borderColor,e.element.style.borderRadius=t.borderRadius,e.element.style.color=t.color}}return e.\u0275fac=function(t){return new(t||e)(R.Mb(M.a),R.Mb(F.a),R.Mb(ai.a),R.Mb(T.a),R.Mb(c.b),R.Mb(P.c),R.Mb(s.d),R.Mb(a.c),R.Mb(_),R.Mb(E.a),R.Mb(b.b),R.Mb(P.a))},e.\u0275cmp=R.Gb({type:e,selectors:[["app-BPFCSchedule"]],viewQuery:function(e,t){if(1&e&&(R.Qc(ri,!0),R.Gc(ci,!0),R.Qc(di,!0)),2&e){let e;R.xc(e=R.dc())&&(t.gridObj=e.first),R.xc(e=R.dc())&&(t.importModal=e.first),R.xc(e=R.dc())&&(t.tooltip=e)}},features:[R.yb([s.d]),R.wb],decls:37,vars:10,consts:[["type","square-jelly-box","size","medium",3,"fullScreen"],[1,"loading"],[1,"card"],[1,"card-body","p-0"],[1,"row"],[1,"col-md-12"],["id","grid","allowSorting","true","allowResizing","true","allowPaging","true","allowFiltering","true","allowResizing","true","gridLines","Both","showColumnMenu","true",3,"dataSource","pageSettings","filterSettings","sortSettings","editSettings","toolbar","allowExcelExport","searchSettings","rowDataBound","created","dataBound","toolbarClick","actionBegin"],["grid",""],["field","#","isPrimaryKey","true","textAlign","Center","headerText","#","width","40"],["template",""],["field","modelName","isPrimaryKey","true","textAlign","Left","headerText","Model Name"],["field","modelNo","isPrimaryKey","true","textAlign","Center","width","100","headerText","Model NO"],["field","articleNo","isPrimaryKey","true","textAlign","Center","width","150","headerText","Article NO"],["field","artProcess","isPrimaryKey","true","textAlign","Center","width","100","headerText","Process"],["field","dueDate","textAlign","Center","editType","datepickeredit","type","date","format","d MMM, yyyy","width","150","headerText","STF Date"],["editTemplate",""],["field","createdDate","isPrimaryKey","true","type","date","format","d MMM, yyyy HH:mm","headerText","Update Time","textAlign","Center"],["field","approvedBy","isPrimaryKey","true","textAlign","Center","width","150","headerText","Approval By Supervisor"],["field","season","textAlign","Center","width","100","headerText","Season"],["field","","isPrimaryKey","true","textAlign","Center","headerText","-- Option --","width","170",3,"visible"],[1,"card-footer"],["importModal",""],["newVersionModal",""],["cloneModal",""],["position","RightCenter","content","loading...",1,"fix-css",3,"beforeRender"],["tooltip",""],[4,"ngIf","ngIfElse"],["stf",""],["placeholder","Enter date",3,"value","change"],["ejs-button","","cssClass","e-info mr-2","appPermission","","appFunction","BPFC Schedule","appAction","EDIT",3,"click"],[1,"far","fa-edit"],["ejs-button","","appPermission","","appFunction","BPFC Schedule","appAction","CREATE","cssClass","e-primary mr-2",3,"click",4,"ngIf"],["ejs-button","","appPermission","","appFunction","BPFC Schedule","appAction","CLONE","cssClass","e-success mr-2",3,"click",4,"ngIf"],["ejs-button","","cssClass","e-danger","appPermission","","appFunction","BPFC Schedule","appAction","DELETE",3,"click"],[1,"fa","fa-trash"],["ejs-button","","appPermission","","appFunction","BPFC Schedule","appAction","CREATE","cssClass","e-primary mr-2",3,"click"],[1,"fa","fa-plus"],["ejs-button","","appPermission","","appFunction","BPFC Schedule","appAction","CLONE","cssClass","e-success mr-2",3,"click"],[1,"fa","fa-clone"],[1,"modal-header"],[1,"modal-title"],[1,"fas","fa-plus"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"col-md-6"],[1,"form-group"],["for","Name"],[3,"href"],["name","file","type","file",1,"form-control",3,"change"],[1,"modal-footer"],["type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],["type","text","name","","disabled","","required","required","title","",1,"form-control",3,"value"],[2,"color","red"],[1,"input-group","mb-3"],[1,"input-group-prepend"],["id","basic-addon3",1,"input-group-text"],["type","text","id","basic-url","placeholder","Enter Version Ex: 1","aria-describedby","basic-addon3",1,"form-control",3,"ngModel","ngModelChange"],["type","button",1,"btn","btn-light",3,"click"],["type","submit",1,"btn","btn-primary",3,"click"],["placeholder","Select article NO   ",1,"w-100","float-left",3,"dataSource","fields","allowFiltering","ngModel","open","ngModelChange","filtering","select"],["modelNameDropdownlist",""]],template:function(e,t){1&e&&(R.Sb(0,"ngx-spinner",0),R.Sb(1,"p",1),R.Kc(2,"Loading data..."),R.Rb(),R.Rb(),R.Sb(3,"div",2),R.Sb(4,"div",3),R.Sb(5,"div",4),R.Sb(6,"div",5),R.Sb(7,"ejs-grid",6,7),R.cc("rowDataBound",function(e){return t.rowDB(e)})("created",function(e){return t.createdSearch(e)})("dataBound",function(e){return t.dataBound(e)})("toolbarClick",function(e){return t.toolbarClick(e)})("actionBegin",function(e){return t.actionBegin(e)}),R.Sb(9,"e-columns"),R.Sb(10,"e-column",8),R.Ic(11,hi,1,1,"ng-template",null,9,R.Jc),R.Rb(),R.Sb(13,"e-column",10),R.Ic(14,ui,3,1,"ng-template",null,9,R.Jc),R.Rb(),R.Nb(16,"e-column",11),R.Nb(17,"e-column",12),R.Nb(18,"e-column",13),R.Sb(19,"e-column",14),R.Ic(20,gi,2,4,"ng-template",null,9,R.Jc),R.Ic(22,pi,3,2,"ng-template",null,15,R.Jc),R.Rb(),R.Nb(24,"e-column",16),R.Nb(25,"e-column",17),R.Nb(26,"e-column",18),R.Sb(27,"e-column",19),R.Ic(28,Di,6,2,"ng-template",null,9,R.Jc),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Nb(30,"div",20),R.Rb(),R.Ic(31,Si,22,1,"ng-template",null,21,R.Jc),R.Ic(33,Ni,40,5,"ng-template",null,22,R.Jc),R.Ic(35,Ci,37,7,"ng-template",null,23,R.Jc)),2&e&&(R.mc("fullScreen",!0),R.zb(7),R.mc("dataSource",t.data)("pageSettings",t.pageSettings)("filterSettings",t.filterSettings)("sortSettings",t.sortSettings)("editSettings",t.editSettings)("toolbar",t.toolbarOptions)("allowExcelExport",!0)("searchSettings",t.searchOptions),R.zb(20),R.mc("visible",!0))},directives:[a.a,S.j,h.d,v.d,v.b,S.e,S.b,h.c,v.c,v.a,S.d,S.a,I.b,s.m,g.a,u.b,oi.a,l.b,l.g,l.j,r.c],pipes:[s.d],styles:[".active-btn[_ngcontent-%COMP%]{background-color:rgba(0,0,0,.45098039215686275)!important;color:#fff!important}.bgcolor[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#fa7c7c}"]}),e})();new b.e({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")});let yi=(()=>{class e{constructor(e){this.http=e,this.baseUrl=A.a.apiUrlEC,this.messageSource=new K.a(0),this.currentMessage=this.messageSource.asObservable()}changeMessage(e){this.messageSource.next(e)}getAllComments(){return this.http.get(this.baseUrl+"Comment/GetAll",{})}getAllCommentByBPFCEstablishID(e){return this.http.get(`${this.baseUrl}Comment/GetAllCommentByBPFCEstablishID/${e}`,{})}create(e){return this.http.post(this.baseUrl+"Comment/Create",e)}update(e){return this.http.put(this.baseUrl+"Comment/Update",e)}delete(e){return this.http.delete(this.baseUrl+"Comment/Delete/"+e)}}return e.\u0275fac=function(t){return new(t||e)(R.Zb(b.b))},e.\u0275prov=R.Ib({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Bi=i("7FIR");const wi=["gridModel"];function Pi(e,t){if(1&e&&R.Kc(0),2&e){const e=t.$implicit,i=R.gc();R.Mc(" ",i.no(e)," ")}}function xi(e,t){1&e&&(R.Kc(0),R.hc(1,"translate")),2&e&&R.Mc(" ",R.ic(1,1,"CREATED_DATETIME_LABEL")," ")}function Ai(e,t){1&e&&(R.Kc(0),R.hc(1,"translate")),2&e&&R.Mc(" ",R.ic(1,1,"PIC_LABEL")," ")}function Ri(e,t){1&e&&(R.Kc(0),R.hc(1,"translate")),2&e&&R.Mc(" ",R.ic(1,1,"FINISH_LABEL")," ")}function Mi(e,t){1&e&&(R.Sb(0,"span",21),R.Kc(1,"YES"),R.Rb())}function Fi(e,t){1&e&&(R.Sb(0,"span",22),R.Kc(1,"No"),R.Rb())}function ki(e,t){if(1&e&&(R.Ic(0,Mi,2,0,"span",19),R.Ic(1,Fi,2,0,"span",20)),2&e){const e=t.$implicit;R.mc("ngIf",1==e.finishedStatus),R.zb(1),R.mc("ngIf",0==e.finishedStatus)}}function Ti(e,t){1&e&&(R.Kc(0),R.hc(1,"translate")),2&e&&R.Mc(" ",R.ic(1,1,"APPROVAL_STATUS_LABEL")," ")}function Ei(e,t){1&e&&(R.Sb(0,"span",22),R.Kc(1,"YET"),R.Rb())}function Gi(e,t){1&e&&(R.Sb(0,"span",24),R.Kc(1,"NG"),R.Rb())}function $i(e,t){1&e&&(R.Sb(0,"span",21),R.Kc(1,"OK"),R.Rb())}function Oi(e,t){if(1&e&&(R.Ic(0,Ei,2,0,"span",20),R.Ic(1,Gi,2,0,"span",23),R.Ic(2,$i,2,0,"span",19)),2&e){const e=t.$implicit;R.mc("ngIf",0==e.approvalStatus&&"#N/A"===e.approvalBy),R.zb(1),R.mc("ngIf",0==e.finishedStatus&&0==e.approvalStatus&&"#N/A"!==e.approvalBy),R.zb(1),R.mc("ngIf",1==e.approvalStatus&&"#N/A"!==e.approvalBy)}}function Ki(e,t){1&e&&(R.Kc(0),R.hc(1,"translate")),2&e&&R.Mc(" ",R.ic(1,1,"APPROVAL_BY_LABEL")," ")}function Li(e,t){1&e&&(R.Kc(0),R.hc(1,"translate")),2&e&&R.Mc(" ",R.ic(1,1,"DETAIL_LABEL")," ")}function Ui(e,t){if(1&e){const e=R.Tb();R.Sb(0,"button",25),R.cc("click",function(){R.Bc(e);const i=t.$implicit,n=R.gc(),s=R.yc(38);return n.openModalDetail(s,i.id)}),R.Nb(1,"i",26),R.Rb()}}function Ji(e,t){if(1&e&&(R.Sb(0,"div",63),R.Kc(1),R.Rb()),2&e){const e=t.$implicit;R.nc("title",e.name),R.zb(1),R.Mc(" ",e.name," ")}}function zi(e,t){1&e&&(R.Sb(0,"div"),R.Nb(1,"i",64),R.Rb())}function ji(e,t){if(1&e&&(R.Sb(0,"span"),R.Kc(1),R.Rb()),2&e){const e=t.$implicit;R.zb(1),R.Mc("\xb1 ",e.allow,"")}}function Hi(e,t){if(1&e&&(R.Sb(0,"li",65),R.Sb(1,"a",66),R.Nb(2,"img",67),R.Rb(),R.Sb(3,"div",68),R.Sb(4,"span",69),R.Sb(5,"small",70),R.Kc(6),R.Rb(),R.Rb(),R.Sb(7,"strong",71),R.Kc(8),R.Rb(),R.Sb(9,"p"),R.Kc(10),R.Rb(),R.Rb(),R.Rb()),2&e){const e=t.$implicit,i=R.gc(2);R.zb(6),R.Mc(" ",i.datetime(e.createdDate),""),R.zb(2),R.Mc(" ",i.username(e.createdBy),""),R.zb(2),R.Mc(" ",e.content," ")}}function _i(e,t){if(1&e){const e=R.Tb();R.Sb(0,"div",27),R.Sb(1,"h4",28),R.Nb(2,"i",29),R.Kc(3," BPFC Detail "),R.Rb(),R.Sb(4,"button",30),R.cc("click",function(){return t.$implicit.dismiss("Cross click")}),R.Sb(5,"span",31),R.Kc(6,"\xd7"),R.Rb(),R.Rb(),R.Rb(),R.Sb(7,"div",32),R.Sb(8,"div",0),R.Sb(9,"div",33),R.Sb(10,"ejs-grid",34,35),R.cc("rowSelected",function(t){return R.Bc(e),R.gc().rowSelected(t)}),R.Sb(12,"e-columns"),R.Sb(13,"e-column",36),R.Ic(14,Ji,2,2,"ng-template",null,6,R.Jc),R.Rb(),R.Nb(16,"e-column",37),R.Nb(17,"e-column",38),R.Nb(18,"e-column",39),R.Nb(19,"e-column",40),R.Nb(20,"e-column",41),R.Nb(21,"e-column",42),R.Rb(),R.Rb(),R.Rb(),R.Sb(22,"div",33),R.Sb(23,"ejs-grid",43,44),R.Sb(25,"e-columns"),R.Nb(26,"e-column",45),R.Nb(27,"e-column",46),R.Nb(28,"e-column",47),R.Sb(29,"e-column",48),R.Ic(30,zi,2,0,"ng-template",null,12,R.Jc),R.Ic(32,ji,2,1,"ng-template",null,6,R.Jc),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Sb(34,"div",49),R.Sb(35,"button",50),R.cc("click",function(){return R.Bc(e),R.gc().release()}),R.Kc(36,"Release"),R.Rb(),R.Sb(37,"button",51),R.cc("click",function(){return R.Bc(e),R.gc().reject()}),R.Kc(38,"Reject"),R.Rb(),R.Sb(39,"button",52),R.cc("click",function(){return t.$implicit.close("Close click")}),R.Kc(40,"Close"),R.Rb(),R.Rb(),R.Sb(41,"div",32),R.Sb(42,"div",0),R.Sb(43,"div",1),R.Sb(44,"div",53),R.Sb(45,"div",54),R.Sb(46,"div",55),R.Sb(47,"div",56),R.Sb(48,"div",57),R.Sb(49,"textarea",58),R.cc("ngModelChange",function(t){return R.Bc(e),R.gc().content=t}),R.Rb(),R.Nb(50,"br"),R.Sb(51,"button",59),R.cc("click",function(){return R.Bc(e),R.gc().createComment()}),R.Kc(52,"Post"),R.Rb(),R.Nb(53,"div",60),R.Nb(54,"hr"),R.Sb(55,"ul",61),R.Ic(56,Hi,11,3,"li",62),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Rb()}if(2&e){const e=R.gc();R.zb(10),R.mc("dataSource",e.glues)("selectedRowIndex",0),R.zb(13),R.mc("dataSource",e.ingredients)("allowSorting",!0),R.zb(26),R.mc("ngModel",e.content),R.zb(7),R.mc("ngForOf",e.comments)}}let Qi=(()=>{class e extends ni.a{constructor(e,t,i,n,s,l,a,o,r,c,d){super(),this.modalNameService=e,this.bPFCEstablishService=t,this.modalService=i,this.alertify=n,this.ingredientService=s,this.glueService=l,this.commentService=a,this.calendarsService=o,this.userService=r,this.authService=c,this.route=d,this.users=[],this.searchSettings={hierarchyMode:"Parent"},this.modalname={id:0,name:"",modelNo:"",createdBy:JSON.parse(localStorage.getItem("user")).user.id},this.toolbar=["Default",{text:"Rejected",tooltipText:"Rejected",prefixIcon:"fa fa-times",id:"Rejected"},{text:"Approved",tooltipText:"Approved",prefixIcon:"fa fa-check",id:"Approved"},"All","Search"]}ngOnInit(){this.Permission(this.route),this.pageSettings={pageSizes:!0,currentPage:1,pageSize:10,pageCount:20},this.editparams={params:{popupHeight:"300px"}},this.getAllUsers()}Permission(e){const t=e.snapshot.data.functionCode;this.functions=JSON.parse(localStorage.getItem("functions")).filter(e=>e.functionCode===t)||[];for(const i of this.functions){const e=[];for(const n of i.childrens){const t=this.makeAction(n.code);e.push(...t.filter(Boolean))}e.push(...this.toolbar);const t=e.filter((e,t,i)=>t===i.indexOf(e));this.toolbarOptions=t}}makeAction(e){switch(e){case li.a.EXCEL_EXPORT:return["ExcelExport"];default:return[void 0]}}ngAfterViewInit(){const e=JSON.parse(localStorage.getItem("level"));this.level=e.id,this.getBuilding()}getBuilding(){JSON.parse(localStorage.getItem("user"))}dataBound(){this.gridModel.autoFitColumns()}no(e){return(this.pageSettings.currentPage-1)*this.pageSettings.pageSize+Number(e.index)+1}actionBegin(e){"save"===e.requestType&&(this.modalname.id=e.data.id||0,this.modalname.name=e.data.name,this.modalname.modelNo=e.data.modelNo,e.data.id>0?this.update(this.modalname):this.add(this.modalname)),"delete"===e.requestType&&this.delete(e.data[0].id)}actionComplete(e){"add"===e.requestType&&(e.form.elements.namedItem("name").focus(),e.form.elements.namedItem("id").disabled=!0,e.form.elements.namedItem("tool").disabled=!0)}onDoubleClick(e){this.setFocus=e.column}openaddModalName(e){this.modalReference=this.modalService.open(e)}getAllBPFCStatus(){this.bPFCEstablishService.getAllBPFCStatus().subscribe(e=>{this.data=e.map(e=>({id:e.id,modelNameID:e.modelNameID,modelNoID:e.modelNoID,articleNoID:e.articleNoID,artProcessID:e.artProcessID,modelName:e.modelName,modelNo:e.modelNo,articleNo:e.articleNo,artProcess:e.artProcess,approvalStatus:e.approvalStatus,finishedStatus:e.finishedStatus,approvalBy:this.createdBy(e.approvalBy),createdBy:this.createdBy(e.createdBy),season:e.season,createdDate:e.createdDate,modifiedDate:e.modifiedDate,updateTime:e.updateTime,bpfcName:`${e.modelName} - ${e.modelNo} - ${e.articleNo} - ${e.artProcess}`}))})}filterRejected(){this.bPFCEstablishService.rejectedFilter().subscribe(e=>{this.data=e.map(e=>({id:e.id,modelNameID:e.modelNameID,modelNoID:e.modelNoID,articleNoID:e.articleNoID,artProcessID:e.artProcessID,modelName:e.modelName,modelNo:e.modelNo,articleNo:e.articleNo,artProcess:e.artProcess,approvalStatus:e.approvalStatus,finishedStatus:e.finishedStatus,approvalBy:this.createdBy(e.approvalBy),createdBy:this.createdBy(e.createdBy),season:e.season,createdDate:e.createdDate,modifiedDate:e.modifiedDate,updateTime:e.updateTime,bpfcName:`${e.modelName} - ${e.modelNo} - ${e.articleNo} - ${e.artProcess}`}))})}filterByApprovedStatus(){this.bPFCEstablishService.filterByApprovedStatus().subscribe(e=>{this.data=e.map(e=>({id:e.id,modelNameID:e.modelNameID,modelNoID:e.modelNoID,articleNoID:e.articleNoID,artProcessID:e.artProcessID,modelName:e.modelName,modelNo:e.modelNo,articleNo:e.articleNo,artProcess:e.artProcess,approvalStatus:e.approvalStatus,finishedStatus:e.finishedStatus,approvalBy:this.createdBy(e.approvalBy),createdBy:this.createdBy(e.createdBy),season:e.season,createdDate:e.createdDate,modifiedDate:e.modifiedDate,updateTime:e.updateTime,bpfcName:`${e.modelName} - ${e.modelNo} - ${e.articleNo} - ${e.artProcess}`}))})}filterByFinishedStatus(){this.bPFCEstablishService.filterByFinishedStatus().subscribe(e=>{this.data=e.map(e=>({id:e.id,modelNameID:e.modelNameID,modelNoID:e.modelNoID,articleNoID:e.articleNoID,artProcessID:e.artProcessID,modelName:e.modelName,modelNo:e.modelNo,articleNo:e.articleNo,artProcess:e.artProcess,approvalStatus:e.approvalStatus,finishedStatus:e.finishedStatus,approvalBy:this.createdBy(e.approvalBy),createdBy:this.createdBy(e.createdBy),season:e.season,createdDate:e.createdDate,modifiedDate:e.modifiedDate,updateTime:e.updateTime,bpfcName:`${e.modelName} - ${e.modelNo} - ${e.articleNo} - ${e.artProcess}`}))})}defaultFilter(){this.bPFCEstablishService.defaultFilter().subscribe(e=>{this.data=e.map(e=>({id:e.id,modelNameID:e.modelNameID,modelNoID:e.modelNoID,articleNoID:e.articleNoID,artProcessID:e.artProcessID,modelName:e.modelName,modelNo:e.modelNo,articleNo:e.articleNo,artProcess:e.artProcess,approvalStatus:e.approvalStatus,finishedStatus:e.finishedStatus,approvalBy:this.createdBy(e.approvalBy),createdBy:this.createdBy(e.createdBy),season:e.season,createdDate:e.createdDate,modifiedDate:e.modifiedDate,updateTime:e.updateTime,bpfcName:`${e.modelName} - ${e.modelNo} - ${e.articleNo} - ${e.artProcess}`}))})}filterByNotApprovedStatus(){this.bPFCEstablishService.filterByNotApprovedStatus().subscribe(e=>{this.data=e.map(e=>({id:e.id,modelNameID:e.modelNameID,modelNoID:e.modelNoID,articleNoID:e.articleNoID,artProcessID:e.artProcessID,modelName:e.modelName,modelNo:e.modelNo,articleNo:e.articleNo,artProcess:e.artProcess,approvalStatus:e.approvalStatus,finishedStatus:e.finishedStatus,approvalBy:this.createdBy(e.approvalBy),createdBy:this.createdBy(e.createdBy),season:e.season,createdDate:e.createdDate,modifiedDate:e.modifiedDate,updateTime:e.updateTime,bpfcName:`${e.modelName} - ${e.modelNo} - ${e.articleNo} - ${e.artProcess}`}))})}update(e){this.modalNameService.update(e).subscribe(()=>{this.alertify.success("Update Modal Name Successfully")})}delete(e){this.alertify.confirm("Delete Modal Name",'Are you sure you want to delete this ModalName ID "'+e+'" ?',()=>{this.modalNameService.delete(e).subscribe(()=>{this.getAllBPFCStatus(),this.alertify.success("Modal Name has been deleted")},e=>{this.alertify.error("Failed to delete the Modal Name")})})}add(e){this.modalNameService.create(e).subscribe(()=>{this.alertify.success("Add Modal Name Successfully"),this.getAllBPFCStatus()})}approval(e){const t=JSON.parse(localStorage.getItem("user")).user.id;this.bPFCEstablishService.approval(e,t).subscribe(()=>{this.alertify.success("The model name - model no has been approved!"),this.getAllBPFCStatus()})}done(e){const t=JSON.parse(localStorage.getItem("user")).user.id;this.bPFCEstablishService.done(e,t).subscribe(()=>{this.alertify.success("The model name - model no has been finished!"),this.getAllBPFCStatus()})}release(){const e=JSON.parse(localStorage.getItem("user")).user.id;this.bPFCEstablishService.release(this.BPFCEstablishID,e).subscribe(()=>{this.alertify.success("The model name - model no has been released!"),this.filterByApprovedStatus(),this.modalReferenceDetail.close()})}reject(){const e=JSON.parse(localStorage.getItem("user")).user.id;this.bPFCEstablishService.reject(this.BPFCEstablishID,e).subscribe(e=>{if(!0===e.status){this.alertify.success(e.message),this.filterByNotApprovedStatus(),this.modalReferenceDetail.close();const t=this.users.filter(t=>t.ID===e.userId)[0].Email||"";this.bPFCEstablishService.sendMailForPIC(t).subscribe(()=>{})}else this.alertify.error(e.message)})}openModalDetail(e,t){this.modalReferenceDetail=this.modalService.open(e,{size:"xxl"}),setTimeout(()=>{this.getAllGluesByBPFCID(t)},300),this.BPFCEstablishID=t,this.getComments()}sortBySup(e){this.ingredientService.sortBySup(e,0).subscribe(e=>{this.ingredients=e.list1})}getAllGluesByBPFCID(e){this.glueService.getAllGluesByBPFCID(e).subscribe(e=>{this.glues=e.map(e=>({chemical:e.chemical,code:e.code,consumption:e.consumption,createdBy:this.createdBy(e.createdBy),createdDate:e.createdDate,expiredTime:e.expiredTime,glueID:e.glueID,glueName:e.glueName,id:e.id,ingredients:e.ingredients,materialName:e.materialName,materialNameID:e.materialNameID,modelNameID:e.modelNameID,modelNo:e.modelNo,modelNoID:e.modelNoID,name:e.name,partNameID:e.partNameID,pathName:e.pathName,bpfcName:`${e.modelName} - ${e.modelNo} - ${e.articleNo} - ${e.artProcess}`})),0===this.glues.length?this.glueid=0:(this.glueid=this.glues[0].id,this.sortBySup(this.glueid))})}rowSelected(e){this.sortBySup(e.data.id)}toolbarClick(e){switch(e.item.text){case"Approved":this.filterByApprovedStatus();break;case"Rejected":this.filterRejected();break;case"All":this.getAllBPFCStatus();break;case"Excel Export":this.gridModel.excelExport();break;case"Default":this.defaultFilter()}}getAllUsers(){this.userService.getAllUserInfo().subscribe(e=>{this.users=e,this.defaultFilter()})}createComment(){this.comment={id:0,content:this.content,createdBy:JSON.parse(localStorage.getItem("user")).user.id,createdByName:"",BPFCEstablishID:this.BPFCEstablishID,createdDate:new Date},this.commentService.create(this.comment).subscribe(()=>{this.alertify.success("The comment has been created!"),this.content="",this.getComments()})}updateComment(){this.commentService.update(this.comment).subscribe(()=>{this.alertify.success("The comment has been updated!"),this.getComments()})}deleteComment(){this.commentService.delete(this.comment.id).subscribe(()=>{this.alertify.success("The comment has been deleted!"),this.getComments()})}getComments(){this.commentService.getAllCommentByBPFCEstablishID(this.BPFCEstablishID).subscribe(e=>{this.comments=e})}datetime(e){return this.calendarsService.JSONDateWithTime(e)}username(e){return this.users.filter(t=>t.id===e)[0].username}createdBy(e){if(0===e)return"#N/A";const t=this.users.filter(t=>t.id===e)[0];return void 0!==t?t.username:"#N/A"}}return e.\u0275fac=function(t){return new(t||e)(R.Mb(M.a),R.Mb(T.a),R.Mb(c.b),R.Mb(F.a),R.Mb(Y.a),R.Mb(z.a),R.Mb(yi),R.Mb(Bi.a),R.Mb(ai.a),R.Mb(j.a),R.Mb(P.a))},e.\u0275cmp=R.Gb({type:e,selectors:[["app-bpfc-status"]],viewQuery:function(e,t){if(1&e&&R.Qc(wi,!0),2&e){let e;R.xc(e=R.dc())&&(t.gridModel=e.first)}},features:[R.wb],decls:39,vars:5,consts:[[1,"row"],[1,"col-md-12"],[1,"card"],["allowPaging","true","showColumnMenu","true","allowSorting","true","allowResizing","true","gridLines","Both",3,"searchSettings","toolbar","dataSource","allowExcelExport","pageSettings","dataBound","toolbarClick","actionBegin","recordDoubleClick","actionComplete"],["gridModel",""],["field","","headerText","#","isPrimaryKey","true","width","40","textAlign","Center","isPrimaryKey","true"],["template",""],["field","modelName","isPrimaryKey","true","textAlign","Center","headerText","Model Name","width","130"],["field","modelNo","isPrimaryKey","true","textAlign","Center","headerText","Model No","width","104"],["field","articleNo","isPrimaryKey","true","textAlign","Center","headerText","Article #","width","97"],["field","artProcess","isPrimaryKey","true","textAlign","Center","headerText","Process","width","97"],["field","createdDate","headerText","Created Date Time","type","date","format","dd MMM, yyyy HH:mm","width","155","textAlign","Center"],["headerTemplate",""],["field","createdBy","headerText","PIC","width","90","textAlign","Center"],["field","finishedStatus","isPrimaryKey","true","headerText","Finished","width","130","textAlign","Center"],["field","approvalStatus","isPrimaryKey","true","headerText","Approval Status","width","130","textAlign","Center"],["field","approvalBy","headerText","Approval By","width","100","textAlign","Center"],["field","tool","isPrimaryKey","true","headerText","Detail","width","70","textAlign","Center"],["detailModal",""],["class","badge badge-success",4,"ngIf"],["class","badge badge-danger",4,"ngIf"],[1,"badge","badge-success"],[1,"badge","badge-danger"],["class","badge badge-warning",4,"ngIf"],[1,"badge","badge-warning"],["ejs-button","","cssClass","e-info",3,"click"],[1,"fa","fa-eye"],[1,"modal-header"],[1,"modal-title"],[1,"fas","fa-plus"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"col-md-6"],["showColumnMenu","true","allowSorting","true","allowResizing","true","gridLines","Both","height","250px",3,"dataSource","selectedRowIndex","rowSelected"],["gridglue",""],["field","name","isPrimaryKey","true","headerText","Chemical","textAlign","Center","width","150"],["field","consumption","headerText","Std. Con.(g)","textAlign","Center","width","150"],["field","finishedDate","headerText","Created Date Time","type","date","format","d MMM, yyyy HH:mm","width","150","textAlign","Center"],["field","finishedBy","headerText","PIC","width","100","textAlign","Center"],["field","modelNo","headerText","Kind","textAlign","Center","width","150"],["field","pathName","headerText","Part","textAlign","Center","width","150"],["field","materialName","headerText","Material","textAlign","Center","width","150"],["showColumnMenu","true","allowSorting","true","allowResizing","true","gridLines","Both","height","250px",3,"dataSource","allowSorting"],["grid",""],["field","position","headerText","Item","width","80","textAlign","Center"],["field","name","isPrimaryKey","true","headerText","Name","width","150","textAlign","Center"],["field","percentage","headerText","%","textAlign","Center","width","70"],["field","allow","headerText","Allow (%)","textAlign","Center","width","70"],[1,"modal-footer"],["type","submit","appPermission","","appFunction","BPFC Status","appAction","RELEASE",1,"btn","btn-success",3,"click"],["type","submit","appPermission","","appFunction","BPFC Status","appAction","REJECT",1,"btn","btn-warning",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[1,"row","bootstrap","snippets"],[1,"col-md-12","col-md-offset-2","col-sm-12"],[1,"comment-wrapper"],[1,"panel","panel-info"],[1,"panel-body"],["placeholder","write a comment...","rows","3",1,"form-control",3,"ngModel","ngModelChange"],["type","button","appPermission","","appFunction","BPFC Status","appAction","POST",1,"btn","btn-info","pull-right",3,"click"],[1,"clearfix"],[1,"media-list",2,"padding","0"],["class","media",4,"ngFor","ngForOf"],["data-toggle","tooltip","data-placement","top",3,"title"],[1,"fas","fa-exclamation-circle"],[1,"media"],["href","#",1,"pull-left"],["src","../../../../assets/img/logo-1.png","alt","",1,"img-circle"],[1,"media-body","ml-1"],[1,"text-muted","pull-right"],[1,"text-muted"],[1,"text-success"]],template:function(e,t){1&e&&(R.Sb(0,"div",0),R.Sb(1,"div",1),R.Sb(2,"div",2),R.Sb(3,"ejs-grid",3,4),R.cc("dataBound",function(){return t.dataBound()})("toolbarClick",function(e){return t.toolbarClick(e)})("actionBegin",function(e){return t.actionBegin(e)})("recordDoubleClick",function(e){return t.onDoubleClick(e)})("actionComplete",function(e){return t.actionComplete(e)}),R.Sb(5,"e-columns"),R.Sb(6,"e-column",5),R.Ic(7,Pi,1,1,"ng-template",null,6,R.Jc),R.Rb(),R.Nb(9,"e-column",7),R.Nb(10,"e-column",8),R.Nb(11,"e-column",9),R.Nb(12,"e-column",10),R.Sb(13,"e-column",11),R.Ic(14,xi,2,3,"ng-template",null,12,R.Jc),R.Rb(),R.Sb(16,"e-column",13),R.Ic(17,Ai,2,3,"ng-template",null,12,R.Jc),R.Rb(),R.Sb(19,"e-column",14),R.Ic(20,Ri,2,3,"ng-template",null,12,R.Jc),R.Ic(22,ki,2,2,"ng-template",null,6,R.Jc),R.Rb(),R.Sb(24,"e-column",15),R.Ic(25,Ti,2,3,"ng-template",null,12,R.Jc),R.Ic(27,Oi,3,3,"ng-template",null,6,R.Jc),R.Rb(),R.Sb(29,"e-column",16),R.Ic(30,Ki,2,3,"ng-template",null,12,R.Jc),R.Rb(),R.Sb(32,"e-column",17),R.Ic(33,Li,2,3,"ng-template",null,12,R.Jc),R.Ic(35,Ui,2,0,"ng-template",null,6,R.Jc),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Ic(37,_i,57,6,"ng-template",null,18,R.Jc),R.Rb()),2&e&&(R.zb(3),R.mc("searchSettings",t.searchSettings)("toolbar",t.toolbar)("dataSource",t.data)("allowExcelExport",!0)("pageSettings",t.pageSettings))},directives:[S.j,h.d,v.d,v.b,S.e,S.b,h.c,v.c,v.a,S.d,S.a,s.m,u.b,oi.a,l.b,l.g,l.j,s.l],pipes:[p.c],styles:["body[_ngcontent-%COMP%]{margin-top:20px}.comment-wrapper[_ngcontent-%COMP%]   .panel-body[_ngcontent-%COMP%]{max-height:650px;overflow:auto}.comment-wrapper[_ngcontent-%COMP%]   .media-list[_ngcontent-%COMP%]   .media[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:64px;height:64px;border:2px solid #e5e7e8}.comment-wrapper[_ngcontent-%COMP%]   .media-list[_ngcontent-%COMP%]   .media[_ngcontent-%COMP%]{border-bottom:1px dashed #efefef;margin-bottom:25px}.e-grid[_ngcontent-%COMP%]   td.e-active[_ngcontent-%COMP%]{background:#6597ce!important;color:#000}"]}),e})();const qi=["doneSwitch"],Vi=["approvalSwitch"],Xi=["gridglue"],Yi=["grid2"],Wi=["modelNameDropdownlist"],Zi=["modelNoDropdownlist"],en=["chemicalDropdownlist"],tn=["grid"],nn=["positionDropdownlist"];function sn(e,t){1&e&&(R.Kc(0),R.hc(1,"translate")),2&e&&R.Mc(" ",R.ic(1,1,"GLUE")," ")}function ln(e,t){if(1&e&&(R.Sb(0,"div",31),R.Kc(1),R.Rb()),2&e){const e=t.$implicit;R.nc("title",e.name),R.zb(1),R.Mc(" ",e.name," ")}}function an(e,t){1&e&&(R.Kc(0),R.hc(1,"translate")),2&e&&R.Mc(" ",R.ic(1,1,"CONSUMPTION")," ")}function on(e,t){if(1&e&&(R.Sb(0,"span"),R.Kc(1),R.Rb()),2&e){const e=t.$implicit,i=R.gc(2);R.Bb(i.changeConsumptionColor(e)),R.zb(1),R.Lc(""===e.consumption?"0":e.consumption)}}function rn(e,t){1&e&&(R.Kc(0),R.hc(1,"translate")),2&e&&R.Mc(" ",R.ic(1,1,"EXPIRED_TIME")," ")}function cn(e,t){1&e&&(R.Kc(0),R.hc(1,"translate")),2&e&&R.Mc(" ",R.ic(1,1,"KIND")," ")}function dn(e,t){if(1&e){const e=R.Tb();R.Sb(0,"ejs-dropdownlist",32,33),R.cc("ngModelChange",function(e){return t.$implicit.kindName=e})("select",function(t){return R.Bc(e),R.gc(2).onChangeKindEdit(t)}),R.Rb()}if(2&e){const e=t.$implicit,i=R.gc(2);R.mc("dataSource",i.kinds)("ngModel",e.kindName)("fields",i.fieldsKindEdit)("allowFiltering",!0)}}function hn(e,t){1&e&&(R.Kc(0),R.hc(1,"translate")),2&e&&R.Mc(" ",R.ic(1,1,"PART")," ")}function un(e,t){if(1&e){const e=R.Tb();R.Sb(0,"ejs-dropdownlist",34,33),R.cc("ngModelChange",function(e){return t.$implicit.partName=e})("select",function(t){return R.Bc(e),R.gc(2).onChangePartEdit(t)}),R.Rb()}if(2&e){const e=t.$implicit,i=R.gc(2);R.mc("dataSource",i.parts)("ngModel",e.partName)("fields",i.fieldsPartEdit)("allowFiltering",!0)}}function gn(e,t){1&e&&(R.Kc(0),R.hc(1,"translate")),2&e&&R.Mc(" ",R.ic(1,1,"MATERIAL")," ")}function mn(e,t){if(1&e){const e=R.Tb();R.Sb(0,"ejs-dropdownlist",34,33),R.cc("ngModelChange",function(e){return t.$implicit.materialName=e})("select",function(t){return R.Bc(e),R.gc(2).onChangeMaterialEdit(t)}),R.Rb()}if(2&e){const e=t.$implicit,i=R.gc(2);R.mc("dataSource",i.materials)("ngModel",e.materialName)("fields",i.fieldsMaterialEdit)("allowFiltering",!0)}}function bn(e,t){if(1&e){const e=R.Tb();R.Sb(0,"div",19),R.Sb(1,"ejs-grid",20,21),R.cc("rowDeselected",function(t){return R.Bc(e),R.gc().rowDeselected(t)})("actionBegin",function(t){return R.Bc(e),R.gc().actionBeginGlue(t)})("rowSelected",function(t){return R.Bc(e),R.gc().rowSelected(t)})("created",function(){return R.Bc(e),R.gc().onCreatedGridGlue()})("toolbarClick",function(t){return R.Bc(e),R.gc().toolbarClick(t)})("dataBound",function(){return R.Bc(e),R.gc().dataBoundGlue()}),R.Sb(3,"e-columns"),R.Sb(4,"e-column",22),R.Ic(5,sn,2,3,"ng-template",null,23,R.Jc),R.Ic(7,ln,2,2,"ng-template",null,24,R.Jc),R.Rb(),R.Sb(9,"e-column",25),R.Ic(10,an,2,3,"ng-template",null,23,R.Jc),R.Ic(12,on,2,3,"ng-template",null,24,R.Jc),R.Rb(),R.Sb(14,"e-column",26),R.Ic(15,rn,2,3,"ng-template",null,23,R.Jc),R.Rb(),R.Sb(17,"e-column",27),R.Ic(18,cn,2,3,"ng-template",null,23,R.Jc),R.Ic(20,dn,2,4,"ng-template",null,28,R.Jc),R.Rb(),R.Sb(22,"e-column",29),R.Ic(23,hn,2,3,"ng-template",null,23,R.Jc),R.Ic(25,un,2,4,"ng-template",null,28,R.Jc),R.Rb(),R.Sb(27,"e-column",30),R.Ic(28,gn,2,3,"ng-template",null,23,R.Jc),R.Ic(30,mn,2,4,"ng-template",null,28,R.Jc),R.Rb(),R.Rb(),R.Rb(),R.Rb()}if(2&e){const e=R.gc();R.zb(1),R.mc("dataSource",e.glues)("editSettings",e.editSettings)("toolbar",e.toolbar)("allowSorting",!0)("selectedRowIndex",e.rowIndex)}}function pn(e,t){if(1&e){const e=R.Tb();R.Sb(0,"div",35),R.Sb(1,"button",36),R.Nb(2,"i",37),R.Kc(3," Reset "),R.Rb(),R.Sb(4,"ejs-switch",38,39),R.cc("click",function(){return R.Bc(e),R.gc().done()})("checkedChange",function(t){return R.Bc(e),R.gc().createdStatus=t}),R.hc(6,"translate"),R.hc(7,"translate"),R.Rb(),R.Sb(8,"ejs-switch",40,41),R.cc("click",function(){return R.Bc(e),R.gc().approval()})("checkedChange",function(t){return R.Bc(e),R.gc().approvalStatus=t}),R.hc(10,"translate"),R.Rb(),R.Sb(11,"button",42),R.cc("click",function(){return R.Bc(e),R.gc().finished()}),R.Nb(12,"i",43),R.Kc(13),R.hc(14,"translate"),R.Rb(),R.Sb(15,"button",44),R.cc("click",function(){R.Bc(e);const t=R.gc(),i=R.yc(45);return t.openModalHistory(i)}),R.Nb(16,"i",45),R.Kc(17," History"),R.Rb(),R.Rb()}if(2&e){const e=R.gc();R.zb(4),R.nc("onLabel",R.ic(6,7,"DONE")),R.nc("offLabel",R.ic(7,9,"UNDONE")),R.mc("disabled",e.approvalStatus)("checked",e.createdStatus),R.zb(4),R.nc("offLabel",R.ic(10,11,"NOT_APPROVED")),R.mc("checked",e.approvalStatus),R.zb(5),R.Mc(" ",R.ic(14,13,"FINISHED")," ")}}function fn(e,t){if(1&e&&(R.Sb(0,"li",55),R.Sb(1,"a"),R.Kc(2),R.Sb(3,"span",56),R.Kc(4),R.Rb(),R.Rb(),R.Rb()),2&e){const e=t.$implicit;R.zb(2),R.Nc(" ",e.position,". ",e.ingredientName," "),R.zb(2),R.Mc("(",e.percentage,"%)")}}function In(e,t){if(1&e&&(R.Sb(0,"ul"),R.Sb(1,"span",52),R.Kc(2),R.Rb(),R.Sb(3,"li",53),R.Kc(4),R.Sb(5,"ul"),R.Ic(6,fn,5,3,"li",54),R.Rb(),R.Rb(),R.Rb()),2&e){const e=R.gc(2);R.zb(2),R.Lc(e.formulaTamp()),R.zb(2),R.Mc(" ",e.formula()," "),R.zb(2),R.mc("ngForOf",e.renderchemical())}}function Dn(e,t){if(1&e){const e=R.Tb();R.Sb(0,"button",57),R.cc("click",function(){R.Bc(e);const i=t.$implicit;return R.gc(2).sortBySup(i.id)}),R.Nb(1,"i",58),R.Kc(2),R.Rb()}if(2&e){const e=t.$implicit;R.zb(2),R.Mc(" ",e.name," ")}}function Sn(e,t){1&e&&(R.Kc(0),R.hc(1,"translate")),2&e&&R.Mc(" ",R.ic(1,1,"ITEM")," ")}function Nn(e,t){if(1&e){const e=R.Tb();R.Sb(0,"ejs-dropdownlist",66,67),R.cc("change",function(i){R.Bc(e);const n=t.$implicit;return R.gc(3).onChangePosition(i,n,n.index)}),R.Rb()}if(2&e){const e=t.$implicit,i=R.gc(3);R.mc("dataSource",i.dataPosition)("value",e.position)("fields",i.fieldsPosition)("allowFiltering",!0)}}function Cn(e,t){if(1&e){const e=R.Tb();R.Sb(0,"ejs-dropdownlist",66,67),R.cc("change",function(i){R.Bc(e);const n=t.$implicit;return R.gc(3).onChangePosition(i,n,n.index)}),R.Rb()}if(2&e){const e=t.$implicit,i=R.gc(3);R.mc("dataSource",i.dataPosition)("value",e.position)("fields",i.fieldsPosition)("allowFiltering",!0)}}function vn(e,t){1&e&&(R.Kc(0),R.hc(1,"translate")),2&e&&R.Mc(" ",R.ic(1,1,"INGREDIENT_NAME")," ")}function yn(e,t){1&e&&R.Kc(0),2&e&&R.Mc(" ",t.$implicit.name," ")}function Bn(e,t){1&e&&R.Kc(0),2&e&&R.Mc(" ",t.$implicit.name," ")}function wn(e,t){if(1&e&&(R.Sb(0,"div"),R.Kc(1),R.Rb()),2&e){const e=t.$implicit,i=R.gc(3);R.Bb(i.changePercentageColor(e)),R.zb(1),R.Lc(e.percentage)}}function Pn(e,t){1&e&&(R.Sb(0,"div"),R.Nb(1,"i",68),R.Rb())}function xn(e,t){if(1&e&&(R.Sb(0,"div"),R.Kc(1),R.Rb()),2&e){const e=t.$implicit,i=R.gc(3);R.Bb(i.changeAllowColor(e)),R.zb(1),R.Mc("\xb1 ",e.allow,"")}}function An(e,t){if(1&e){const e=R.Tb();R.Sb(0,"div",59),R.Sb(1,"div",9),R.Sb(2,"div",19),R.Sb(3,"ejs-grid",60,61),R.cc("actionComplete",function(t){return R.Bc(e),R.gc(2).actionCompleteIngredient(t)})("recordDoubleClick",function(t){return R.Bc(e),R.gc(2).onDoubleClickIngredient(t)})("actionBegin",function(t){return R.Bc(e),R.gc(2).actionBeginIngredient(t)})("toolbarClick",function(t){return R.Bc(e),R.gc(2).toolbarClickIngredient(t)})("rowSelected",function(t){return R.Bc(e),R.gc(2).rowSelectedIngredient(t)}),R.Sb(5,"e-columns"),R.Sb(6,"e-column",62),R.Ic(7,Sn,2,3,"ng-template",null,23,R.Jc),R.Ic(9,Nn,2,4,"ng-template",null,24,R.Jc),R.Ic(11,Cn,2,4,"ng-template",null,28,R.Jc),R.Rb(),R.Sb(13,"e-column",63),R.Ic(14,vn,2,3,"ng-template",null,23,R.Jc),R.Ic(16,yn,1,1,"ng-template",null,28,R.Jc),R.Ic(18,Bn,1,1,"ng-template",null,24,R.Jc),R.Rb(),R.Sb(20,"e-column",64),R.Ic(21,wn,2,3,"ng-template",null,24,R.Jc),R.Rb(),R.Sb(23,"e-column",65),R.Ic(24,Pn,2,0,"ng-template",null,23,R.Jc),R.Ic(26,xn,2,3,"ng-template",null,24,R.Jc),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Rb()}if(2&e){const e=t.$implicit,i=R.gc(2);R.zb(3),R.mc("dataSource",e)("allowSorting",!0)("allowSorting",!0)("editSettings",i.editSettings)("toolbar",i.toolbarOptions2)}}function Rn(e,t){if(1&e){const e=R.Tb();R.Sb(0,"div",46),R.Ic(1,In,7,3,"ul",47),R.Sb(2,"div",0),R.Sb(3,"div",48),R.Sb(4,"button",49),R.cc("click",function(){return R.Bc(e),R.gc().sortBySup(0)}),R.Kc(5),R.hc(6,"translate"),R.Rb(),R.Ic(7,Dn,3,1,"button",50),R.Rb(),R.Rb(),R.Sb(8,"div",0),R.Ic(9,An,28,5,"div",51),R.Rb(),R.Rb()}if(2&e){const e=R.gc();R.zb(1),R.mc("ngIf",e.renderchemical().length>0),R.zb(4),R.Mc(" ",R.ic(6,4,"DEFAULT")," "),R.zb(2),R.mc("ngForOf",e.supplier),R.zb(2),R.mc("ngForOf",e.ingredientGroupData)}}function Mn(e,t){if(1&e){const e=R.Tb();R.Sb(0,"div",69),R.Sb(1,"h4",70),R.Nb(2,"i",71),R.Kc(3," Clone Article "),R.Rb(),R.Sb(4,"button",72),R.cc("click",function(){return t.$implicit.dismiss("Cross click")}),R.Sb(5,"span",73),R.Kc(6,"\xd7"),R.Rb(),R.Rb(),R.Rb(),R.Sb(7,"div",74),R.Sb(8,"div",0),R.Sb(9,"div",75),R.Sb(10,"div",76),R.Sb(11,"label",77),R.Kc(12,"Article Name"),R.Rb(),R.Sb(13,"span",78),R.Kc(14,"(*)"),R.Rb(),R.Sb(15,"input",79),R.cc("ngModelChange",function(t){return R.Bc(e),R.gc().articleName=t}),R.Rb(),R.Rb(),R.Rb(),R.Sb(16,"div",75),R.Sb(17,"div",76),R.Sb(18,"label",77),R.Kc(19,"Process"),R.Rb(),R.Sb(20,"ejs-dropdownlist",80,81),R.cc("change",function(t){return R.Bc(e),R.gc().onChangeProcessCloneModal(t)}),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Sb(22,"div",82),R.Sb(23,"button",83),R.cc("click",function(){return t.$implicit.close("Close click")}),R.Kc(24,"Close"),R.Rb(),R.Sb(25,"button",84),R.cc("click",function(){return R.Bc(e),R.gc().cloneArticleModelname()}),R.Kc(26,"Clone"),R.Rb(),R.Rb()}if(2&e){const e=R.gc();R.zb(15),R.mc("ngModel",e.articleName),R.zb(5),R.mc("value",e.valueProcess)("dataSource",e.processData)("allowFiltering",!0)("fields",e.processfields)}}function Fn(e,t){1&e&&(R.Kc(0),R.hc(1,"date")),2&e&&R.Mc(" ",R.jc(1,1,t.$implicit.createdTime,"yyyy-MM-dd , hh:mm:ss a")," ")}function kn(e,t){if(1&e&&(R.Qb(0),R.Nb(1,"input",97),R.Pb()),2&e){const e=R.gc().$implicit;R.zb(1),R.mc("value",e.remark)}}function Tn(e,t){if(1&e&&R.Nb(0,"input",98),2&e){const e=R.gc().$implicit;R.mc("value",e.remark)}}function En(e,t){if(1&e&&(R.Sb(0,"span",94),R.Ic(1,kn,2,1,"ng-container",95),R.Ic(2,Tn,1,1,"ng-template",null,96,R.Jc),R.Rb()),2&e){const e=t.$implicit,i=R.yc(3);R.mc("ngClass","Improve"==e.action?"e-input-group e-control-wrapper e-valid-input":"e-input-group e-control-wrapper e-valid-input e-disabled"),R.zb(1),R.mc("ngIf","Improve"==e.action)("ngIfElse",i)}}function Gn(e,t){if(1&e){const e=R.Tb();R.Sb(0,"div",69),R.Sb(1,"h4",70),R.Nb(2,"i",71),R.Kc(3," BPFC History "),R.Rb(),R.Sb(4,"button",72),R.cc("click",function(){return t.$implicit.dismiss("Cross click")}),R.Sb(5,"span",73),R.Kc(6,"\xd7"),R.Rb(),R.Rb(),R.Rb(),R.Sb(7,"div",74),R.Sb(8,"ejs-grid",85,86),R.cc("actionBegin",function(t){return R.Bc(e),R.gc().actionBeginHistory(t)}),R.Sb(10,"e-columns"),R.Sb(11,"e-column",87),R.Ic(12,Fn,2,4,"ng-template",null,24,R.Jc),R.Rb(),R.Nb(14,"e-column",88),R.Nb(15,"e-column",89),R.Nb(16,"e-column",90),R.Sb(17,"e-column",91),R.Ic(18,En,4,3,"ng-template",null,28,R.Jc),R.Rb(),R.Nb(20,"e-column",92),R.Rb(),R.Rb(),R.Rb(),R.Sb(21,"div",82),R.Sb(22,"button",93),R.cc("click",function(){return t.$implicit.close("Close click")}),R.Kc(23,"Close"),R.Rb(),R.Rb()}if(2&e){const e=R.gc();R.zb(8),R.mc("dataSource",e.historyData)("allowSorting",!0)("allowSorting",!0)("editSettings",e.editSettingsHis)("toolbar",e.toolbarOptionsHistory),R.zb(9),R.mc("edit",e.editparamsHis)}}function $n(e,t){if(1&e){const e=R.Tb();R.Sb(0,"div",69),R.Sb(1,"h4",70),R.Nb(2,"i",71),R.Kc(3," Clone BPFC "),R.Rb(),R.Sb(4,"button",72),R.cc("click",function(){return t.$implicit.dismiss("Cross click")}),R.Sb(5,"span",73),R.Kc(6,"\xd7"),R.Rb(),R.Rb(),R.Rb(),R.Sb(7,"div",74),R.Sb(8,"div",0),R.Sb(9,"div",75),R.Sb(10,"div",76),R.Sb(11,"label",77),R.Kc(12,"Model Name"),R.Rb(),R.Sb(13,"span",78),R.Kc(14,"(*)"),R.Rb(),R.Nb(15,"input",6),R.Rb(),R.Rb(),R.Sb(16,"div",75),R.Sb(17,"div",76),R.Sb(18,"label",77),R.Kc(19,"Model NO"),R.Rb(),R.Sb(20,"span",78),R.Kc(21,"(*)"),R.Rb(),R.Nb(22,"input",6),R.Rb(),R.Rb(),R.Sb(23,"div",75),R.Sb(24,"div",76),R.Sb(25,"label",77),R.Kc(26,"Article NO"),R.Rb(),R.Sb(27,"span",78),R.Kc(28,"(*)"),R.Rb(),R.Sb(29,"input",99),R.cc("ngModelChange",function(t){return R.Bc(e),R.gc().articleNoNewLeo=t}),R.Rb(),R.Rb(),R.Rb(),R.Sb(30,"div",75),R.Sb(31,"div",76),R.Sb(32,"label",77),R.Kc(33,"Process"),R.Rb(),R.Sb(34,"span",78),R.Kc(35,"(*)"),R.Rb(),R.Nb(36,"input",6),R.Rb(),R.Rb(),R.Rb(),R.Rb(),R.Sb(37,"div",82),R.Sb(38,"button",83),R.cc("click",function(){return t.$implicit.close("Close click")}),R.Kc(39,"Close"),R.Rb(),R.Sb(40,"button",84),R.cc("click",function(){return R.Bc(e),R.gc().onClickClone()}),R.Kc(41,"Clone"),R.Rb(),R.Rb()}if(2&e){const e=R.gc();R.zb(15),R.mc("value",e.modelNameLeo),R.zb(7),R.mc("value",e.modelNoLeo),R.zb(7),R.mc("ngModel",e.articleNoNewLeo)("value",e.articleNoLeo),R.zb(7),R.mc("value",e.artProcessLeo)}}let On=(()=>{class e{constructor(e,t,i,n,s,l,a,o,r,c,d,h,u,g,m,b,p){this.glueIngredientService=e,this.modalNameService=t,this.glueService=i,this.alertify=n,this.modalService=s,this.route=l,this.authService=a,this.bPFCEstablishService=o,this.modelNoService=r,this.articleNoService=c,this.kindService=d,this.partService=h,this.materialService=u,this.buildingUserService=g,this.artProcessService=m,this.ingredientService=b,this.dataService=p,this.positions=["B","C","D","E"],this.approvalStatus=!1,this.createdStatus=!1,this.role=JSON.parse(localStorage.getItem("user")).user.role,this.isShow=!1,this.selectedRow=[],this.LANG=localStorage.getItem("lang")||"vi",this.glue={id:0,name:"",gluename:"",code:"",createdDate:"",partID:0,kindID:0,materialID:0,BPFCEstablishID:0,consumption:"",expiredTime:0,createdBy:0,glueNameID:0,glueIngredients:[]},this.ingredient={id:0,name:"",code:"",percentage:0,createdDate:new Date,supplierID:0,position:0,allow:0,voc:0,expiredTime:0,daysToExpiration:0,materialNO:"",unit:0,real:0,cbd:0},this.editPercentage={glueID:0,ingredientID:0,percentage:0},this.editAllow={glueID:0,ingredientID:0,allow:0},this.page=1,this.supplier=[],this.toolbarOptions=["Search","Delete"],this.toolbarOptions2=["Search"],this.toolbarOptionsHistory=["Search"],this.selectionOptions={type:"Multiple",mode:"Both"},this.editSettingsHis={allowEditing:!0,mode:"Normal",allowEditOnDblClick:!0},this.detailIngredient=[],this.totalPercentage=0,this.fieldsBPFCs={text:"name",value:"id"},this.fieldsBPFCss={text:"name",value:"id"},this.fieldsGlueChemical={text:"name",value:"name"},this.textGlue="Select Model Name",this.textModelName="Select Model Name - Model #",this.textGlueMaterial="Select ",this.fieldsGlue2={text:"name",value:"id"},this.articleNofields={text:"name",value:"id"},this.processfields={text:"name",value:"id"},this.processData=[{id:1,name:"ASY"},{id:2,name:"STF"}],this.valueProcess=1,this.textGlue2="Select Model No",this.existGlue=!1,this.editparamsHis={params:{format:"n"}},this.dataPosition=[{id:"0",name:""},{id:"1",name:"A"},{id:"2",name:"B"},{id:"3",name:"C"},{id:"4",name:"D"},{id:"5",name:"E"}],this.fieldsKindEdit={text:"name",value:"name"},this.fieldsPartEdit={text:"name",value:"name"},this.fieldsMaterialEdit={text:"name",value:"name"},this.fieldsGlueEdit={text:"name",value:"name"},this.fieldsChemical={text:"name",value:"name"},this.fieldsPosition={text:"name",value:"name"},this.rowIndex="",this.glueIngredient2={ingredientID:0,percentage:0,glueID:0,position:""},this.history={Action:"Created",BPFCEstablishID:0,GlueID:0,Before:"",BeforeAllow:"",After:"",AfterAllow:"",UserID:0,Remark:""},this.valuess="Badminton",this.modelNameSelect=!1,this.modelNoSelect=!1,this.modelArtSelect=!1,this.modelProcessSelect=!1,this.userData=[],this.modelNameLeo=null,this.modelNoLeo=null,this.articleNoLeo=null,this.articleNoNewLeo=null,this.artProcessLeo=null,this.modelNameIDLeo=0,this.modelNoIDLeo=0,this.articleNoIDLeo=0,this.artProcessIDLeo=0,this.BPFCIDLeo=0,this.textSearch=null,this.ingredientGroupData=[[],[]],this.onFiltering=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.modelNameData,t)},this.onFilteringModelName=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.modelNameData,t)},this.onFilteringModelNO=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.modelNoData,t)},this.onFilteringArticleNO=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.articleNoData,t)},this.onFilteringModelNameClone=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.modelNameData,t)},this.onFilteringModelNOClone=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.modelNoData,t)},this.onFilteringArticleNOClone=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.articleNoData,t)},this.onFilteringArtProcessClone=e=>{let t=new G.h;t=""!==e.text?t.where("name","contains",e.text,!0):t,e.updateData(this.artProcessDataClone,t)},this.dataSearch=this.dataService.currentMessage.subscribe(e=>{this.textSearch=e})}ngOnInit(){this.getModelNames(),this.getAllUsers(),this.modelNameID=0,this.subID=0,this.selIndex=[],this.isAdd=!1,this.existGlue=!1,this.oldDetail=[],this.glueIngredientDetail=[],this.removeLocalStore("details"),this.glueid=0,this.onService(),this.getAllSupllier(),this.GetDetailBPFC(),this.sortOptions={columns:[{field:"item",direction:"Decending"}]},this.editParams={params:{value:""}},0===this.glue.id?(this.showBarCode=!1,this.genaratorGlueCode()):this.showBarCode=!0,this.ingredientService.currentIngredient.subscribe(e=>{200===e&&this.getIngredients()}),this.pageSettings={pageSize:12},this.paginationI={currentPage:1,itemsPerPage:10,totalItems:0,totalPages:0},this.editSettings={showDeleteConfirmDialog:!1,allowEditing:!0,allowAdding:!0,allowDeleting:!0,mode:"Normal"},this.toolbar=[{text:"Add New",tooltipText:"Add new row",prefixIcon:"e-add",id:"AddNew"},"Edit","Delete","Update","Cancel","Search"],this.orderidrules={required:!0,number:!0},this.customeridrules={required:!0},this.freightrules={required:!0},this.editparams={paramss:{popupHeight:"300px"}}}ngOnDestroy(){this.dataService.changeMessages(this.textSearch),this.dataSearch.unsubscribe()}GetDetailBPFC(){this.BPFCID=this.route.snapshot.params.id,this.bPFCEstablishService.getDetailBPFC(this.BPFCID).subscribe(e=>{var t;const i=e[0];this.BPFCIDLeo=i.id,this.modelNameLeo=i.modelName,this.modelNoLeo=i.modelNo,this.articleNoLeo=i.articleNo,this.artProcessLeo=i.artProcess,this.articleNoNewLeo=i.articleNo,this.modelNameID=i.modelNameID,this.modelNoID=i.modelNoID,this.articleNoID=i.articleNoID,this.artProcessIDLeo="ASY"===i.artProcess?1:2,this.modelNameDetail=e[0].modelName,this.modelNameID=e[0].modelNameID,this.modelNoDetail=e[0].modelNo,this.articleNoDetail=e[0].articleNo,this.artProcessDetail=e[0].artProcess,this.modelNameIDClone=e[0].modelNameID,this.value=e[0].modelNameID,this.valuemodelNo=e[0].modelNoID,this.articleNoID=e[0].articleNoID,this.resetLifeCycleBPFC(),this.BPFCID=null===(t=e[0])||void 0===t?void 0:t.id,this.approvalStatus=e[0].approvalStatus,this.createdStatus=e[0].finishedStatus,localStorage.removeItem("details"),this.glue.BPFCEstablishID=this.BPFCID,this.getAllGluesByBPFCID(this.BPFCID),this.getAllPart(),this.getAllKind(),this.getAllMaterial(),this.getAllIngredient(),this.existGlue=!0,this.modified=!0})}onChangeProcessCloneModal(e){e.itemData&&(this.processID=e.itemData.id)}resetLifeCycleBPFC(){this.selIndex=[],this.oldDetail=[],this.glueIngredientDetail=[],this.removeLocalStore("details"),this.removeLocalStore("detailsTamp"),this.ingredients1=[],this.ingredients2=[],this.glues=[],this.BPFCID=0}onCreatedGridGlue(){}ngAfterViewInit(){$('[data-toggle="tooltip"]').tooltip();const e=JSON.parse(localStorage.getItem("level"));this.level=e.id,this.getBuilding()}onChangeKindEdit(e){this.kindEdit=e.value,this.kindID=e.itemData.id}onChangePartEdit(e){this.partEdit=e.value,this.partID=e.itemData.id}onChangeMaterialEdit(e){this.kindEdit=e.value,this.materialID=e.itemData.id}dataBoundGlue(){this.gridglue.selectRows(this.selectedRow.length?this.selectedRow:this.selIndex)}actionBeginGlue(e){"beginEdit"===e.requestType&&(this.chemicalNameEdit=e.rowData.name,this.pathNameEdit=e.rowData.pathName,this.modelNoEdit=e.rowData.modelNo,this.materialNameEdit=e.rowData.materialName,this.glue.consumption=e.rowData.consumption,this.glue.kindID=e.rowData.kindID||null,this.glue.partID=e.rowData.partID||null,this.glue.materialID=e.rowData.materialID||null,this.glue.BPFCEstablishID=e.rowData.bpfcEstablishID,this.glue.name=e.rowData.name,this.glue.expiredTime=this.expiredTime,this.history.Before=""===e.rowData.consumption?"0":"Consumption "+e.rowData.consumption,this.detailGlue=!0),"save"===e.requestType&&(this.glue.id=e.rowData.id||0,this.glue.code=e.data.code||"",this.glue.consumption=e.data.consumption,this.glue.glueNameID=e.data.glueNameID,this.glue.kindID=this.kindID||null,this.glue.partID=this.partID||null,this.glue.materialID=this.materialID||null,this.glue.BPFCEstablishID=this.BPFCID,this.glue.name=this.chemicalNameEdit,this.glue.expiredTime=this.expiredTime,this.history.Action="Consumption",this.history.BPFCEstablishID=this.BPFCID,this.history.GlueID=this.glueid,this.history.After="Consumption "+e.data.consumption,this.history.UserID=JSON.parse(localStorage.getItem("user")).user.id,this.glue.createdBy=JSON.parse(localStorage.getItem("user")).user.id,this.bPFCEstablishService.AddHistoryBPFC(this.history).subscribe(()=>{}),this.saveGlue()),"delete"===e.requestType&&0!==e.data[0].id&&(this.glueid=e.data[0].id,this.history.Action="Delete",this.history.Before=e.data[0].name,this.history.BPFCEstablishID=this.BPFCID,this.history.GlueID=e.data[0].id,this.history.UserID=JSON.parse(localStorage.getItem("user")).user.id,this.bPFCEstablishService.AddHistoryBPFC(this.history).subscribe(()=>{this.glueService.delete(e.data[0].id).subscribe(()=>{this.getAllGluesByBPFCID(this.BPFCID),this.detailGlue=!1,this.removeLocalStore("details"),this.glueIngredientDetail=[],this.oldDetail=[],this.alertify.success("Glue has been deleted")},e=>{this.alertify.error("Failed to delete the Glue")})}))}rowDeselected(e){const t=e.rowIndex,i=this.getLocalStore("details").sort(this.dynamicSort("position"));!1===this.compareArray(this.oldDetail,i)&&!0===e.isInteracted&&this.alertify.valid("C\u1ea3nh b\xe1o!","B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n b\u1ecf qua s\u1ef1 thay \u0111\u1ed5i n\xe0y kh\xf4ng?").then(e=>{if(this.modified=!0,this.gridglue.getSelectedRowIndexes().length){const e=this.gridglue.dataSource[t];e.name=e.chemical.name,this.gridglue.refresh()}}).catch(e=>{this.gridglue.selectRows([t])})}rowSelected(e){e.data[0]&&(this.GlueNameDefault=e.data[0].name);const t=e.data[0]||e.data;this.selIndex=[e.rowIndex],!e.isInteracted&&e.previousRowIndex&&(this.selIndex=[e.previousRowIndex]),e.isInteracted&&void 0!==e.data.name&&this.modified&&this.loadPreview(Number(e.data.id)),!1!==e.isInteracted&&null===e.target||void 0!==t.name&&this.modified&&this.loadPreview(Number(t.id))}onChangePosition(e,t,i){this.modified=!1,this.history.BeforeAllow=this.glueNewName;const n=e.value;let s=this.getLocalStore("details");if(""===e.value);else{if(0!==s.length){let t="";switch(s[s.length-1].position){case"A":t="B";break;case"B":t="C";break;case"C":t="D";break;case"D":t="E"}if(n!==t)return this.alertify.warning("H\xe3y ch\u1ecdn ch\u1ea5t ti\u1ebfp theo l\xe0 "+t,!0),this.grid.toArray().forEach(e=>e.refresh()),void(e.cancel=!0)}if(0===s.filter(t=>t.position===e.value).length&&null!==e.value)if(s=this.getLocalStore("details"),this.percentage=0,this.position=e.value,0!==s.filter(e=>e.ingredientName===t.name&&e.position===t.position).length){const i=s.findIndex(e=>e.ingredientName===t.name);s[i].position=e.value,this.setLocalStore("details",s),this.glueIngredientDetail=this.getLocalStore("details"),this.makeFormula(),this.updateChemicalList(),this.grid.toArray().forEach(e=>e.refresh())}else{s=this.getLocalStore("details");const i={id:0,glueID:this.glueid,ingredientID:t.id,glueName:"",ingredientName:t.name,percentage:this.percentage,position:e.value,createdDate:new Date,allow:0,expiredTime:t.expiredTime};"A"===e.value&&(i.percentage=100,i.expiredTime=t.expiredTime),s.push(i),this.setLocalStore("details",s),this.glueIngredientDetail=this.getLocalStore("details"),this.makeFormula(),this.updateChemicalList(),"A"===e.value&&this.grid.toArray().forEach(e=>e.refresh())}}}recordDoubleClick(e){this.modifiedGlue=!0}toolbarClickIngredient(e){e.item.id.includes("add")&&(e.cancel=!0,this.openIngredientModalComponent())}onDoubleClickIngredient(e){this.setFocus=e.column}rowSelectedIngredient(e){this.ingridientID=e.data.id}genaratorGlueCode(){this.glue.code=this.makeid(8)}makeid(e){let t="";const i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",n=i.length;for(let s=0;s<e;s++)t+=i.charAt(Math.floor(Math.random()*n));return t}compareArray(e,t){return JSON.stringify(e)===JSON.stringify(t)}setLocalStore(e,t){localStorage.removeItem(e);const i=JSON.stringify(t);localStorage.setItem(e,i)}getLocalStore(e){return(JSON.parse(localStorage.getItem(e))||[]).sort(this.dynamicSort("position"))}removeLocalStore(e){localStorage.removeItem(e)}dynamicSort(e){let t=1;return"-"===e[0]&&(t=-1,e=e.substr(1)),(i,n)=>-1===t?n[e].localeCompare(i[e]):i[e].localeCompare(n[e])}checkColorCode(e){return!0===e.approvalStatus&&!0===e.finishedStatus}checkDone(e){return!0===e.approvalStatus&&!0===e.finishedStatus?"Done":"Undone"}checkStatus(e,t){return!0===e&&!0===t?"Done":"Undone"}renderchemical(){return this.glueIngredientDetail=this.glueIngredientDetail||[],this.glueIngredientDetail.sort(this.dynamicSort("position"))}makeFormula(){var e,t;const i=this.getLocalStore("details").filter(e=>"A"===e.position)||[];this.nameGlue=(null===(e=i[0])||void 0===e?void 0:e.ingredientName)||"",this.nameGlues=(null===(t=i[0])||void 0===t?void 0:t.ingredientName)+"^"+this.glueIngredientDetail[0].allow+"%"||!1,this.A=i[0].ingredientName,this.glueIngredientDetail=this.renderchemical(),void 0===this.glueIngredientDetail[1]?this.B="":(this.B=this.glueIngredientDetail[1].percentage+"%"+this.glueIngredientDetail[1].ingredientName,this.BB=this.glueIngredientDetail[1].percentage+"%"+this.glueIngredientDetail[1].ingredientName+"^"+this.glueIngredientDetail[1].allow+"%"),void 0===this.glueIngredientDetail[2]?this.C="":(this.C=this.glueIngredientDetail[2].percentage+"%"+this.glueIngredientDetail[2].ingredientName,this.CC=this.glueIngredientDetail[2].percentage+"%"+this.glueIngredientDetail[2].ingredientName+"^"+this.glueIngredientDetail[2].allow+"%"),void 0===this.glueIngredientDetail[3]?this.D="":(this.D=this.glueIngredientDetail[3].percentage+"%"+this.glueIngredientDetail[3].ingredientName,this.DD=this.glueIngredientDetail[3].percentage+"%"+this.glueIngredientDetail[3].ingredientName+"^"+this.glueIngredientDetail[3].allow+"%"),void 0===this.glueIngredientDetail[4]?this.E="":(this.E=this.glueIngredientDetail[4].percentage+"%"+this.glueIngredientDetail[4].ingredientName,this.EE=this.glueIngredientDetail[4].percentage+"%"+this.glueIngredientDetail[4].ingredientName+"^"+this.glueIngredientDetail[4].allow+"%"),this.glueIngredientDetail.length>0?(this.percentageCount=this.glueIngredientDetail.map(e=>e.percentage),this.percentageCountEdit=this.glueIngredientDetail.map(e=>e),this.totalPercentage=this.percentageCount.reduce((e,t)=>e+t,0)):(this.percentageCount=[],this.percentageCountEdit=[],this.totalPercentage=0);const n=this.gridglue.getSelectedRowIndexes()[0];this.gridglue.getSelectedRowIndexes().length&&(this.gridglue.getSelectedRecords(),this.gridglue.dataSource[n].name=this.formula(),this.gridglue.refresh())}formula(){return this.B&&this.C&&this.D&&this.E?`{[ (${this.nameGlue}+ ${this.B}) + ${this.C} ] + ${this.D}}+ ${this.E}`:this.B&&this.C&&this.D?`[(${this.nameGlue} + ${this.B}) + ${this.C}] + ${this.D}`:this.B&&this.C?`(${this.nameGlue} + ${this.B}) + ${this.C}`:this.B?`${this.nameGlue} + ${this.B}`:""+this.nameGlue}formulaTamp(){return this.BB&&this.CC&&this.DD&&this.EE?(this.glueNewName=`{[ (${this.nameGlues}+ ${this.BB}) + ${this.CC} ] + ${this.DD}}+ ${this.EE}`,`{[ (${this.nameGlues}+ ${this.BB}) + ${this.CC} ] + ${this.DD}}+ ${this.EE}`):this.BB&&this.CC&&this.DD?(this.glueNewName=`[(${this.nameGlues} + ${this.BB}) + ${this.CC}] + ${this.DD}`,`[(${this.nameGlues} + ${this.BB}) + ${this.CC}] + ${this.DD}`):this.BB&&this.CC?(this.glueNewName=`(${this.nameGlues} + ${this.BB}) + ${this.CC}`,`(${this.nameGlues} + ${this.BB}) + ${this.CC}`):this.BB?(this.glueNewName=`${this.nameGlues} + ${this.BB}`,`${this.nameGlues} + ${this.BB}`):""+this.nameGlues}getDetail(e){this.glueIngredientService.getDetail(e).subscribe(e=>{var t,i,n,s;this.glueIngredientDetail=e.glueIngredients,this.setLocalStore("details",this.glueIngredientDetail),this.setLocalStore("detailsTamp",this.glueIngredientDetail),this.glueIngredientDetail=this.renderchemical(),this.oldDetail=this.renderchemical();const l=this.glueIngredientDetail.filter(e=>"A"===e.position)||[];this.nameGlue=(null===(t=l[0])||void 0===t?void 0:t.ingredientName)||"",this.nameGlues=(null===(i=l[0])||void 0===i?void 0:i.ingredientName)+"^"+(null===(n=this.glueIngredientDetail[0])||void 0===n?void 0:n.allow)+"%"||!1,this.A=(null===(s=l[0])||void 0===s?void 0:s.ingredientName)||"",void 0===this.glueIngredientDetail[1]?this.B="":(this.B=this.glueIngredientDetail[1].percentage+"%"+this.glueIngredientDetail[1].ingredientName,this.BB=this.glueIngredientDetail[1].percentage+"%"+this.glueIngredientDetail[1].ingredientName+"^"+this.glueIngredientDetail[1].allow+"%"),void 0===this.glueIngredientDetail[2]?this.C="":(this.C=this.glueIngredientDetail[2].percentage+"%"+this.glueIngredientDetail[2].ingredientName,this.CC=this.glueIngredientDetail[2].percentage+"%"+this.glueIngredientDetail[2].ingredientName+"^"+this.glueIngredientDetail[2].allow+"%"),void 0===this.glueIngredientDetail[3]?this.D="":(this.D=this.glueIngredientDetail[3].percentage+"%"+this.glueIngredientDetail[3].ingredientName,this.DD=this.glueIngredientDetail[3].percentage+"%"+this.glueIngredientDetail[3].ingredientName+"^"+this.glueIngredientDetail[3].allow+"%"),void 0===this.glueIngredientDetail[4]?this.E="":(this.E=this.glueIngredientDetail[4].percentage+"%"+this.glueIngredientDetail[4].ingredientName,this.EE=this.glueIngredientDetail[4].percentage+"%"+this.glueIngredientDetail[4].ingredientName+"^"+this.glueIngredientDetail[4].allow+"%"),this.glueIngredientDetail.length>0?(this.percentageCount=this.glueIngredientDetail.map(e=>e.percentage),this.percentageCount.join("+"),this.percentageCountEdit=this.glueIngredientDetail.map(e=>e),this.totalPercentage=this.percentageCount.reduce((e,t)=>e+t,0)):(this.percentageCount=[],this.percentageCountEdit=[],this.totalPercentage=0)})}updateChemicalList(){const e=this.getLocalStore("details");for(const t of this.ingredientGroupData)for(const i of e){const e=t.findIndex(e=>e.name===i.ingredientName&&e.id===i.ingredientID);-1!==e&&(t[e].position=i.position,t[e].percentage=i.percentage,t[e].allow=i.allow)}}actionBeginIngredient(e){if("beginEdit"===e.requestType){if(null===e.rowData.position)return this.alertify.warning("H\xe3y ch\u1ecdn t\xean tr\u01b0\u1edbc khi ch\u1ec9nh s\u1eeda!",!0),void(e.cancel=!0);if("A"===e.rowData.position)return this.alertify.warning("Kh\xf4ng \u0111\u01b0\u1ee3c ch\u1ec9nh s\u1eeda ch\u1ea5t A!",!0),void(e.cancel=!0);this.editPercentage.glueID=this.glueid,this.editPercentage.ingredientID=e.rowData.id,this.percentageDefault=e.rowData.percentage,this.editAllow.glueID=this.glueid,this.history.BeforeAllow="",this.history.AfterAllow="",this.editAllow.ingredientID=e.rowData.id,this.allowDefault=e.rowData.allow||0}if("save"===e.requestType){const t=e.previousData,i=e.data;this.percentageEdit={percentage:Number(e.data.percentage),id:Number(e.rowData.id)},this.allowEdit={allow:Number(e.data.allow),id:Number(e.rowData.id)},"edit"===e.action&&(this.allowChange=e.data.allow||0,this.percentageChange=e.data.percentage),this.editPercentage.percentage=e.data.percentage,this.editAllow.allow=e.data.allow;const n=t.allow!==i.allow;if(t.percentage!==i.percentage){this.modified=!1;const t=this.getLocalStore("details"),i=t.findIndex(t=>t.ingredientName===e.data.name&&t.ingredientID===e.data.id);if(t[i].percentage=e.data.percentage,this.setLocalStore("details",t),this.updateChemicalsV2(),this.gridglue.getSelectedRecords().length>0){const t=this.gridglue.getSelectedRecords()[0].glueIngredients;if(t.length>0){const i=t.findIndex(t=>t.ingredientID===e.data.id);t[i].percentage=e.data.percentage}}}if(n){const t=this.getLocalStore("details"),i=t.findIndex(t=>t.ingredientName===e.data.name&&t.ingredientID===e.data.id);if(t[i].allow=e.data.allow,this.setLocalStore("details",t),this.modified=!1,this.history.BeforeAllow=this.glueNewName,this.updateChemicalsV2(),this.gridglue.getSelectedRecords().length>0){const t=this.gridglue.getSelectedRecords()[0].glueIngredients;if(t.length>0){const i=t.findIndex(t=>t.ingredientID===e.data.id);t[i].allow=e.data.allow}}}}"delete"===e.requestType&&this.deleteIngredient()}updateGlueIngredient(){}loadPreview(e){this.glueid=Number(e),this.getIngredients(),this.getDetail(this.glueid),this.detailGlue=!0}resolver(){this.route.data.subscribe(e=>{this.glues=e.glues.result,this.paginationG=e.glues.pagination})}onService(){this.ingredientService.currentIngredient.subscribe(e=>{300===e&&(this.getIngredients(),this.updateChemicalList(),this.ingredientService.changeIngredient(0))})}mapGlue(e){1==!e.status?(this.percentage=0,this.mapGlueIngredient({ingredientID:e.id,percentage:this.percentage,glueID:this.glueid})):this.delete(this.glueid,e.id)}getIngredients(){this.glueIngredientService.getIngredients(this.glueid).subscribe(e=>{this.ingredients1=e.result.list1,this.ingredients2=e.result.list2,this.ingredientGroupData=[],this.ingredientGroupData.push(e.result.list1,e.result.list2)},e=>{this.alertify.error(e)})}getGlues(){this.glueService.getAllGlue().subscribe(e=>{this.glues=e},e=>{this.alertify.error(e)})}mapGlueIngredients(e){this.glueIngredientService.mapGlueIngredient(e).subscribe(e=>{void 0===this.subID?(this.sortBySup(0),this.getDetail(this.glueid)):(this.sortBySup(this.subID),this.getDetail(this.glueid))})}mapGlueIngredient(e){this.glueIngredientService.mappGlueIngredient(e).subscribe(e=>{void 0===this.subID?(this.getAllGluesByBPFCID(this.BPFCID),this.sortBySup(0),this.getDetail(this.glueid)):(this.sortBySup(this.subID),this.getDetail(this.glueid),this.getAllGluesByBPFCID(this.BPFCID))})}openIngredientModalComponent(){const e=this.modalService.open(O.a,{size:"md"});e.componentInstance.ingredient=this.ingredient,e.componentInstance.title="Add Ingredient",e.result.then(e=>{},e=>{})}actionCompleteIngredient(e){}openPopupDropdownlist(){$('[data-toggle="tooltip"]').tooltip()}toolbarClick(e){switch(e.item.text){case"Add New":const t=this.getLocalStore("details").sort(this.dynamicSort("position"));if(!1===this.compareArray(this.oldDetail,t)&&t.length>0&&this.oldDetail.length>0)this.alertify.valid("C\u1ea3nh b\xe1o!","B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n b\u1ecf qua nh\u1eefng thay \u0111\u1ed5i n\xe0y?").then(e=>{const t={id:0,name:"1",code:"",gluename:"",createdDate:"",BPFCEstablishID:this.BPFCID,kindID:null,partID:null,materialID:null,consumption:"",expiredTime:0,createdBy:JSON.parse(localStorage.getItem("user")).user.id,glueNameID:0,glueIngredients:[]};this.glue=t,this.saveGlue()}).catch(t=>{e.cancel=!0});else{const e={id:0,name:"1",code:"",gluename:"",createdDate:"",BPFCEstablishID:this.BPFCID,kindID:null,partID:null,materialID:null,consumption:"",expiredTime:0,createdBy:JSON.parse(localStorage.getItem("user")).user.id,glueNameID:0,glueIngredients:[]};this.glue=e,this.saveGlue()}}}openModal(e){this.modalReference=this.modalService.open(e)}openModalHistory(e){this.modalReference=this.modalService.open(e,{size:"xxl"}),this.LoadHistoryBPFC()}LoadHistoryBPFC(){this.bPFCEstablishService.LoadHistoryBPFC(this.BPFCID).subscribe(e=>{this.historyData=e.map(e=>({id:e.id,glueID:e.glueID,createdTime:e.createdTime,bpfcEstablishID:e.bpfcEstablishID,before:e.before,after:e.after,action:e.action,remark:e.remark,userID:e.userID,createdBy:this.createdBy(e.userID)}))})}actionBeginHistory(e){"save"===e.requestType&&this.bPFCEstablishService.UpdateHistoryBPFC({ID:e.data.id,Remark:e.data.remark}).subscribe(e=>{e&&this.alertify.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng!")})}getAllUsers(){this.buildingUserService.getAllUsers(1,1e3).subscribe(e=>{this.userData=e.result})}createdBy(e){if(0===e)return"#N/A";const t=this.userData.filter(t=>t.ID===e)[0];return void 0!==t?t.Username:"#N/A"}cloneModelname(){this.alertify.confirm("Sao ch\xe9p model name!","B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n sao ch\xe9p model name kh\xf4ng?",()=>{this.modalNameService.cloneModelname(this.modelNameID,this.modelNameClone,this.modelNoClone,this.valueProcess).subscribe(e=>{this.alertify.success("the model name has been cloned"),this.modalReference.close(),this.modelNameDropdownlist.hidePopup()})})}cloneArticleModelname(){this.alertify.confirm("Sao ch\xe9p article!","B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n sao ch\xe9p article kh\xf4ng?",()=>{this.modalNameService.cloneArticleModelname(this.modelNameID,this.modelNameClone,this.modelNoClone,this.articleName,this.processID).subscribe(e=>{this.alertify.success("Sao ch\xe9p th\xe0nh c\xf4ng!"),this.modalReference.close(),this.modelNameDropdownlist.hidePopup()})})}delete(e,t){this.glueIngredientService.delete(e,t).subscribe(t=>{this.alertify.success("\u0110\xe3 x\xf3a th\xe0nh c\xf4ng!"),this.getIngredients(),this.getDetail(e)})}deleteGlue(e){this.alertify.confirm("X\xf3a keo",'B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n x\xf3a keo n\xe0y kh\xf4ng "'+e.id+'" ?',()=>{this.glueService.delete(e.id).subscribe(()=>{this.getGlues(),this.alertify.success("\u0110\xe3 x\xf3a th\xe0nh c\xf4ng!")},e=>{this.alertify.error("X\xf3a th\u1ea5t b\u1ea1i r\u1ed3i!")})})}deleteIngridient(e){this.alertify.confirm("X\xf3a ingredient",'B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n x\xf3a ingredient n\xe0y kh\xf4ng "'+e.id+'" ?',()=>{this.ingredientService.delete(e.id).subscribe(()=>{this.getIngredients(),this.alertify.success("\u0110\xe3 x\xf3a th\xe0nh c\xf4ng!")},e=>{this.alertify.error("X\xf3a th\u1ea5t b\u1ea1i r\u1ed3i!")})})}getAllGluesByBPFCID(e){this.glueService.getAllGluesByBPFCID(e).subscribe(e=>{this.glues=e})}getAllGluesByBPFCID2(e){this.glueService.getAllGluesByBPFCID(e).subscribe(e=>{void 0===this.ingredientID?(this.glues=e,e.length>0&&(this.detailGlue=!0)):(this.glueid=e[0].id,this.glueIngredient2.ingredientID=this.ingredientID,this.glueIngredient2.percentage=100,this.glueIngredient2.glueID=this.glueid,this.glueIngredient2.position="A",this.mapGlueIngredient(this.glueIngredient2))})}updateChemicals(){this.ingredientService.sortBySup(this.glueid,this.subID).subscribe(e=>{this.ingredients1=e.list1,this.ingredients2=e.list2;const t=this.getLocalStore("details");for(const i of t){const e=this.ingredients1.findIndex(e=>e.name===i.ingredientName&&e.id===i.ingredientID);-1!==e&&(this.ingredients1[e].position=i.position,this.ingredients1[e].percentage=i.percentage,this.ingredients1[e].allow=i.allow)}for(const i of t){const e=this.ingredients2.findIndex(e=>e.name===i.ingredientName&&e.id===i.ingredientID);-1!==e&&(this.ingredients2[e].position=i.position,this.ingredients2[e].percentage=i.percentage,this.ingredients2[e].allow=i.allow)}this.glueIngredientDetail=t,this.makeFormula()})}updateChemicalsV2(){this.ingredientService.sortBySup(this.glueid,this.subID).subscribe(e=>{const t=e.list1,i=e.list2,n=this.getLocalStore("details");for(const s of n){const e=t.findIndex(e=>e.name===s.ingredientName&&e.id===s.ingredientID);-1!==e&&(t[e].position=s.position,t[e].percentage=s.percentage,t[e].allow=s.allow)}for(const s of n){const e=i.findIndex(e=>e.name===s.ingredientName&&e.id===s.ingredientID);-1!==e&&(i[e].position=s.position,i[e].percentage=s.percentage,i[e].allow=s.allow)}this.ingredientGroupData=[],this.ingredientGroupData.push(t,i),this.glueIngredientDetail=n,this.makeFormula()})}sortBySup(e){0===this.gridglue.getSelectedRowIndexes().length?this.alertify.warning("Please select a glue!",!0):(this.subID=e,this.ingredientService.sortBySup(this.glueid,e).subscribe(t=>{let i=t.list1;const n=t.list2;if(this.ingredientGroupData=[],this.ingredientGroupData.push(i,n),0===e){const e=this.getLocalStore("details");i=e.map(e=>({id:e.ingredientID,name:e.ingredientName,code:"",percentage:e.percentage,createdDate:e.createdDate,supplierID:0,allow:e.allow,position:e.position,expiredTime:e.expiredTime,daysToExpiration:e.daysToExpiration,voc:e.voc,materialNO:e.materialNO,unit:e.unit,real:e.real,cbd:e.cbd})),this.ingredientGroupData=[],this.ingredientGroupData.push(i),this.glueIngredientDetail=e}else this.updateChemicalList()}))}saveGlue(){0===this.glue.id||void 0===this.glue.id?(""===this.glue.code&&this.genaratorGlueCode(),this.createGlue()):this.onChangeChemical?this.updateChemical():this.update(),this.oldDetail=[],localStorage.removeItem("details"),this.glueIngredientDetail=[],this.gridglue.refresh(),this.selectedRow=[0],this.selIndex=[0],this.modified=!0}getBuilding(){JSON.parse(localStorage.getItem("user"))}getAllIngredient(){this.ingredientService.getAllIngredient().subscribe(e=>{this.ingrediented=e})}createGlue(){this.glueService.create(this.glue).subscribe(()=>{this.alertify.success("\u0110\xe3 t\u1ea1o th\xe0nh c\xf4ng!"),this.getAllGluesByBPFCID(this.BPFCID),this.clearGlueForm(),this.genaratorGlueCode(),this.expiredTime=0},e=>{this.alertify.error(e),this.genaratorGlueCode()})}finished(){const e=JSON.parse(localStorage.getItem("user")).user.id;if(0===this.gridglue.getSelectedRowIndexes().length)this.alertify.warning("H\xe3y ch\u1ecdn v\xe0o 1 glue v\xe0 t\u1ea1o c\xf4ng th\u1ee9c sau \u0111\xf3 m\u1edbi b\u1ea5m ho\xe0n th\xe0nh!",!0);else{this.history.BPFCEstablishID=this.BPFCID,this.history.GlueID=this.glueid,this.history.After=this.GlueNameDefault,this.history.AfterAllow=this.glueNewName,this.history.UserID=e,this.bPFCEstablishService.AddHistoryBPFC(this.history).subscribe(()=>{});const t=this.getLocalStore("details"),i=this.gridglue.getSelectedRecords()[0];i.expiredTime=t.filter(e=>"A"===e.position)[0].expiredTime,i.kindID=0===i.kindID?null:i.kindID,i.partID=0===i.partID?null:i.partID,i.materialID=0===i.materialID?null:i.materialID,this.selectedRow=this.gridglue.getSelectedRowIndexes(),this.glueService.update(i).subscribe(e=>{this.alertify.success("Update sucessfully!<br>C\u1eadp nh\u1eadt th\xe0nh c\xf4ng!"),this.getAllGluesByBPFCID(this.BPFCID),this.detailGlue=!0,this.modified=!0}),t.length>0&&(this.mapGlueIngredients(t),this.modified=!0)}}clearGlueForm(){this.glue.gluename="",this.glue.kindID=null,this.glue.partID=null,this.glue.materialID=null,this.glue.consumption="",this.showBarCode=!1}update(){this.glueService.update(this.glue).subscribe(e=>{this.alertify.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng!"),this.getAllGluesByBPFCID(this.BPFCID),this.detailGlue=!1,this.history.Action="Created",this.expiredTime=0})}updateChemical(){this.glueService.updateChemical(this.glue).subscribe(e=>{this.alertify.success("C\u1eadp nh\u1eadt th\xe0nh c\xf4ng!"),this.getAllGluesByBPFCID(this.BPFCID),this.detailGlue=!1,this.onChangeChemical=!1,this.history.Action="Created"})}deleteIngredient(){this.ingredientService.delete(this.ingridientID).subscribe(()=>{const e=this.getLocalStore("details").filter(e=>e.ingredientID!==this.ingridientID);this.setLocalStore("details",e),this.glueIngredientDetail=e,this.getIngredients(),this.makeFormula(),this.alertify.success("\u0110\xe3 x\xf3a th\xe0nh c\xf4ng!")},e=>{this.alertify.error("X\xf3a th\u1ea5t b\u1ea1i r\u1ed3i!")})}approval(){const e=this.gridglue.dataSource;let t=!1,i=!1,n=!1;if(e){for(const l of e){if("STF"===this.artProcessDetail&&null===l.kindID)return this.alertify.warning("Please maintain the kind!<br>\n             Vui l\xf2ng c\xe0i \u0111\u1eb7t kind!<br>\n          <br>\n              ",!0),void(this.approvalStatus=!this.approvalStatus);if(l.glueIngredients.length>0){const e=l.glueIngredients.filter(e=>"A"!==e.position);for(const n of e){if(n.allow<=0&&"A"!==n.position)return t=!1,this.approvalStatus=!this.approvalStatus,void this.alertify.warning(`The allowance of checmical name ${n.ingredient.name} must be greater than 0 <br>\n              M\u1ee9c cho ph\xe9p c\u1ee7a h\xf3a ch\u1ea5t ${n.ingredient.name} ph\u1ea3i l\u1edbn h\u01a1n 0!<br>\n               <label>Glue Name: </label> ${l.name} <br>\n              `,!0);if(n.percentage<=0&&"A"!==n.position)return i=!1,this.approvalStatus=!this.approvalStatus,void this.alertify.warning(`The percentage of checmical name ${n.ingredient.name} must be greater than 0 <br>\n              Ph\u1ea7n tr\u0103m c\u1ee7a h\xf3a ch\u1ea5t ${n.ingredient.name} ph\u1ea3i l\u1edbn h\u01a1n 0!<br>\n               <label>Glue Name: </label> ${l.name} <br>\n              `,!0);t=!0,i=!0}}if(+l.consumption<=0)return n=!1,this.approvalStatus=!this.approvalStatus,void this.alertify.warning(`The consumption of glue name ${l.name} must be greater than 0 <br>\n          M\u1ee9c ti\xeau th\u1ee5 c\u1ee7a keo ${l.name} ph\u1ea3i l\u1edbn h\u01a1n 0! <br>\n          <label>Glue Name: </label> ${l.name} <br>\n          `,!0);n=!0}const s=JSON.parse(localStorage.getItem("user")).user.id;this.bPFCEstablishService.approval(this.BPFCID,s).subscribe(e=>{this.alertify.success("The BPFC has been approved!"),this.createdStatus=this.approvalStatus;const t=this.modelNameDropdownlist.getDataByValue(this.modelNameDropdownlist.value);this.modelNameDropdownlist.valueTemplate=`(${this.checkStatus(this.approvalStatus,this.createdStatus)}) ${t.name}`})}}done(){const e=this.gridglue.dataSource;let t=!1,i=!1,n=!1;if(e){for(const s of e){if("STF"===this.artProcessDetail&&null===s.kindID)return this.alertify.warning("Please maintain the kind for each glue <br>\n             Vui l\xf2ng c\xe0i \u0111\u1eb7t kind cho m\u1ed7i lo\u1ea1i keo!<br>\n          <br>\n              ",!0),void(this.createdStatus=!this.createdStatus);if(s.glueIngredients.length>0){const e=s.glueIngredients.filter(e=>"A"!==e.position);for(const n of e){if(n.allow<=0)return t=!1,this.createdStatus=!this.createdStatus,void this.alertify.warning(`The allow of checmical name ${n.ingredient.name} is greater than 0 <br>\n              M\u1ee9c cho ph\xe9p c\u1ee7a h\xf3a ch\u1ea5t ${n.ingredient.name} ph\u1ea3i l\u1edbn h\u01a1n 0!<br>\n               <label>Glue Name: </label> ${s.name} <br>\n              `,!0);if(n.percentage<=0)return i=!1,this.createdStatus=!this.createdStatus,void this.alertify.warning(`The percentage of checmical name ${n.ingredient.name} is greater than 0 <br>\n              Ph\u1ea7n tr\u0103m c\u1ee7a h\xf3a ch\u1ea5t ${n.ingredient.name} ph\u1ea3i l\u1edbn h\u01a1n 0!<br>\n               <label>Glue Name: </label> ${s.name} <br>\n              `,!0);t=!0,i=!0}0===e.length&&(t=!0,i=!0)}if(+s.consumption<=0)return n=!1,this.createdStatus=!this.createdStatus,void this.alertify.warning(`The consumption of glue name ${s.name} is greater than 0 <br>\n          M\u1ee9c ti\xeau th\u1ee5 c\u1ee7a keo ${s.name} ph\u1ea3i l\u1edbn h\u01a1n 0! <br>\n          <label>Glue Name: </label> ${s.name} <br>\n          `,!0);n=!0}if(t&&i&&n){const e=JSON.parse(localStorage.getItem("user")).user.id;this.bPFCEstablishService.done(this.BPFCID,e).subscribe(e=>{!0===e.status?(this.alertify.success(e.message),this.createdStatus=this.createdStatus):this.alertify.success(e.message)})}}}getModelNames(){this.modalNameService.getAllModalName().subscribe(e=>{this.modelNameData=e.map(e=>({id:e.id,name:e.name}))})}getArticleNoByModelNameID(e){this.articleNoService.getArticleNoByModelNoID(e).subscribe(e=>{this.articleNoData=e})}getModelNoByModelNameID(e){this.modelNoService.getModelNoByModelNameID(e).subscribe(e=>{this.modelNoData=e})}getArtProcessByArticleNoID(e){this.artProcessService.getArtProcessByArticleNoID(e).subscribe(e=>{this.artProcessData=e.map(e=>({id:e.id,name:1===e.processID?"ASY":"STF"}))})}getAllProcess(){this.artProcessService.GetAllProcess().subscribe(e=>{this.artProcessDataClone2=e})}getAllKind(){this.kindService.getAllKind().subscribe(e=>{this.kinds=e})}getAllPart(){this.partService.getAllPart().subscribe(e=>{this.parts=e})}getAllMaterial(){this.materialService.getAllMaterial().subscribe(e=>{this.materials=e})}getIngredientsByGlueID(){this.ingredientService.getIngredientsByGlueID(this.glueid).subscribe(e=>{this.ingredients1=e.list1,this.ingredients2=e.list2})}getAllSupllier(){this.ingredientService.getAllSupplier().subscribe(e=>{this.supplier=e})}getArticleNoByModelNoID(e){this.articleNoService.getArticleNoByModelNoID(e).subscribe(e=>{this.articleNosData=e})}getBPFCID(e){this.bPFCEstablishService.getBPFCID(e).subscribe(e=>{this.resetLifeCycleBPFC(),this.BPFCID=null==e?void 0:e.id,this.approvalStatus=e.approvalStatus,this.createdStatus=e.finishedStatus,this.glue.BPFCEstablishID=this.BPFCID,this.getAllGluesByBPFCID(this.BPFCID),this.getAllPart(),this.getAllKind(),this.getAllMaterial(),this.getAllIngredient(),this.existGlue=!0,this.modified=!0})}OndataBound(e){}getModelNamesClone(){this.modalNameService.getAllModalName().subscribe(e=>{this.modelNameDataClone=e.map(e=>({id:e.id,name:e.name})),this.getModelNoByModelNameIDClone(this.modelNameIDClone),this.articleNosDataClone=[],this.artProcessDataClone=[]})}getArticleNoByModelNameIDClone(e){this.articleNoService.getArticleNoByModelNoID(e).subscribe(e=>{this.articleNosDataClone=e})}getModelNoByModelNameIDClone(e){this.modelNoService.getModelNoByModelNameID(e).subscribe(e=>{this.modelNOsDataClone=e}),this.getArticleNoByModelNameIDClone(this.valuemodelNo)}getArtProcessByArticleNoIDClone(e){this.artProcessService.getArtProcessByArticleNoID(e).subscribe(e=>{this.artProcessDataClone=e.map(e=>({id:e.id,name:1===e.ProcessID?"ASY":"STF"}))})}onChangeModelName(e){this.resetLifeCycleBPFC(),this.modelNameID=e.value,this.getModelNoByModelNameID(this.modelNameID),this.existGlue=!1,this.modelNameIDClone=e.value,this.value=e.value,this.valuemodelNo=0,this.modified=!1,this.modelNoData=[],this.articleNosData=[],this.artProcessData=[],this.modelNameSelect=!0,this.modelNoSelect=!1,this.modelArtSelect=!1,this.modelProcessSelect=!1}onChangeModelNo(e){e.isInteracted&&(this.modelNoID=e.value,this.valuemodelNo=e.value,this.getArticleNoByModelNoID(this.modelNoID),this.existGlue=!1,this.modified=!1,this.articleNosData=[],this.artProcessData=[],this.modelNoSelect=!0)}onChangeArticleNo(e){e.isInteracted&&(this.articleNoID=e.value,this.getArtProcessByArticleNoID(this.articleNoID),this.existGlue=!1,this.modified=!1,this.modelArtSelect=!0,this.artProcessData=[])}onClickProcess(e){this.modelProcessSelect=!0,e.target.defaultValue&&(this.artProcessID=Number(e.target.defaultValue))}ClickProcessData(e){}clearFormClone(){this.modelNameIDClone=this.value,this.modelNOIDClone=this.valuemodelNo,this.articleNOIDClone=0,this.artProcessIDClone=0,this.articleNosDataClone=[],this.artProcessDataClone=[],this.artProcessDataClone2=[]}onClickClone(){const e={modelNameID:this.modelNameIDLeo,modelNOID:this.modelNoIDLeo,articleNOID:this.articleNoIDLeo,artProcessID:Number(this.artProcessIDLeo),bpfcID:this.BPFCIDLeo,name:this.articleNoNewLeo,cloneBy:JSON.parse(localStorage.getItem("user")).user.id};this.clone(e)}clone(e){this.articleNoNewLeo!==this.articleNoLeo?this.modalNameService.cloneBPFC(e).subscribe(e=>{!0===e.status?(this.alertify.success("\u0110\xe3 sao ch\xe9p th\xe0nh c\xf4ng!"),this.modalService.dismissAll(),this.getAllUsers()):this.alertify.error("The BPFC exists!")}):this.alertify.error("The BPFC exists!")}onChangeModelNameClone(e){this.value!==e.value&&(this.modelNOsDataClone=[],this.modelNameIDClone=e.value,this.getModelNoByModelNameIDClone(this.modelNameIDClone)),this.modelNameIDClone=e.value,this.getModelNoByModelNameIDClone(this.modelNameIDClone)}onChangeModelNoClone(e){this.modelNOIDClone=e.value,null!==this.modelNOIDClone&&this.getArticleNoByModelNameIDClone(this.modelNOIDClone),this.articleNosDataClone=[],this.artProcessDataClone=[]}onChangeArticleNoClone(e){e.isInteracted&&(this.articleNOIDClone=e.value,this.getArtProcessByArticleNoIDClone(this.articleNOIDClone))}onChangeProcessClone(e){e.isInteracted&&(this.artProcessIDClone=e.value)}changeAllowColor(e){return null===e.position?"":this.positions.includes(e.position)&&0===e.allow||this.positions.includes(e.position)&&null===e.allow?"font-weight-bold text-white p-2 rounded-circle warning-text":void 0}changePercentageColor(e){return null===e.percentage?"":this.positions.includes(e.position)&&0===e.percentage?"font-weight-bold text-white p-2 rounded-circle warning-text":void 0}changeConsumptionColor(e){return 0===e.glueIngredients.length?"":""===e.consumption?"font-weight-bold text-white p-2 rounded-circle warning-text":void 0}}return e.\u0275fac=function(t){return new(t||e)(R.Mb(J),R.Mb(M.a),R.Mb(z.a),R.Mb(F.a),R.Mb(c.b),R.Mb(P.a),R.Mb(j.a),R.Mb(T.a),R.Mb(H),R.Mb(_),R.Mb(Q.a),R.Mb(q.a),R.Mb(V.a),R.Mb(k.a),R.Mb(X),R.Mb(Y.a),R.Mb(E.a))},e.\u0275cmp=R.Gb({type:e,selectors:[["app-bpfc-detailv2"]],viewQuery:function(e,t){if(1&e&&(R.Qc(qi,!0),R.Qc(Vi,!0),R.Qc(Xi,!0),R.Qc(Yi,!0),R.Qc(Wi,!0),R.Qc(Zi,!0),R.Qc(en,!0),R.Qc(tn,!0),R.Qc(nn,!0)),2&e){let e;R.xc(e=R.dc())&&(t.doneSwitch=e.first),R.xc(e=R.dc())&&(t.approvalSwitch=e.first),R.xc(e=R.dc())&&(t.gridglue=e.first),R.xc(e=R.dc())&&(t.grid2=e.first),R.xc(e=R.dc())&&(t.modelNameDropdownlist=e.first),R.xc(e=R.dc())&&(t.modelNoDropdownlist=e.first),R.xc(e=R.dc())&&(t.chemicalDropdownlist=e.first),R.xc(e=R.dc())&&(t.grid=e),R.xc(e=R.dc())&&(t.positionDropdownlist=e)}},features:[R.yb([S.n,S.f,S.k])],decls:48,vars:10,consts:[[1,"row"],[1,"col-md-5"],[1,"card"],[1,"col-md-12","card-body","table-responsive"],[1,"col-md-3","mt-2"],[1,"col-md-8","mt-2"],["type","text","name","","disabled","","title","",1,"form-control",3,"value"],[1,"col-md-1","mt-2"],["type","button",1,"btn","btn-danger","rounded-pill"],[1,"card-body","table-responsive","p-0"],["class","control-section",4,"ngIf"],[1,"col-md-7"],[1,"card-header"],[1,"card-title"],["class","card-tools",4,"ngIf"],["class","card-body",4,"ngIf"],["cloneArticleModal",""],["HistoryModal",""],["cloneModal",""],[1,"control-section"],["height","250px","showColumnMenu","true","allowSorting","true","allowResizing","true","gridLines","Both",3,"dataSource","editSettings","toolbar","allowSorting","selectedRowIndex","rowDeselected","actionBegin","rowSelected","created","toolbarClick","dataBound"],["gridglue",""],["field","name","isPrimaryKey","true","headerText","Chemical","textAlign","Center","width","150"],["headerTemplate",""],["template",""],["field","consumption","headerText","Std. Con.(g)","textAlign","Center","width","150"],["field","expiredTime","headerText","Expired Time","isPrimaryKey","true","textAlign","Center","width","150"],["field","kindName","headerText","Kind","textAlign","Center","width","150"],["editTemplate",""],["field","partName","headerText","Part","textAlign","Center","width","150"],["field","materialName","headerText","Material","textAlign","Center","width","150"],["data-toggle","tooltip","data-placement","top",3,"title"],[3,"dataSource","ngModel","fields","allowFiltering","ngModelChange","select"],["glueDropdownlist",""],["popupHeight","200px","popupWidth","250px",3,"dataSource","ngModel","fields","allowFiltering","ngModelChange","select"],[1,"card-tools"],["type","button",1,"btn","btn-danger","btn-sm","mr-2","d-none"],[1,"fas","fa-undo"],[2,"width","100px","margin-right","10px",3,"onLabel","offLabel","disabled","checked","click","checkedChange"],["doneSwitch",""],["onLabel","Approved",2,"width","120px",3,"offLabel","checked","click","checkedChange"],["approvalSwitch",""],["type","button","ejs-button","","cssClass","e-small e-success ml-2",3,"click"],[1,"fas","fa-save"],["type","button","ejs-button","","cssClass","e-small e-default ml-2",3,"click"],[1,"fas","fa-history"],[1,"card-body"],[4,"ngIf"],[1,"col-lg-12","col-xs-12","col-12",2,"text-align","center"],["type","button",1,"btn","bg-gradient-secondary","btn-sm","rounded-pill",3,"click"],["type","button","style","margin: 3px","class","btn btn-info btn-sm rounded-pill",3,"click",4,"ngFor","ngForOf"],["class","col-md-6",4,"ngFor","ngForOf"],[2,"visibility","hidden"],[2,"list-style-type","square","font-weight","bold"],["style","list-style: none;",4,"ngFor","ngForOf"],[2,"list-style","none"],[1,"font-weight-bold","text-danger"],["type","button",1,"btn","btn-info","btn-sm","rounded-pill",2,"margin","3px",3,"click"],[1,"fas","fa-cannabis"],[1,"col-md-6"],["height","675px","gridLines","Both","showColumnMenu","true","allowSorting","true","allowResizing","true",3,"dataSource","allowSorting","editSettings","toolbar","actionComplete","recordDoubleClick","actionBegin","toolbarClick","rowSelected"],["grid",""],["field","Item","isPrimaryKey","true","headerText","Item","width","80","textAlign","Center"],["field","name","isPrimaryKey","true","headerText","Name","width","140","textAlign","Center"],["field","percentage","headerText","%","textAlign","Center","width","60"],["field","allow","headerText","Allow (%)","textAlign","Center","width","60"],[3,"dataSource","value","fields","allowFiltering","change"],["positionDropdownlist",""],[1,"fas","fa-exclamation-circle"],[1,"modal-header"],[1,"modal-title"],[1,"fas","fa-plus"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"col-md-12"],[1,"form-group"],["for","Name"],[2,"color","red"],["type","text",1,"form-control",3,"ngModel","ngModelChange"],["placeholder","Select a process",1,"w-100",3,"value","dataSource","allowFiltering","fields","change"],["processDropdownlist",""],[1,"modal-footer"],["type","button",1,"btn","btn-light",3,"click"],["type","submit",1,"btn","btn-primary",3,"click"],["height","675px","gridLines","Both","showColumnMenu","true","allowSorting","true","allowResizing","true",3,"dataSource","allowSorting","editSettings","toolbar","actionBegin"],["gridHistory",""],["field","createdTime","isPrimaryKey","true","headerText","Time","textAlign","Center"],["field","action","isPrimaryKey","true","headerText","Status","width","150","textAlign","Center"],["field","before","headerText","Before","width","450","isPrimaryKey","true","textAlign","Left"],["field","after","headerText","After","width","450","isPrimaryKey","true","textAlign","Left"],["field","remark","headerText","Remark","textAlign","Center",3,"edit"],["field","createdBy","headerText","Created By","isPrimaryKey","true","textAlign","Center"],["type","button",1,"btn","btn-primary",3,"click"],[3,"ngClass"],[4,"ngIf","ngIfElse"],["elseTemplate",""],["type","text","name","remark",1,"e-field","e-input","e-defaultcell",2,"text-align","Center",3,"value"],["disabled","disabled","type","text","name","remark",1,"e-field","e-input","e-defaultcell",2,"text-align","Center",3,"value"],["type","text","name","","title","",1,"form-control",3,"ngModel","value","ngModelChange"]],template:function(e,t){1&e&&(R.Sb(0,"div",0),R.Sb(1,"div",1),R.Sb(2,"div",2),R.Sb(3,"div",3),R.Sb(4,"div",0),R.Sb(5,"div",4),R.Sb(6,"label"),R.Kc(7,"Model Name: "),R.Rb(),R.Rb(),R.Sb(8,"div",5),R.Nb(9,"input",6),R.Rb(),R.Rb(),R.Sb(10,"div",0),R.Sb(11,"div",4),R.Sb(12,"label"),R.Kc(13,"Model NO: "),R.Rb(),R.Rb(),R.Sb(14,"div",5),R.Nb(15,"input",6),R.Rb(),R.Rb(),R.Sb(16,"div",0),R.Sb(17,"div",4),R.Sb(18,"label"),R.Kc(19,"Article NO: "),R.Rb(),R.Rb(),R.Sb(20,"div",5),R.Nb(21,"input",6),R.Rb(),R.Nb(22,"div",7),R.Rb(),R.Sb(23,"div",0),R.Sb(24,"div",4),R.Sb(25,"label"),R.Kc(26,"Process: "),R.Rb(),R.Rb(),R.Sb(27,"div",5),R.Sb(28,"button",8),R.Kc(29),R.Rb(),R.Rb(),R.Nb(30,"div",7),R.Rb(),R.Rb(),R.Rb(),R.Sb(31,"div",2),R.Sb(32,"div",9),R.Ic(33,bn,32,5,"div",10),R.Rb(),R.Rb(),R.Rb(),R.Sb(34,"div",11),R.Sb(35,"div",2),R.Sb(36,"div",12),R.Sb(37,"h3",13),R.Kc(38),R.hc(39,"translate"),R.Rb(),R.Ic(40,pn,18,15,"div",14),R.Rb(),R.Ic(41,Rn,10,6,"div",15),R.Rb(),R.Rb(),R.Ic(42,Mn,27,5,"ng-template",null,16,R.Jc),R.Ic(44,Gn,24,6,"ng-template",null,17,R.Jc),R.Rb(),R.Ic(46,$n,42,5,"ng-template",null,18,R.Jc)),2&e&&(R.zb(9),R.mc("value",t.modelNameDetail),R.zb(6),R.mc("value",t.modelNoDetail),R.zb(6),R.mc("value",t.articleNoDetail),R.zb(8),R.Lc(t.artProcessDetail),R.zb(4),R.mc("ngIf",t.existGlue),R.zb(5),R.Mc("",R.ic(39,8,"PREVIEW")," "),R.zb(2),R.mc("ngIf",t.existGlue),R.zb(1),R.mc("ngIf",t.existGlue))},directives:[s.m,S.j,h.d,v.d,v.b,S.e,S.b,h.c,v.c,v.a,S.d,S.a,r.c,l.g,l.j,u.i,u.b,s.l,l.b,s.k],pipes:[p.c,s.d],styles:[".e-grid[_ngcontent-%COMP%]   td.e-active[_ngcontent-%COMP%]{background:#6597ce!important;color:#000}.radiobutton-control[_ngcontent-%COMP%]{margin:5% 0 5% 40%}@media only screen and (max-width:500px){.radiobutton-control[_ngcontent-%COMP%]{margin-left:21%;margin-top:20%;margin-bottom:27%}}@media only screen and (max-width:700px){.checkbox-control[_ngcontent-%COMP%]{margin-left:35%;margin-top:8%}.control-section[_ngcontent-%COMP%]{min-height:200px}}.control-section[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{margin:20px 0}.radiobutton-control[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:18px}.e-bigger[_ngcontent-%COMP%]   .radiobutton-control[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:20px}.warning-text[_ngcontent-%COMP%]{-webkit-animation:warning-frames .5s infinite;animation:warning-frames .5s infinite;color:#000}@-webkit-keyframes warning-frames{0%{background-color:#d40a0a}to{background-color:#ff6565}}@keyframes warning-frames{0%{background-color:#d40a0a}to{background-color:#ff6565}}"]}),e})();const Kn=[{path:"",children:[{path:"bpfc-schedule",data:{title:"bpfc-schedule",breadcrumb:"BPFC Schedule",functionCode:"BPFC Schedule"},canActivate:[x.a],children:[{path:"",component:vi},{path:"detail",data:{title:"Detail",breadcrumb:"Detail"},children:[{path:"",component:ii},{path:":id",component:ii}]},{path:"detailv2",data:{title:"Detail",breadcrumb:"Detail"},children:[{path:"",component:On},{path:":id",component:On}]}]},{path:"bpfc-status",component:Qi,data:{title:"BPFC Status",breadcrumb:"BPFC Status",functionCode:"BPFC Status"},canActivate:[x.a]},{path:"bpfc-1",component:tt,data:{title:"BPFC ",breadcrumb:"BPFC",functionCode:"BPFC"},canActivate:[x.a]}]}];let Ln,Un=(()=>{class e{}return e.\u0275mod=R.Kb({type:e}),e.\u0275inj=R.Jb({factory:function(t){return new(t||e)},imports:[[P.g.forChild(Kn)],P.g]}),e})();function Jn(e){return new f.a(e,"./assets/i18n/",".json")}const zn=localStorage.getItem("lang");Object(N.bb)(i("2PVe"),i("GFvd"),i("GFWS"),i("0zpJ"),i("LRxf")),Object(N.bb)(i("2PVe"),i("oP7I"),i("Joj5"),i("3JeS"),i("LRxf")),Ln="vi"===zn?zn:"en";let jn=(()=>{class e{constructor(){"vi"===zn?(Ln="vi",setTimeout(()=>{N.p.load(i("+7Wi")),Object(N.nb)("vi")})):(Ln="en",setTimeout(()=>{N.p.load(i("oyrQ")),Object(N.nb)("en")}))}}return e.\u0275mod=R.Kb({type:e}),e.\u0275inj=R.Jb({factory:function(t){return new(t||e)},providers:[s.d],imports:[[w.b,u.c,s.b,l.c,l.m,a.b,Un,o.a,r.d,c.c,h.b,h.a,h.e,d.a,d.c,d.b,u.j,m.a,g.b,v.h,S.i,u.h,I.c,B.b,D.a,g.d,y.a,C.d,u.f,r.f,n.a,p.b.forChild({loader:{provide:p.a,useFactory:Jn,deps:[b.b]},defaultLanguage:Ln})]]}),e})()},NkNT:function(e,t,i){"use strict";i.d(t,"a",function(){return a});var n=i("fXoL"),s=i("tyNb"),l=i("x+4Q");let a=(()=>{class e{constructor(e,t,i){this.el=e,this.route=t,this.authService=i}ngOnInit(){if(this.authService.loggedIn()){const e=JSON.parse(localStorage.getItem("functions")).map(e=>e.childrens),t=this.route.snapshot.data.functionCode,i=[].concat.apply([],e).filter(e=>e.functionCode===t);this.el.nativeElement.style.display=i&&i.filter(e=>e.functionCode===this.appFunction&&e.code===this.appAction).length>0?"":"none"}else this.el.nativeElement.style.display="none"}}return e.\u0275fac=function(t){return new(t||e)(n.Mb(n.l),n.Mb(s.a),n.Mb(l.a))},e.\u0275dir=n.Hb({type:e,selectors:[["","appPermission",""]],inputs:{appFunction:"appFunction",appAction:"appAction"}}),e})()},dQqK:function(e,t,i){"use strict";i.d(t,"a",function(){return s});var n=i("iStF");class s{constructor(){this.editSettingsTree={allowEditing:!1,allowAdding:!1,allowDeleting:!1,newRowPosition:"Child",mode:"Row"},this.editSettings={showDeleteConfirmDialog:!1,allowEditing:!1,allowAdding:!1,allowDeleting:!1,mode:"Normal"},this.toolbarOptions=["ExcelExport","Add","Edit","Delete","Cancel","Search"],this.toolbarOptionsTree=["Add","Delete","Search","ExpandAll","CollapseAll","ExcelExport"],this.contextMenuItems=[{text:"Add Child",iconCss:" e-icons e-add",target:".e-content",id:"Add-Sub-Item"},{text:"Delete",iconCss:" e-icons e-delete",target:".e-content",id:"DeleteOC"}]}Permission(e){const t=e.snapshot.data.functionCode;this.functions=JSON.parse(localStorage.getItem("functions")).filter(e=>e.functionCode===t)||[];for(const i of this.functions){const e=[];for(const n of i.childrens){const t=this.makeAction(n.code);e.push(...t.filter(Boolean))}e.push("Search");const t=e.filter((e,t,i)=>t===i.indexOf(e));this.toolbarOptions=t}}PermissionForTreeGrid(e){this.contextMenuItems=[],this.functions=JSON.parse(localStorage.getItem("functions"));for(const t of this.functions)if(e.snapshot.data.functionCode.includes(t.functionCode)){const e=[];for(const n of t.childrens){const t=this.makeActionTreeGrid(n.code);e.push(...t.filter(Boolean))}e.push("Search","ExpandAll","CollapseAll","ExcelExport");const i=e.filter((e,t,i)=>t===i.indexOf(e));this.toolbarOptionsTree=i;break}}makeAction(e){switch(e){case n.a.CREATE:return this.editSettings.allowAdding=!0,["Add","Cancel"];case n.a.EDIT:return this.editSettings.allowEditing=!0,["Edit","Update","Cancel"];case n.a.DELETE:return this.editSettings.allowDeleting=!0,["Delete"];case n.a.EXCEL_EXPORT:return["ExcelExport"];default:return[void 0]}}makeActionTreeGrid(e){switch(e){case n.a.EXCEL_EXPORT:return["ExcelExport"];case n.a.CREATE:return this.editSettingsTree.allowAdding=!0,this.contextMenuItems.push({text:"Add Child",iconCss:" e-icons e-add",target:".e-content",id:"Add-Sub-Item"}),["Add"];case n.a.EDIT:return this.editSettingsTree.allowEditing=!0,[void 0];case n.a.DELETE:return this.editSettingsTree.allowDeleting=!0,this.contextMenuItems.push({text:"Delete",iconCss:" e-icons e-delete",target:".e-content",id:"DeleteOC"}),[void 0];default:return[void 0]}}}},"h9f+":function(e,t,i){"use strict";i.d(t,"a",function(){return c});var n=i("2Vo4"),s=i("lJxs"),l=i("tk/3"),a=i("AytR"),o=i("2zK7"),r=i("fXoL");new l.e({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")});let c=(()=>{class e{constructor(e){this.http=e,this.baseUrl=a.a.apiUrlEC,this.authUrl=a.a.apiUrl,this.messageSource=new n.a(0),this.currentMessage=this.messageSource.asObservable()}changeMessage(e){this.messageSource.next(e)}getBuildingsAsTreeView(){return this.http.get(this.baseUrl+"Building/GetAllAsTreeView")}mappingUserWithBuilding(e){return this.http.post(this.baseUrl+"BuildingUser/MappingUserWithBuilding",e)}removeBuildingUser(e){return this.http.post(this.baseUrl+"BuildingUser/RemoveBuildingUser",e)}getAllUsers(e,t){const i=new o.a;return this.http.get(`${this.authUrl}Users/GetAllUsers/${a.a.systemCode}/${e}/${t}`,{observe:"response"}).pipe(Object(s.a)(e=>(i.result=e.body,null!=e.headers.get("Pagination")&&(i.pagination=JSON.parse(e.headers.get("Pagination"))),i)))}deleteUser(e){return this.http.delete(`${this.authUrl}Users/Delete/${e}`)}updateUser(e){return this.http.post(this.authUrl+"Users/Update",e)}createUser(e){return this.http.post(this.authUrl+"Users/Create",e)}getAllBuildingUsers(){return this.http.get(this.baseUrl+"BuildingUser/getAllBuildingUsers")}getBuildingUserByBuildingID(e){return this.http.get(`${this.baseUrl}BuildingUser/GetBuildingUserByBuildingID/${e}`)}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(l.b))},e.\u0275prov=r.Ib({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},vrRs:function(e,t,i){"use strict";i.d(t,"a",function(){return c});var n=i("tk/3"),s=i("2Vo4"),l=i("lJxs"),a=i("AytR"),o=i("2zK7"),r=i("fXoL");new n.e({"Content-Type":"application/json"});let c=(()=>{class e{constructor(e){this.http=e,this.baseUrl=a.a.apiUrlEC,this.ingredientSource=new s.a(0),this.currentIngredient=this.ingredientSource.asObservable()}getIngredients(e,t){const i=new o.a;let s=new n.f;return null!=e&&null!=t&&(s=s.append("pageNumber",e),s=s.append("pageSize",t)),this.http.get(this.baseUrl+"ingredient/getingredients",{observe:"response",params:s}).pipe(Object(l.a)(e=>(i.result=e.body,null!=e.headers.get("Pagination")&&(i.pagination=JSON.parse(e.headers.get("Pagination"))),i)))}search(e,t,i){const s=new o.a;let a=new n.f;return null!=e&&null!=t&&(a=a.append("pageNumber",e),a=a.append("pageSize",t)),this.http.get(this.baseUrl+"ingredient/Search/"+i,{observe:"response",params:a}).pipe(Object(l.a)(e=>(s.result=e.body,null!=e.headers.get("Pagination")&&(s.pagination=JSON.parse(e.headers.get("Pagination"))),s)))}getAllIngredient(){return this.http.get(this.baseUrl+"ingredient/GetAll",{})}rate(){return this.http.get(this.baseUrl+"ingredient/Rate",{})}getAllGlueType(){return this.http.get(this.baseUrl+"ingredient/GetAllGlueType",{})}getByID(e){return this.http.get(this.baseUrl+"ingredient/GetbyID/"+e,{})}scanQRCode(e){return this.http.get(this.baseUrl+"ingredient/ScanQRCode/"+e,{})}scanQRCodeFromChemicalWareHouse(e,t,i){return this.http.post(`${this.baseUrl}ingredient/ScanQRCodeFromChemialWareHouse/${e}/${t}/${i}`,{})}scanQRCodeFromChemicalWareHouseV1(e){return this.http.post(this.baseUrl+"ingredient/ScanQRCodeFromChemialWareHouseV1/",e)}scanQRCodeOutputV1(e){return this.http.post(this.baseUrl+"ingredient/ScanQRCodeOutputV1/",e)}scanQRCodeOutput(e,t,i){return this.http.get(`${this.baseUrl}ingredient/ScanQRCodeOutput/${e}/${t}/${i}`,{})}getAllSupplier(){return this.http.get(this.baseUrl+"Suppier/GetAll",{})}getAllIngredientInfo(){return this.http.get(this.baseUrl+"ingredient/GetAllIngredientInfo",{})}getAllIngredientInfoOutput(){return this.http.get(this.baseUrl+"ingredient/GetAllIngredientInfoOutPut",{})}getAllIngredientInfoByBuildingName(e){return this.http.get(this.baseUrl+"ingredient/GetAllIngredientInfoByBuildingName/"+e,{})}getAllIngredientInfoReport(){return this.http.get(this.baseUrl+"ingredient/GetAllIngredientInfoReport",{})}getAllIngredientInfoReportByBuildingName(e){return this.http.get(this.baseUrl+"ingredient/GetAllIngredientInfoReportByBuildingName/"+e,{})}searchInventory(e,t){return this.http.get(`${this.baseUrl}ingredient/Search/${e}/${t}`,{})}searchInventoryByBuildingName(e,t,i){return this.http.get(`${this.baseUrl}ingredient/SearchWithBuildingName/${e}/${t}/${i}`,{})}deleteIngredientInfo(e,t,i,n){return this.http.delete(this.baseUrl+`ingredient/DeleteIngredientInfo/${e}/${t}/${i}/${n}`)}UpdateConsumption(e,t,i){return this.http.post(this.baseUrl+`ingredient/UpdateConsumptionIngredientReport/${e}/${t}/${i}`,{})}UpdateConsumptionOfBuilding(e){return this.http.post(this.baseUrl+"ingredient/UpdateConsumptionOfBuildingIngredientReport",e)}createSub(e){return this.http.post(this.baseUrl+"suppier/create",e)}updateSub(e){return this.http.put(this.baseUrl+"suppier/update",e)}deleteSub(e){return this.http.delete(this.baseUrl+"suppier/delete/"+e)}sortBySup(e,t){return this.http.get(this.baseUrl+`GlueIngredient/GetIngredientsByGlueID/${e}/${t}`)}getIngredientsByGlueID(e){return this.http.get(this.baseUrl+"GlueIngredient/GetIngredientsByGlueID/"+e)}create(e){return this.http.post(this.baseUrl+"ingredient/create1",e)}update(e){return this.http.put(this.baseUrl+"ingredient/update",e)}delete(e){return this.http.delete(this.baseUrl+"ingredient/delete/"+e)}changeIngredient(e){this.ingredientSource.next(e)}import(e,t){const i=new FormData;return i.append("UploadedFile",e),i.append("CreatedBy",t),this.http.post(this.baseUrl+"ingredient/Import",i)}downloadFile(){return this.http.post(this.baseUrl+"ingredient/ExcelExport",{})}GetQrcodeByid(e){return this.http.get(this.baseUrl+"ingredient/GetbyID/"+e)}UpdatePrint(e){return this.http.put(this.baseUrl+"ingredient/UpdatePrint",e)}checkIncoming(e,t,i){return this.http.get(`${this.baseUrl}ingredient/CheckIncoming/${e}/${t}/${i}`,{})}getAllIngredientInfoByBuilding(e){return this.http.get(this.baseUrl+"ingredient/GetAllIngredientInfoByBuilding/"+e,{})}getAllIngredientInfoOutputByBuilding(e){return this.http.get(this.baseUrl+"ingredient/GetAllIngredientInfoOutputByBuilding/"+e,{})}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(n.b))},e.\u0275prov=r.Ib({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);